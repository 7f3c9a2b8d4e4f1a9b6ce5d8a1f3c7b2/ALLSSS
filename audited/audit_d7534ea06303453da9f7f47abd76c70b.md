### Title
Integer Overflow in Association Organization Threshold Validation Bypasses Governance Invariants

### Summary
The `Validate(Organization)` function in Association_Helper.cs contains unchecked integer arithmetic on lines 77-80 that allows int64 threshold values to overflow when added together. This enables attackers to create organizations with invalid threshold configurations that violate the fundamental governance invariant that `MaximalAbstentionThreshold + MinimalApprovalThreshold <= organizationMemberCount`, breaking the rejection and abstention mechanisms.

### Finding Description

The vulnerability exists in the threshold validation logic at lines 77-80 of the `Validate(Organization)` helper function: [1](#0-0) 

These lines perform additions of int64 values (`MaximalAbstentionThreshold + MinimalApprovalThreshold` and `MaximalRejectionThreshold + MinimalApprovalThreshold`) without overflow protection. In C#, integer arithmetic is unchecked by default, meaning when two large int64 values exceed `long.MaxValue` (9,223,372,036,854,775,807), the result wraps to a negative value.

The threshold fields are defined as int64 in the protobuf specification: [2](#0-1) 

Meanwhile, `organizationMemberCount` is obtained from `Count()` which returns an int (32-bit): [3](#0-2) 

When the addition overflows to a negative value, the comparison `negative_value <= organizationMemberCount` always evaluates to true, causing the validation to pass incorrectly.

This validation is called during organization creation: [4](#0-3) 

### Impact Explanation

An attacker can create organizations with threshold configurations that violate governance invariants. Specifically:

1. **Broken Rejection Mechanism**: With `MaximalRejectionThreshold` set to near `long.MaxValue`, the `IsProposalRejected()` check can never return true since actual rejection counts (limited by member count) can never exceed the threshold: [5](#0-4) 

2. **Broken Abstention Mechanism**: Similarly, `IsProposalAbstained()` can never block proposals: [6](#0-5) 

3. **Governance Invariant Violation**: The fundamental assumption that threshold sums don't exceed member count is violated, which could be relied upon by external contracts or users trusting the organization's governance rules.

While the attacker only affects their own organization, this creates misleading governance structures that could deceive users or contracts interacting with these organizations, believing they have valid multi-signature protections when they effectively only require approvals.

### Likelihood Explanation

**Attacker Capabilities**: Any user can call `CreateOrganization` without special permissions.

**Attack Complexity**: Trivial - simply provide extreme threshold values during organization creation:
- Set `MinimalApprovalThreshold` to a small value (e.g., 5)
- Set `MaximalAbstentionThreshold` to `9,223,372,036,854,775,806` (long.MaxValue - 1)
- Set `MaximalRejectionThreshold` similarly

**Feasibility**: The overflow is guaranteed to occur with these inputs. The sum `9,223,372,036,854,775,806 + 5 = -9,223,372,036,854,775,798` (wraps to negative), which is always less than any positive member count.

**Detection**: The malicious thresholds are stored on-chain and publicly visible, but may not be easily detected by users who don't carefully inspect the numeric values.

**Probability**: High - the vulnerability is deterministic and requires no race conditions or timing constraints.

### Recommendation

1. **Use Checked Arithmetic**: Wrap the threshold addition operations in a `checked` context to trigger overflow exceptions:

```csharp
checked {
    return /* existing conditions */ &&
           proposalReleaseThreshold.MaximalAbstentionThreshold +
           proposalReleaseThreshold.MinimalApprovalThreshold <= organizationMemberCount &&
           proposalReleaseThreshold.MaximalRejectionThreshold +
           proposalReleaseThreshold.MinimalApprovalThreshold <= organizationMemberCount;
}
```

2. **Add Explicit Range Checks**: Before the addition, validate that threshold values are reasonable relative to the member count:

```csharp
if (proposalReleaseThreshold.MaximalAbstentionThreshold > organizationMemberCount ||
    proposalReleaseThreshold.MaximalRejectionThreshold > organizationMemberCount)
    return false;
```

3. **Test Cases**: Add unit tests with extreme threshold values to ensure validation properly rejects:
   - `MaximalAbstentionThreshold = long.MaxValue - 1`, `MinimalApprovalThreshold = 5`
   - `MaximalRejectionThreshold = long.MaxValue`, `MinimalApprovalThreshold = 1`
   - Various combinations that would overflow

### Proof of Concept

**Initial State**: None required (new organization creation)

**Attack Steps**:
1. Call `CreateOrganization` with:
   - `OrganizationMemberList`: 10 member addresses
   - `MinimalApprovalThreshold`: 5
   - `MinimalVoteThreshold`: 5
   - `MaximalAbstentionThreshold`: 9223372036854775806 (long.MaxValue - 1)
   - `MaximalRejectionThreshold`: 0

**Expected Result**: Organization creation should fail with "Invalid organization" because `9223372036854775806 + 5 = 9223372036854775811 > 10`

**Actual Result**: Organization is created successfully because:
- Line 77-78 computation: `9223372036854775806 + 5` overflows to `-9223372036854775798`
- Comparison: `-9223372036854775798 <= 10` evaluates to `true`
- Validation passes

**Success Condition**: Organization state is persisted with the malicious thresholds, and subsequent proposals to this organization cannot be blocked by abstentions regardless of the actual vote distribution.

### Citations

**File:** contract/AElf.Contracts.Association/Association_Helper.cs (L34-39)
```csharp
    private bool IsProposalRejected(ProposalInfo proposal, Organization organization)
    {
        var rejectionMemberCount =
            proposal.Rejections.Count(organization.OrganizationMemberList.Contains);
        return rejectionMemberCount > organization.ProposalReleaseThreshold.MaximalRejectionThreshold;
    }
```

**File:** contract/AElf.Contracts.Association/Association_Helper.cs (L41-45)
```csharp
    private bool IsProposalAbstained(ProposalInfo proposal, Organization organization)
    {
        var abstentionMemberCount = proposal.Abstentions.Count(organization.OrganizationMemberList.Contains);
        return abstentionMemberCount > organization.ProposalReleaseThreshold.MaximalAbstentionThreshold;
    }
```

**File:** contract/AElf.Contracts.Association/Association_Helper.cs (L77-80)
```csharp
               proposalReleaseThreshold.MaximalAbstentionThreshold +
               proposalReleaseThreshold.MinimalApprovalThreshold <= organizationMemberCount &&
               proposalReleaseThreshold.MaximalRejectionThreshold +
               proposalReleaseThreshold.MinimalApprovalThreshold <= organizationMemberCount;
```

**File:** protobuf/acs3.proto (L128-137)
```text
message ProposalReleaseThreshold {
    // The value for the minimum approval threshold.
    int64 minimal_approval_threshold = 1;
    // The value for the maximal rejection threshold.
    int64 maximal_rejection_threshold = 2;
    // The value for the maximal abstention threshold.
    int64 maximal_abstention_threshold = 3;
    // The value for the minimal vote threshold.
    int64 minimal_vote_threshold = 4;
}
```

**File:** contract/AElf.Contracts.Association/OrganizationMemberList.cs (L7-10)
```csharp
    public int Count()
    {
        return organizationMembers_.Count;
    }
```

**File:** contract/AElf.Contracts.Association/Association.cs (L83-83)
```csharp
        Assert(Validate(organization), "Invalid organization.");
```
