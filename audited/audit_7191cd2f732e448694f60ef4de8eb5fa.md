### Title
Missing Null/Zero Address Validation in Organization Member List Allows Governance DoS

### Summary
The `Validate(Organization)` method in the Association contract fails to validate that `OrganizationMemberList` members are non-null and non-zero addresses. This allows organizations to be created with invalid members that inflate the member count used in threshold calculations, but cannot actually vote, resulting in proposals that can never reach required approval thresholds and causing permanent governance denial-of-service.

### Finding Description

The vulnerability exists in the organization validation logic where member addresses are not validated for null or zero values. [1](#0-0) 

The validation at lines 65-66 only checks if `OrganizationMemberList` is empty or contains duplicates using the `AnyDuplicate()` method: [2](#0-1) 

The `AnyDuplicate()` implementation groups members and checks for duplicates. If there is only ONE null or zero address (not duplicated), this method returns `false`, allowing the validation to pass.

The member count used for threshold validation includes these invalid addresses: [3](#0-2) 

However, when voting occurs, only valid addresses that can be `Context.Sender` can cast votes: [4](#0-3) [5](#0-4) 

The threshold checking logic at line 56 requires a `MinimalVoteThreshold` that may be set based on the inflated member count: [6](#0-5) 

Unlike other contracts in the codebase that properly validate addresses: [7](#0-6) 

The Association contract's validation does not check `address != null && !address.Value.IsNullOrEmpty()`.

### Impact Explanation

**Operational Impact - Governance DoS:**

An organization created with null or zero addresses in its member list will have permanently broken governance. For example:

- Organization with 5 members: [Alice, Bob, Charlie, NullAddress1, NullAddress2]
- `organizationMemberCount` = 5
- Set `MinimalApprovalThreshold` = 3, `MinimalVoteThreshold` = 4
- Validation passes because the count is 5 â‰¥ 4

However, only 3 real members (Alice, Bob, Charlie) can vote. Even if all 3 approve:
- `approvedMemberCount` = 3 (meets MinimalApprovalThreshold of 3)  
- Total votes = 3 (does NOT meet MinimalVoteThreshold of 4)
- Proposal cannot be released

This affects all proposal types in the organization, causing complete governance failure. Organizations cannot execute any proposals, effectively locking any controlled assets or permissions permanently.

**Severity: HIGH** - Complete denial of service for affected organizations' governance capabilities with no recovery mechanism.

### Likelihood Explanation

**Reachable Entry Point:** The `CreateOrganization` method is publicly accessible: [8](#0-7) 

**Feasible Preconditions:**
- Anyone can create an organization
- Protobuf3 allows Address fields with null or empty byte arrays (zero addresses)
- No validation prevents including such addresses in the input

**Execution Practicality:**
Simple attack scenario:
1. Attacker creates `CreateOrganizationInput` with `OrganizationMemberList` containing legitimate addresses plus null/zero addresses
2. Calls `CreateOrganization` - validation passes
3. Organization is created with broken threshold logic
4. All future proposals in this organization fail to reach thresholds

**Attack Complexity:** Trivial - single transaction with malformed input.

**Detection:** The issue may go undetected initially, only becoming apparent when proposals fail to reach thresholds despite legitimate member approval.

**Likelihood: MEDIUM-HIGH** - While this requires the organization creator to include null/zero addresses (potentially unintentional due to input errors), the lack of validation makes it easily exploitable.

### Recommendation

**Code-Level Mitigation:**

Add explicit null and zero address validation in the `Validate(Organization)` method:

```csharp
private bool Validate(Organization organization)
{
    // Existing checks
    if (organization.ProposerWhiteList.Empty() ||
        organization.ProposerWhiteList.AnyDuplicate() ||
        organization.OrganizationMemberList.Empty() ||
        organization.OrganizationMemberList.AnyDuplicate())
        return false;
    
    // ADD: Validate all members are non-null and non-zero addresses
    foreach (var member in organization.OrganizationMemberList.OrganizationMembers)
    {
        if (member == null || member.Value.IsNullOrEmpty())
            return false;
    }
    
    // ADD: Validate all proposers are non-null and non-zero addresses  
    foreach (var proposer in organization.ProposerWhiteList.Proposers)
    {
        if (proposer == null || proposer.Value.IsNullOrEmpty())
            return false;
    }
    
    // Rest of existing validation...
}
```

**Invariant Checks:**
- All organization member addresses must be non-null with non-empty byte values
- All proposer whitelist addresses must be non-null with non-empty byte values

**Test Cases:**
1. Test creating organization with null address in member list - should fail
2. Test creating organization with zero address (empty bytes) in member list - should fail
3. Test adding null member via `AddMember` - should fail
4. Test changing to null member via `ChangeMember` - should fail

### Proof of Concept

**Initial State:**
- Blockchain with Association contract deployed
- Attacker has account address

**Attack Steps:**

1. Create `CreateOrganizationInput`:
   - `OrganizationMemberList.OrganizationMembers` = [RealAddress1, RealAddress2, Address{Value=empty}, RealAddress3]
   - `ProposalReleaseThreshold.MinimalApprovalThreshold` = 3
   - `ProposalReleaseThreshold.MinimalVoteThreshold` = 4
   - `ProposerWhiteList.Proposers` = [RealAddress1]

2. Call `CreateOrganization` with this input

**Expected Result:** 
Transaction should fail with "Invalid organization."

**Actual Result:**
- Transaction succeeds
- Organization is created with `organizationMemberCount` = 4 (including zero address)
- Thresholds validated against count of 4

3. RealAddress1 creates a proposal

4. RealAddress1, RealAddress2, RealAddress3 all approve

**Expected Result:**
Proposal should be releasable (all legitimate members approved)

**Actual Result:**
- `approvedMemberCount` = 3 (meets MinimalApprovalThreshold)
- Total votes = 3 (does NOT meet MinimalVoteThreshold of 4)
- Proposal cannot be released - permanent governance DoS

**Success Condition:**
Organization created with null/zero address in member list passes validation, but proposals cannot reach thresholds even with unanimous legitimate member approval.

### Citations

**File:** contract/AElf.Contracts.Association/Association_Helper.cs (L18-22)
```csharp
    private void AssertIsAuthorizedOrganizationMember(Organization organization, Address member)
    {
        Assert(organization.OrganizationMemberList.Contains(member),
            "Unauthorized member.");
    }
```

**File:** contract/AElf.Contracts.Association/Association_Helper.cs (L47-59)
```csharp
    private bool CheckEnoughVoteAndApprovals(ProposalInfo proposal, Organization organization)
    {
        var approvedMemberCount = proposal.Approvals.Count(organization.OrganizationMemberList.Contains);
        var isApprovalEnough =
            approvedMemberCount >= organization.ProposalReleaseThreshold.MinimalApprovalThreshold;
        if (!isApprovalEnough)
            return false;

        var isVoteThresholdReached =
            proposal.Abstentions.Concat(proposal.Approvals).Concat(proposal.Rejections).Count() >=
            organization.ProposalReleaseThreshold.MinimalVoteThreshold;
        return isVoteThresholdReached;
    }
```

**File:** contract/AElf.Contracts.Association/Association_Helper.cs (L61-81)
```csharp
    private bool Validate(Organization organization)
    {
        if (organization.ProposerWhiteList.Empty() ||
            organization.ProposerWhiteList.AnyDuplicate() ||
            organization.OrganizationMemberList.Empty() ||
            organization.OrganizationMemberList.AnyDuplicate())
            return false;
        if (organization.OrganizationAddress == null || organization.OrganizationHash == null)
            return false;
        var proposalReleaseThreshold = organization.ProposalReleaseThreshold;
        var organizationMemberCount = organization.OrganizationMemberList.Count();
        return proposalReleaseThreshold.MinimalVoteThreshold <= organizationMemberCount &&
               proposalReleaseThreshold.MinimalApprovalThreshold <= proposalReleaseThreshold.MinimalVoteThreshold &&
               proposalReleaseThreshold.MinimalApprovalThreshold > 0 &&
               proposalReleaseThreshold.MaximalAbstentionThreshold >= 0 &&
               proposalReleaseThreshold.MaximalRejectionThreshold >= 0 &&
               proposalReleaseThreshold.MaximalAbstentionThreshold +
               proposalReleaseThreshold.MinimalApprovalThreshold <= organizationMemberCount &&
               proposalReleaseThreshold.MaximalRejectionThreshold +
               proposalReleaseThreshold.MinimalApprovalThreshold <= organizationMemberCount;
    }
```

**File:** contract/AElf.Contracts.Association/Association_Extensions.cs (L24-27)
```csharp
    public static bool AnyDuplicate(this OrganizationMemberList organizationMemberList)
    {
        return organizationMemberList.OrganizationMembers.GroupBy(m => m).Any(g => g.Count() > 1);
    }
```

**File:** contract/AElf.Contracts.Association/Association.cs (L69-94)
```csharp
    public override Address CreateOrganization(CreateOrganizationInput input)
    {
        var organizationHashAddressPair = CalculateOrganizationHashAddressPair(input);
        var organizationAddress = organizationHashAddressPair.OrganizationAddress;
        var organizationHash = organizationHashAddressPair.OrganizationHash;
        var organization = new Organization
        {
            ProposalReleaseThreshold = input.ProposalReleaseThreshold,
            OrganizationAddress = organizationAddress,
            ProposerWhiteList = input.ProposerWhiteList,
            OrganizationMemberList = input.OrganizationMemberList,
            OrganizationHash = organizationHash,
            CreationToken = input.CreationToken
        };
        Assert(Validate(organization), "Invalid organization.");
        if (State.Organizations[organizationAddress] == null)
        {
            State.Organizations[organizationAddress] = organization;
            Context.Fire(new OrganizationCreated
            {
                OrganizationAddress = organizationAddress
            });
        }

        return organizationAddress;
    }
```

**File:** contract/AElf.Contracts.Association/Association.cs (L123-140)
```csharp
    public override Empty Approve(Hash input)
    {
        var proposal = GetValidProposal(input);
        AssertProposalNotYetVotedBySender(proposal, Context.Sender);
        var organization = GetOrganization(proposal.OrganizationAddress);
        AssertIsAuthorizedOrganizationMember(organization, Context.Sender);

        proposal.Approvals.Add(Context.Sender);
        State.Proposals[input] = proposal;
        Context.Fire(new ReceiptCreated
        {
            Address = Context.Sender,
            ProposalId = input,
            Time = Context.CurrentBlockTime,
            ReceiptType = nameof(Approve),
            OrganizationAddress = proposal.OrganizationAddress
        });
        return new Empty();
```

**File:** contract/AElf.Contracts.Genesis/BasicContractZero.cs (L539-539)
```csharp
        Assert(input != null && !input.Value.IsNullOrEmpty(), "Invalid input.");
```
