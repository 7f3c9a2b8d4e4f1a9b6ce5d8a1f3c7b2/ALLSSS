### Title
Unhandled Null Reference Exceptions in Association Contract Extension Methods Cause Governance DoS

### Summary
The extension methods in `Association_Extensions.cs` do not perform null checks before accessing properties of `ProposerWhiteList` and `OrganizationMemberList` objects. Since these are protobuf message-type fields that default to null when not explicitly initialized, attackers can trigger unhandled `NullReferenceException` errors in critical governance flows including organization creation, modification, and authorization validation, causing transaction failures and potential denial of service.

### Finding Description

The vulnerability exists in multiple extension methods that assume non-null input: [1](#0-0) 

These extension methods access the `Proposers` property of `ProposerWhiteList` and `OrganizationMembers` property of `OrganizationMemberList` without null checks. The methods are called in several critical governance paths:

**Path 1: Organization Creation** [2](#0-1) 

When `CreateOrganization` receives a `CreateOrganizationInput` where `ProposerWhiteList` or `OrganizationMemberList` is null (which occurs when these protobuf message fields are not explicitly set), the organization object is created with null values. The subsequent `Validate()` call triggers extension methods: [3](#0-2) 

At lines 63-66, calling `.Empty()` and `.AnyDuplicate()` on null objects throws `NullReferenceException` before the validation logic can execute.

**Path 2: View Method Null Dereference** [4](#0-3) 

The `ValidateProposerInWhiteList` view method retrieves an organization from state (line 58) which returns null if the organization doesn't exist, then directly accesses `organization.ProposerWhiteList.Contains()` (line 61) without checking if organization is null, causing a `NullReferenceException`.

**Path 3: Organization Modification** [5](#0-4) 

When `ChangeOrganizationProposerWhiteList` is called with null input, line 222 assigns null to `ProposerWhiteList`, then line 223 calls `Validate()` which triggers the same null dereference in extension methods.

**Path 4: Member Authorization Checks** [6](#0-5) 

The `AssertIsAuthorizedOrganizationMember` method calls `organization.OrganizationMemberList.Contains()` without null checking. The instance method implementation: [7](#0-6) 

If `OrganizationMemberList` is null, calling any of these methods throws `NullReferenceException`.

**Root Cause**: In protobuf3 C#, message-type fields default to null when not explicitly initialized during deserialization. The codebase assumes these fields are always non-null but provides no defensive checks.

### Impact Explanation

**Operational Impact - Governance DoS:**
- Any user can send `CreateOrganizationInput` with uninitialized message fields, causing organization creation to fail with unhandled exceptions
- Organization modification via `ChangeOrganizationProposerWhiteList` can fail with exceptions instead of validation errors
- View method `ValidateProposerInWhiteList` throws exceptions for non-existent organizations, breaking client integrations expecting boolean returns
- Proposal voting flows (`Approve`, `Reject`, `Abstain`) can encounter null dereferences when retrieving organizations

**Severity Justification:**
- **High severity** because it affects critical governance infrastructure
- Attackers can deliberately cause transaction failures in organization management
- Differs from graceful validation errors - transactions fail with exceptions rather than clean error messages
- Affects both state-changing operations and view methods
- No special permissions required - any user can trigger the vulnerability

### Likelihood Explanation

**Reachable Entry Point:**
Public methods `CreateOrganization`, `ChangeOrganizationProposerWhiteList`, and `ValidateProposerInWhiteList` are directly accessible by any user.

**Attacker Capabilities:**
- No special permissions required
- Attacker simply constructs protobuf messages without initializing message-type fields (standard protobuf3 behavior)
- Transaction can be submitted via standard AElf SDK/API

**Attack Complexity:**
Low - attacker needs only to:
1. Create a `CreateOrganizationInput` message without setting `ProposerWhiteList` or `OrganizationMemberList`
2. Serialize and submit to `CreateOrganization` method
3. Transaction fails with `NullReferenceException`

**Feasibility:**
Very high - this is a programming error, not a complex logic exploit. Standard protobuf usage allows null message fields.

**Detection:**
Difficult to prevent - the contract has no input validation before accessing these properties. Network-level protections cannot distinguish between valid and malicious null values.

### Recommendation

**Immediate Fix:**
Add null checks to all extension methods in `Association_Extensions.cs`:

```csharp
public static int Count(this ProposerWhiteList proposerWhiteList)
{
    if (proposerWhiteList?.Proposers == null) return 0;
    return proposerWhiteList.Proposers.Count;
}

public static bool Empty(this ProposerWhiteList proposerWhiteList)
{
    return proposerWhiteList?.Proposers == null || proposerWhiteList.Proposers.Count == 0;
}

public static bool AnyDuplicate(this ProposerWhiteList proposerWhiteList)
{
    if (proposerWhiteList?.Proposers == null) return false;
    return proposerWhiteList.Proposers.GroupBy(p => p).Any(g => g.Count() > 1);
}

public static bool Contains(this ProposerWhiteList proposerWhiteList, Address address)
{
    if (proposerWhiteList?.Proposers == null) return false;
    return proposerWhiteList.Proposers.Contains(address);
}

public static bool AnyDuplicate(this OrganizationMemberList organizationMemberList)
{
    if (organizationMemberList?.OrganizationMembers == null) return false;
    return organizationMemberList.OrganizationMembers.GroupBy(m => m).Any(g => g.Count() > 1);
}
```

**Additional Validation:**
In `Validate()` method, add explicit null checks before calling extension methods:

```csharp
private bool Validate(Organization organization)
{
    if (organization.ProposerWhiteList == null || 
        organization.OrganizationMemberList == null)
        return false;
    
    if (organization.ProposerWhiteList.Empty() || ...)
    // ... rest of validation
}
```

**View Method Protection:**
Fix `ValidateProposerInWhiteList` to handle null organization:

```csharp
public override BoolValue ValidateProposerInWhiteList(ValidateProposerInWhiteListInput input)
{
    var organization = State.Organizations[input.OrganizationAddress];
    if (organization?.ProposerWhiteList == null)
        return new BoolValue { Value = false };
    return new BoolValue
    {
        Value = organization.ProposerWhiteList.Contains(input.Proposer)
    };
}
```

**Regression Tests:**
Add test cases that:
1. Call `CreateOrganization` with null `ProposerWhiteList`
2. Call `CreateOrganization` with null `OrganizationMemberList`
3. Call `ValidateProposerInWhiteList` with non-existent organization
4. Call `ChangeOrganizationProposerWhiteList` with null input
5. Verify all return graceful validation errors, not exceptions

### Proof of Concept

**Initial State:**
- Association contract deployed
- Attacker has any valid address

**Attack Sequence:**

**Step 1:** Attacker creates `CreateOrganizationInput` with null fields
```csharp
var maliciousInput = new CreateOrganizationInput
{
    // ProposerWhiteList not set (null)
    // OrganizationMemberList not set (null)
    ProposalReleaseThreshold = new ProposalReleaseThreshold
    {
        MinimalApprovalThreshold = 1,
        MinimalVoteThreshold = 1,
        MaximalAbstentionThreshold = 0,
        MaximalRejectionThreshold = 0
    }
};
```

**Step 2:** Attacker serializes and submits transaction to `CreateOrganization`

**Expected Result (Current):**
Transaction fails with `NullReferenceException` at line 63 or 65 of `Validate()` method when calling `.Empty()` on null object.

**Expected Result (After Fix):**
Transaction fails gracefully with "Invalid organization." error message from `Assert` on line 83, not an unhandled exception.

**Success Condition:**
Current behavior: `TransactionResult.Status == Failed` with `Error` containing stack trace of `NullReferenceException`

Desired behavior: `TransactionResult.Status == Failed` with `Error == "Invalid organization."`

### Citations

**File:** contract/AElf.Contracts.Association/Association_Extensions.cs (L9-32)
```csharp
    public static int Count(this ProposerWhiteList proposerWhiteList)
    {
        return proposerWhiteList.Proposers.Count;
    }

    public static bool Empty(this ProposerWhiteList proposerWhiteList)
    {
        return proposerWhiteList.Count() == 0;
    }

    public static bool AnyDuplicate(this ProposerWhiteList proposerWhiteList)
    {
        return proposerWhiteList.Proposers.GroupBy(p => p).Any(g => g.Count() > 1);
    }

    public static bool AnyDuplicate(this OrganizationMemberList organizationMemberList)
    {
        return organizationMemberList.OrganizationMembers.GroupBy(m => m).Any(g => g.Count() > 1);
    }

    public static bool Contains(this ProposerWhiteList proposerWhiteList, Address address)
    {
        return proposerWhiteList.Proposers.Contains(address);
    }
```

**File:** contract/AElf.Contracts.Association/Association.cs (L56-63)
```csharp
    public override BoolValue ValidateProposerInWhiteList(ValidateProposerInWhiteListInput input)
    {
        var organization = State.Organizations[input.OrganizationAddress];
        return new BoolValue
        {
            Value = organization.ProposerWhiteList.Contains(input.Proposer)
        };
    }
```

**File:** contract/AElf.Contracts.Association/Association.cs (L74-83)
```csharp
        var organization = new Organization
        {
            ProposalReleaseThreshold = input.ProposalReleaseThreshold,
            OrganizationAddress = organizationAddress,
            ProposerWhiteList = input.ProposerWhiteList,
            OrganizationMemberList = input.OrganizationMemberList,
            OrganizationHash = organizationHash,
            CreationToken = input.CreationToken
        };
        Assert(Validate(organization), "Invalid organization.");
```

**File:** contract/AElf.Contracts.Association/Association.cs (L218-224)
```csharp
    public override Empty ChangeOrganizationProposerWhiteList(ProposerWhiteList input)
    {
        var organization = State.Organizations[Context.Sender];
        Assert(organization != null, "Organization not found.");
        organization.ProposerWhiteList = input;
        Assert(Validate(organization), "Invalid organization.");
        State.Organizations[Context.Sender] = organization;
```

**File:** contract/AElf.Contracts.Association/Association_Helper.cs (L18-22)
```csharp
    private void AssertIsAuthorizedOrganizationMember(Organization organization, Address member)
    {
        Assert(organization.OrganizationMemberList.Contains(member),
            "Unauthorized member.");
    }
```

**File:** contract/AElf.Contracts.Association/Association_Helper.cs (L61-71)
```csharp
    private bool Validate(Organization organization)
    {
        if (organization.ProposerWhiteList.Empty() ||
            organization.ProposerWhiteList.AnyDuplicate() ||
            organization.OrganizationMemberList.Empty() ||
            organization.OrganizationMemberList.AnyDuplicate())
            return false;
        if (organization.OrganizationAddress == null || organization.OrganizationHash == null)
            return false;
        var proposalReleaseThreshold = organization.ProposalReleaseThreshold;
        var organizationMemberCount = organization.OrganizationMemberList.Count();
```

**File:** contract/AElf.Contracts.Association/OrganizationMemberList.cs (L7-20)
```csharp
    public int Count()
    {
        return organizationMembers_.Count;
    }

    public bool Empty()
    {
        return Count() == 0;
    }

    public bool Contains(Address address)
    {
        return organizationMembers_.Contains(address);
    }
```
