### Title
ConnectorController Governance Contract Mismatch Allows Arbitrary Account Takeover

### Summary
The TokenConverter contract allows the `ConnectorController` to be set to an arbitrary `AuthorityInfo`, where the `ContractAddress` field is not validated to be a legitimate governance contract. If the current controller colludes or is compromised, an attacker can deploy a contract implementing `ValidateOrganizationExist` that always returns `true`, set `ConnectorController` to this contract with their own address as `OwnerAddress`, and thereby bypass all governance, gaining unrestricted control over connector management.

### Finding Description
In `TokenConverterContract.cs`, the `ChangeConnectorController(AuthorityInfo input)` method validates new controller authority using `CheckOrganizationExist(input)`, which calls `ValidateOrganizationExist` on the `ContractAddress` field provided in the new `AuthorityInfo` [1](#0-0) [2](#0-1) . However, there is no check ensuring that `ContractAddress` corresponds to one of the legitimate governance contracts (Parliament, Association, or Referendum). 

An attacker with control over the current controller can:
1. Deploy a contract at an arbitrary address that returns `true` for `ValidateOrganizationExist`.
2. Call `ChangeConnectorController` with `AuthorityInfo` pointing to (attack contract, attacker EOA).
3. `CheckOrganizationExist` will succeed.
4. Now, future authorization checks in `AssertPerformedByConnectorController()` will only require that `Context.Sender == OwnerAddress`, which the attacker controls, completely bypassing proposal/organization governance [3](#0-2) .

This attack thereby seizes control of connector management and all protected TokenConverter operations with a single controller change transaction, leading to complete protocol compromise.

### Impact Explanation
- **Direct Fund Impact**: Attacker can manipulate connectors, fees, and reserves, draining or freezing funds by disabling or altering liquidity and pricing functions.
- **Auth/Governance Impact**: All critical governance over token conversion is circumvented.
- **Operational Impact**: System trust and separation of powers are broken; potentially protocol-wide if connected to other contracts.

Severity is **critical**: a single storage update leads to total control of all conversion, pricing, and fee-setting logic.

### Likelihood Explanation
- **Attacker capabilities**: Must control `ConnectorController` through governance or compromise (i.e., as owner or via majority/proposal in organization).
- **Attack complexity**: Simple; requires deploying a "YesMan" contract and submitting a single proposal/change transaction.
- **Preconditions**: Attacker must win or control organization, or next in upgrade chain.
- **Feasibility conditions**: No whitelist or on-chain check restricts contract addresses for controller.
- **Operational constraints**: None, aside from initial controller-level auth.
- **Detection**: Attack could be detected after the fact via audit, but not prevented on-chain.

### Recommendation
- Add an explicit check that enforces `ContractAddress` in `AuthorityInfo` is one of the canonical, recognized governance system contract addresses (Parliament, Association, or Referendum). 
- Alternatively, maintain and use a whitelist of allowed governance contract addresses for validation, or verify that the contract implements ACS3 and is deployed by the system.
- Add regression and negative test cases attempting to set invalid contract addresses as controllers to ensure this cannot be bypassed.

### Proof of Concept
1. Attacker deploys a contract implementing `ValidateOrganizationExist` that always returns `true`.
2. Attacker proposes and executes `ChangeConnectorController` on TokenConverter, setting:
    - `AuthorityInfo.ContractAddress` = attack contract,
    - `OwnerAddress` = attacker's own EOA address.
3. The check passes because the malicious contract answers `true`.
4. Attacker directly calls `UpdateConnector`/`SetFeeRate` as themselves, bypassing any organization proposal, and manipulates connector/reserve state at will.

**Expected**: Only Parliament/Association/Referendum organizations can ever gain this right.

**Actual**: Any address can be set as controller, if attacker controls current controller and deploys a malicious contract.

--- [1](#0-0) [2](#0-1) [3](#0-2)

### Citations

**File:** contract/AElf.Contracts.TokenConverter/TokenConverterContract.cs (L303-309)
```csharp
    public override Empty ChangeConnectorController(AuthorityInfo input)
    {
        AssertPerformedByConnectorController();
        Assert(CheckOrganizationExist(input), "new controller does not exist");
        State.ConnectorController.Value = input;
        return new Empty();
    }
```

**File:** contract/AElf.Contracts.TokenConverter/TokenConverterContract.cs (L397-403)
```csharp
    private void AssertPerformedByConnectorController()
    {
        if (State.ConnectorController.Value == null) State.ConnectorController.Value = GetDefaultConnectorController();

        Assert(Context.Sender == State.ConnectorController.Value.OwnerAddress,
            "Only manager can perform this action.");
    }
```

**File:** contract/AElf.Contracts.TokenConverter/TokenConverterContract_ACS1_TransactionFeeProvider.cs (L71-76)
```csharp
    private bool CheckOrganizationExist(AuthorityInfo authorityInfo)
    {
        return Context.Call<BoolValue>(authorityInfo.ContractAddress,
            nameof(AuthorizationContractContainer.AuthorizationContractReferenceState.ValidateOrganizationExist),
            authorityInfo.OwnerAddress).Value;
    }
```
