### Title
Incomplete Threshold Validation Allows Creation of Deadlocked Organizations

### Summary
The `Validate(Organization)` function at lines 77-80 fails to verify that the sum of `MaximalAbstentionThreshold`, `MaximalRejectionThreshold`, and `MinimalApprovalThreshold` does not exceed `organizationMemberCount`. This allows creation of organizations where no proposal can ever pass, resulting in permanent governance deadlock.

### Finding Description

The validation logic in the `Validate(Organization)` function [1](#0-0)  performs two independent checks:

1. `MaximalAbstentionThreshold + MinimalApprovalThreshold <= organizationMemberCount` (lines 77-78)
2. `MaximalRejectionThreshold + MinimalApprovalThreshold <= organizationMemberCount` (lines 79-80)

However, it does NOT validate that: `MaximalAbstentionThreshold + MaximalRejectionThreshold + MinimalApprovalThreshold >= organizationMemberCount`

The proposal release logic [2](#0-1)  requires that:
- Rejections must be ≤ `MaximalRejectionThreshold` (or proposal is rejected)
- Abstentions must be ≤ `MaximalAbstentionThreshold` (or proposal is abstained/failed)
- Approvals must be ≥ `MinimalApprovalThreshold`

When a proposal receives exactly `MinimalApprovalThreshold` approvals, the remaining `(organizationMemberCount - MinimalApprovalThreshold)` members must vote abstention or rejection. If `(MaximalAbstentionThreshold + MaximalRejectionThreshold) < (organizationMemberCount - MinimalApprovalThreshold)`, then any distribution of remaining votes will exceed at least one threshold, making approval mathematically impossible.

**Example:**
- `organizationMemberCount = 10`
- `MinimalApprovalThreshold = 5`
- `MaximalAbstentionThreshold = 2`
- `MaximalRejectionThreshold = 2`

Current validation passes: `2+5=7≤10 ✓` and `2+5=7≤10 ✓`

But with 5 approvals, 5 members remain. Need abstentions ≤2 AND rejections ≤2, but `2+2=4<5`. Any distribution of 5 members will violate at least one threshold.

### Impact Explanation

**Operational Impact - Permanent Governance DoS:**
- Organizations with invalid threshold configurations become permanently deadlocked
- All proposals fail regardless of voting distribution
- No mechanism exists to fix the organization (threshold changes also require proposals)
- Affects organizations created via `CreateOrganization` [3](#0-2)  and `ChangeOrganizationThreshold` [4](#0-3) 

**Severity: Medium**
- High impact (complete governance failure for affected organizations)
- Medium likelihood (requires misconfiguration, but can occur accidentally or maliciously)
- Permanent and irreversible once organization is created
- No fund theft, but operational denial of service

### Likelihood Explanation

**Reachable Entry Point:** `CreateOrganization` is a public method callable by any user [3](#0-2) 

**Feasible Preconditions:** 
- Attacker (or legitimate user) needs no special permissions
- Can create organization with arbitrary threshold parameters
- Configuration may occur accidentally during legitimate setup

**Execution Practicality:**
- Single transaction creates deadlocked organization
- No complex state manipulation required
- Validation passes with specific threshold combinations

**Economic Rationality:**
- Low cost (single organization creation)
- Could be accidental misconfiguration
- Could be intentional to create honeypot organizations

**Detection:** The tests [5](#0-4)  validate individual threshold constraints but do NOT test the combined constraint scenario.

### Recommendation

Add the missing validation check in the `Validate(Organization)` function:

```csharp
return proposalReleaseThreshold.MinimalVoteThreshold <= organizationMemberCount &&
       proposalReleaseThreshold.MinimalApprovalThreshold <= proposalReleaseThreshold.MinimalVoteThreshold &&
       proposalReleaseThreshold.MinimalApprovalThreshold > 0 &&
       proposalReleaseThreshold.MaximalAbstentionThreshold >= 0 &&
       proposalReleaseThreshold.MaximalRejectionThreshold >= 0 &&
       proposalReleaseThreshold.MaximalAbstentionThreshold +
       proposalReleaseThreshold.MinimalApprovalThreshold <= organizationMemberCount &&
       proposalReleaseThreshold.MaximalRejectionThreshold +
       proposalReleaseThreshold.MinimalApprovalThreshold <= organizationMemberCount &&
       // NEW CHECK: Ensure proposal can theoretically pass
       proposalReleaseThreshold.MaximalAbstentionThreshold +
       proposalReleaseThreshold.MaximalRejectionThreshold +
       proposalReleaseThreshold.MinimalApprovalThreshold >= organizationMemberCount;
```

**Test case to add:**
```csharp
// Test: Invalid configuration where approval is mathematically impossible
var minimalApproveThreshold = 5;
var maximalAbstentionThreshold = 2;
var maximalRejectionThreshold = 2;
var memberCount = 10; // 3 members
// 2 + 2 + 5 = 9 < 10, should fail validation
```

### Proof of Concept

**Step 1:** Create organization with deadlocked thresholds
```
CreateOrganizationInput:
  OrganizationMemberList: 10 members
  ProposalReleaseThreshold:
    MinimalApprovalThreshold: 5
    MinimalVoteThreshold: 5
    MaximalAbstentionThreshold: 2
    MaximalRejectionThreshold: 2
```

**Step 2:** Create and vote on proposal
- Proposal receives 5 approvals (minimum required)
- Remaining 5 members must vote
- Any distribution (e.g., 3 abstentions + 2 rejections) exceeds MaximalAbstentionThreshold(2)
- Any distribution (e.g., 2 abstentions + 3 rejections) exceeds MaximalRejectionThreshold(2)

**Expected Result:** Organization created successfully, proposal release threshold can be reached

**Actual Result:** Organization created successfully, but `IsReleaseThresholdReached` [6](#0-5)  always returns false - permanent governance deadlock

**Success Condition:** Validation should reject organization creation with error "Invalid organization."

### Citations

**File:** contract/AElf.Contracts.Association/Association_Helper.cs (L24-44)
```csharp
    private bool IsReleaseThresholdReached(ProposalInfo proposal, Organization organization)
    {
        var isRejected = IsProposalRejected(proposal, organization);
        if (isRejected)
            return false;

        var isAbstained = IsProposalAbstained(proposal, organization);
        return !isAbstained && CheckEnoughVoteAndApprovals(proposal, organization);
    }

    private bool IsProposalRejected(ProposalInfo proposal, Organization organization)
    {
        var rejectionMemberCount =
            proposal.Rejections.Count(organization.OrganizationMemberList.Contains);
        return rejectionMemberCount > organization.ProposalReleaseThreshold.MaximalRejectionThreshold;
    }

    private bool IsProposalAbstained(ProposalInfo proposal, Organization organization)
    {
        var abstentionMemberCount = proposal.Abstentions.Count(organization.OrganizationMemberList.Contains);
        return abstentionMemberCount > organization.ProposalReleaseThreshold.MaximalAbstentionThreshold;
```

**File:** contract/AElf.Contracts.Association/Association_Helper.cs (L61-81)
```csharp
    private bool Validate(Organization organization)
    {
        if (organization.ProposerWhiteList.Empty() ||
            organization.ProposerWhiteList.AnyDuplicate() ||
            organization.OrganizationMemberList.Empty() ||
            organization.OrganizationMemberList.AnyDuplicate())
            return false;
        if (organization.OrganizationAddress == null || organization.OrganizationHash == null)
            return false;
        var proposalReleaseThreshold = organization.ProposalReleaseThreshold;
        var organizationMemberCount = organization.OrganizationMemberList.Count();
        return proposalReleaseThreshold.MinimalVoteThreshold <= organizationMemberCount &&
               proposalReleaseThreshold.MinimalApprovalThreshold <= proposalReleaseThreshold.MinimalVoteThreshold &&
               proposalReleaseThreshold.MinimalApprovalThreshold > 0 &&
               proposalReleaseThreshold.MaximalAbstentionThreshold >= 0 &&
               proposalReleaseThreshold.MaximalRejectionThreshold >= 0 &&
               proposalReleaseThreshold.MaximalAbstentionThreshold +
               proposalReleaseThreshold.MinimalApprovalThreshold <= organizationMemberCount &&
               proposalReleaseThreshold.MaximalRejectionThreshold +
               proposalReleaseThreshold.MinimalApprovalThreshold <= organizationMemberCount;
    }
```

**File:** contract/AElf.Contracts.Association/Association.cs (L69-94)
```csharp
    public override Address CreateOrganization(CreateOrganizationInput input)
    {
        var organizationHashAddressPair = CalculateOrganizationHashAddressPair(input);
        var organizationAddress = organizationHashAddressPair.OrganizationAddress;
        var organizationHash = organizationHashAddressPair.OrganizationHash;
        var organization = new Organization
        {
            ProposalReleaseThreshold = input.ProposalReleaseThreshold,
            OrganizationAddress = organizationAddress,
            ProposerWhiteList = input.ProposerWhiteList,
            OrganizationMemberList = input.OrganizationMemberList,
            OrganizationHash = organizationHash,
            CreationToken = input.CreationToken
        };
        Assert(Validate(organization), "Invalid organization.");
        if (State.Organizations[organizationAddress] == null)
        {
            State.Organizations[organizationAddress] = organization;
            Context.Fire(new OrganizationCreated
            {
                OrganizationAddress = organizationAddress
            });
        }

        return organizationAddress;
    }
```

**File:** contract/AElf.Contracts.Association/Association.cs (L203-216)
```csharp
    public override Empty ChangeOrganizationThreshold(ProposalReleaseThreshold input)
    {
        var organization = State.Organizations[Context.Sender];
        Assert(organization != null, "Organization not found.");
        organization.ProposalReleaseThreshold = input;
        Assert(Validate(organization), "Invalid organization.");
        State.Organizations[Context.Sender] = organization;
        Context.Fire(new OrganizationThresholdChanged
        {
            OrganizationAddress = Context.Sender,
            ProposerReleaseThreshold = input
        });
        return new Empty();
    }
```

**File:** test/AElf.Contracts.Association.Tests/AssociationContractTests.cs (L178-328)
```csharp
    public async Task Create_Organization_Failed_Test()
    {
        //invalid MinimalApprovalThreshold
        {
            var minimalApproveThreshold = 0;
            var minimalVoteThreshold = 3;
            var maximalAbstentionThreshold = 0;
            var maximalRejectionThreshold = 0;

            var createOrganizationInput = GenerateCreateOrganizationInput(minimalApproveThreshold,
                minimalVoteThreshold,
                maximalAbstentionThreshold, maximalRejectionThreshold, Reviewer1);

            var transactionResult =
                await AssociationContractStub.CreateOrganization.SendWithExceptionAsync(createOrganizationInput);
            transactionResult.TransactionResult.Status.ShouldBe(TransactionResultStatus.Failed);
            transactionResult.TransactionResult.Error.Contains("Invalid organization.").ShouldBeTrue();
        }

        //invalid MinimalApprovalThreshold
        {
            var minimalApproveThreshold = 4;
            var minimalVoteThreshold = 3;
            var maximalAbstentionThreshold = 0;
            var maximalRejectionThreshold = 0;


            var createOrganizationInput = GenerateCreateOrganizationInput(minimalApproveThreshold,
                minimalVoteThreshold,
                maximalAbstentionThreshold, maximalRejectionThreshold, Reviewer1);

            var transactionResult =
                await AssociationContractStub.CreateOrganization.SendWithExceptionAsync(createOrganizationInput);
            transactionResult.TransactionResult.Status.ShouldBe(TransactionResultStatus.Failed);
            transactionResult.TransactionResult.Error.Contains("Invalid organization.").ShouldBeTrue();
        }

        //invalid MinimalApprovalThreshold
        {
            var minimalApproveThreshold = 2;
            var minimalVoteThreshold = 1;
            var maximalAbstentionThreshold = 0;
            var maximalRejectionThreshold = 0;

            var createOrganizationInput = GenerateCreateOrganizationInput(minimalApproveThreshold,
                minimalVoteThreshold,
                maximalAbstentionThreshold, maximalRejectionThreshold, Reviewer1);

            var transactionResult =
                await AssociationContractStub.CreateOrganization.SendWithExceptionAsync(createOrganizationInput);
            transactionResult.TransactionResult.Status.ShouldBe(TransactionResultStatus.Failed);
            transactionResult.TransactionResult.Error.Contains("Invalid organization.").ShouldBeTrue();
        }

        //invalid minimalVoteThreshold
        {
            var minimalApproveThreshold = 1;
            var minimalVoteThreshold = 0;
            var maximalAbstentionThreshold = 0;
            var maximalRejectionThreshold = 0;

            var createOrganizationInput = GenerateCreateOrganizationInput(minimalApproveThreshold,
                minimalVoteThreshold,
                maximalAbstentionThreshold, maximalRejectionThreshold, Reviewer1);
            var transactionResult =
                await AssociationContractStub.CreateOrganization.SendWithExceptionAsync(createOrganizationInput);
            transactionResult.TransactionResult.Status.ShouldBe(TransactionResultStatus.Failed);
            transactionResult.TransactionResult.Error.Contains("Invalid organization.").ShouldBeTrue();
        }

        //invalid maximalAbstentionThreshold
        {
            var minimalApproveThreshold = 1;
            var minimalVoteThreshold = 3;
            var maximalAbstentionThreshold = 4;
            var maximalRejectionThreshold = 0;

            var createOrganizationInput = GenerateCreateOrganizationInput(minimalApproveThreshold,
                minimalVoteThreshold,
                maximalAbstentionThreshold, maximalRejectionThreshold, Reviewer1);
            var transactionResult =
                await AssociationContractStub.CreateOrganization.SendWithExceptionAsync(createOrganizationInput);
            transactionResult.TransactionResult.Status.ShouldBe(TransactionResultStatus.Failed);
            transactionResult.TransactionResult.Error.Contains("Invalid organization.").ShouldBeTrue();
        }

        //invalid minimalVoteThreshold + maximalAbstentionThreshold
        {
            var minimalApproveThreshold = 3;
            var minimalVoteThreshold = 3;
            var maximalAbstentionThreshold = 1;
            var maximalRejectionThreshold = 0;

            var createOrganizationInput = GenerateCreateOrganizationInput(minimalApproveThreshold,
                minimalVoteThreshold,
                maximalAbstentionThreshold, maximalRejectionThreshold, Reviewer1);
            var transactionResult =
                await AssociationContractStub.CreateOrganization.SendWithExceptionAsync(createOrganizationInput);
            transactionResult.TransactionResult.Status.ShouldBe(TransactionResultStatus.Failed);
            transactionResult.TransactionResult.Error.Contains("Invalid organization.").ShouldBeTrue();
        }

        //invalid minimalVoteThreshold + maximalRejectionThreshold
        {
            var minimalApproveThreshold = 3;
            var minimalVoteThreshold = 3;
            var maximalAbstentionThreshold = 0;
            var maximalRejectionThreshold = 1;

            var createOrganizationInput = GenerateCreateOrganizationInput(minimalApproveThreshold,
                minimalVoteThreshold,
                maximalAbstentionThreshold, maximalRejectionThreshold, Reviewer1);
            var transactionResult =
                await AssociationContractStub.CreateOrganization.SendWithExceptionAsync(createOrganizationInput);
            transactionResult.TransactionResult.Status.ShouldBe(TransactionResultStatus.Failed);
            transactionResult.TransactionResult.Error.Contains("Invalid organization.").ShouldBeTrue();
        }

        // empty proposer white list
        {
            var minimalApproveThreshold = 1;
            var minimalVoteThreshold = 2;
            var maximalAbstentionThreshold = 0;
            var maximalRejectionThreshold = 0;

            var createOrganizationInput = GenerateCreateOrganizationInput(minimalApproveThreshold,
                minimalVoteThreshold,
                maximalAbstentionThreshold, maximalRejectionThreshold);
            var transactionResult =
                await AssociationContractStub.CreateOrganization.SendWithExceptionAsync(createOrganizationInput);
            transactionResult.TransactionResult.Status.ShouldBe(TransactionResultStatus.Failed);
            transactionResult.TransactionResult.Error.Contains("Invalid organization.").ShouldBeTrue();
        }

        // empty organization members
        {
            var minimalApproveThreshold = 1;
            var minimalVoteThreshold = 2;
            var maximalAbstentionThreshold = 0;
            var maximalRejectionThreshold = 0;

            var createOrganizationInput = GenerateCreateOrganizationInput(minimalApproveThreshold,
                minimalVoteThreshold,
                maximalAbstentionThreshold, maximalRejectionThreshold, Reviewer1);
            createOrganizationInput.OrganizationMemberList = new OrganizationMemberList();
            var transactionResult =
                await AssociationContractStub.CreateOrganization.SendWithExceptionAsync(createOrganizationInput);
            transactionResult.TransactionResult.Status.ShouldBe(TransactionResultStatus.Failed);
            transactionResult.TransactionResult.Error.Contains("Invalid organization.").ShouldBeTrue();
        }
    }
```
