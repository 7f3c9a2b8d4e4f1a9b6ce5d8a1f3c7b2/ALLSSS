[
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: ModifyFreeFeeAllowanceAmount()] [Allowance Overflow] Line 151 does addAmount += currentAllowance. If currentAllowance is large and addAmount is negative but small, can this overflow and set allowance to maximum value instead of decrementing? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_7fb6a556-3e02-4c8a-964e-195ed89611e1?mode=deep",
    "timestamp": "2026-02-19 15:00:03.311845",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: ModifyFreeFeeAllowanceAmount()] [Zero Allowance Skip] Line 149 skips if currentAllowance == 0, but what if allowance becomes 0 during iteration? Does loop continue with stale addAmount value, causing incorrect deductions? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_52195e5a-452a-475a-84a5-33a135c315a0?mode=deep",
    "timestamp": "2026-02-19 15:00:25.599802",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: ModifyFreeFeeAllowanceAmount()] [Early Break Exploit] Line 143 breaks if addAmount >= 0, but does this allow attacker to deliberately overpay in early allowances to avoid consuming later ones with longer expiration, gaming the system? (Low)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_b2c0c99a-a812-4827-87da-dec86e90f035?mode=deep",
    "timestamp": "2026-02-19 15:00:48.116331",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: GetSymbolListSortedByExpirationTime()] [Time Calculation Underflow] Line 161 computes RefreshSeconds - (CurrentBlockTime - LastRefreshTime).Seconds. If CurrentBlockTime < LastRefreshTime, can this underflow and sort allowances incorrectly? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_43318818-cd81-4842-811d-512d67bebb8a?mode=deep",
    "timestamp": "2026-02-19 15:01:11.061551",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: GetSymbolListSortedByExpirationTime()] [Sorting DoS] If transactionFeeFreeAllowancesMap contains thousands of symbols, can attacker add entries to make OrderBy operation extremely expensive, causing DoS on fee allowance checks? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_b24f030e-01cf-427e-a75b-3aed04ba8404?mode=deep",
    "timestamp": "2026-02-19 15:01:35.488859",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: GetFreeFeeAllowanceAmount()] [Overflow in Aggregation] Line 190 does allowance.Add(freeAllowance?.Amount ?? 0L). If map contains many large values, can sum overflow Int64.MaxValue, wrapping to negative and bypassing fee checks? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_467c594a-5fb2-417b-beb6-bc5f62ef4ac9?mode=deep",
    "timestamp": "2026-02-19 15:02:02.035629",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: GetFreeFeeAllowanceAmount()] [Null Map DoS] Line 184 returns 0 if map is null, but what if map exists but all Values are null? Does foreach loop handle this gracefully or cause exception? (Low)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_cbc3ab32-ebf6-46ba-bf64-3e9dd00f2595?mode=deep",
    "timestamp": "2026-02-19 15:02:28.042661",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: GetBalance()] [Symbol Alias Manipulation] GetActualTokenSymbol is called but not shown. If alias resolution has bugs, can attacker query balance of wrong token or bypass balance checks by using crafted aliases? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_15521c2c-8f8f-49a6-ae0d-656d3f0baf4f?mode=deep",
    "timestamp": "2026-02-19 15:02:54.056149",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: GetBalance()] [Address Validation Bypass] AssertValidInputAddress checks address not null/empty, but does it prevent zero address or system addresses from being queried, potentially leaking system balance information? (Low)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_245c7d9d-237e-4f6b-9b54-80e2c29f69ba?mode=deep",
    "timestamp": "2026-02-19 15:03:20.407619",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: GetBalance()] [Uninitialized Balance] If State.Balances[address][symbol] was never set, does it return 0 or null? Can this cause type confusion or unexpected behavior in balance checks? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_3a96d383-476f-4b37-8e8a-9f1adcfe1e2c?mode=deep",
    "timestamp": "2026-02-19 15:03:52.151462",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: AssertSystemContractOrLockWhiteListAddress()] [Whitelist Race Condition] Lines 198-199 check State.LockWhiteLists[symbol][Context.Sender]. Can whitelist be modified between check and actual lock operation, allowing unauthorized locks? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_dda5ea86-7ce2-459c-a0d2-12332307ecd2?mode=deep",
    "timestamp": "2026-02-19 15:04:23.055641",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: AssertSystemContractOrLockWhiteListAddress()] [System Contract Impersonation] Line 200 gets system contract addresses. Can attacker deploy contract at predicted address before system contract is deployed, then get system privileges for locking? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_7dc076f9-66f8-437d-a98e-529ff7490f92?mode=deep",
    "timestamp": "2026-02-19 15:04:48.947978",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: AssertSystemContractOrLockWhiteListAddress()] [Whitelist Bypass via NULL Symbol] If symbolState is null (line 198), isInWhiteList becomes false. But can attacker pass empty/null symbol to bypass whitelist checks if system contract check also fails? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_f79b7660-14e3-49bf-9162-d956c92a9c61?mode=deep",
    "timestamp": "2026-02-19 15:05:14.656449",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: AssertSystemContractOrLockWhiteListAddress()] [OR Logic Exploitation] Line 202 uses OR operator. If system contract list is empty or corrupted, does this make isInWhiteList check the only gate, allowing whitelist manipulation to grant full access? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_1d531ee8-b898-475e-ab0b-00ebf42bda38?mode=deep",
    "timestamp": "2026-02-19 15:05:44.718721",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: ExtractTokenContractAddress()] [Parser Vulnerability] Line 207 uses ValidateSystemContractAddressInput.Parser.ParseFrom(bytes). Can malformed protobuf cause exception that's not caught, DoS-ing cross-chain token operations? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_aafc692c-b3aa-4926-9166-1a5c8dfcae2c?mode=deep",
    "timestamp": "2026-02-19 15:06:12.470159",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: ExtractTokenContractAddress()] [Hash Name Validation] Line 211 checks SystemContractHashName equals TokenContractSystemHashName. Can attacker find hash collision to make arbitrary contract address pass validation? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_c5d6cf6c-894e-44a8-8a4c-7bf07d8ac74c?mode=deep",
    "timestamp": "2026-02-19 15:06:45.390755",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: ExtractTokenContractAddress()] [Address Validation Bypass] If validatedAddress is extracted but not verified to be non-null/non-zero, can attacker pass zero address to bypass cross-chain validation? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_bdfc87dd-197b-461b-8712-77ded4958a67?mode=deep",
    "timestamp": "2026-02-19 15:07:17.440727",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: AssertCrossChainTransaction()] [Method Name Bypass] Line 219 checks if methodName is in validMethodNames array. If array is empty or contains wildcard, can attacker call any method and pass validation? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_c9012064-84b5-4bae-bf98-f1bc204c55b3?mode=deep",
    "timestamp": "2026-02-19 15:07:43.951772",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: AssertCrossChainTransaction()] [Transaction Malleability] originalTransaction fields (MethodName, To) are checked but not Signature or other fields. Can attacker replay cross-chain transaction with modified signature/params? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_cad631e4-f905-42b1-b901-c5869771f444?mode=deep",
    "timestamp": "2026-02-19 15:08:16.510763",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: AssertCrossChainTransaction()] [Multiple Valid Addresses] Function takes single validAddress but validMethodNames is array. Can attacker call valid method on wrong contract if only To address is checked, not method-address pairing? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_e37d25ba-9beb-46a4-a804-23fbfc74f64b?mode=deep",
    "timestamp": "2026-02-19 15:08:45.900798",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: CrossChainVerify()] [Merkle Path Manipulation] Lines 236-249 construct VerifyTransactionInput with merklePath. Can attacker provide valid merkle path for different transaction to pass verification? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_b14f6a8e-941b-48ff-8310-da7325ee8de4?mode=deep",
    "timestamp": "2026-02-19 15:09:18.487629",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: CrossChainVerify()] [Chain ID Spoofing] verifiedChainId is passed as parameter. Can attacker provide chainId of trusted chain while actually submitting from untrusted chain? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_d525bd43-30fe-4873-8494-1426050e7faa?mode=deep",
    "timestamp": "2026-02-19 15:09:51.878384",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: CrossChainVerify()] [Parent Chain Height Rollback] parentChainHeight parameter is not validated against current height. Can attacker use old height with old merkle proof to replay expired cross-chain transactions? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_ba87e6f0-eb78-4695-9091-54ca0894d827?mode=deep",
    "timestamp": "2026-02-19 15:10:26.016256",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: CrossChainVerify()] [CrossChain Contract Call Failure] Line 247 calls VerifyTransaction but if it reverts, does error propagate correctly or can transaction continue with unverified cross-chain data? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_ee45404f-dc36-4d9a-9b94-458dfef9a321?mode=deep",
    "timestamp": "2026-02-19 15:10:55.572925",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: CrossChainVerify()] [BoolValue Result Tampering] Line 248 checks verificationResult.Value, but can attacker manipulate Context.Call return value before check, or exploit proto deserialization to always return true? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_968051c6-277e-4c1c-89dc-544457fad3db?mode=deep",
    "timestamp": "2026-02-19 15:11:27.635244",
    "report_generated": false
  }
]