[
  {
    "question": "[File: contract/AElf.Contracts.Profit/ProfitContract.cs] [Function: DistributeProfits()] [Negative Period] Line 485 allows input.Period < 0 to trigger burning. Can this be abused by malicious managers to destroy legitimate profits meant for beneficiaries? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_2ec4e80a-2a79-4c7d-8b0b-8c781d90e8b7?mode=deep",
    "timestamp": "2026-02-19 05:12:15.885685",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Profit/ProfitContract.cs] [Function: DistributeProfits()] [TotalShares Zero] Lines 485-486 return early and burn profits if totalShares <= 0. Can attackers force TotalShares to 0 through RemoveBeneficiary to cause profit loss? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_f2d7fcb7-429a-4bbc-907d-456c34f14ef2?mode=deep",
    "timestamp": "2026-02-19 05:12:38.006459",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Profit/ProfitContract.cs] [Function: DistributeProfits()] [CachedDelayTotalShares] Lines 464-476 manipulate CachedDelayTotalShares. If period + DelayDistributePeriodCount overflows, can this cause incorrect cache entries and wrong totalShares calculations? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_22690e86-46e9-4c31-add8-f88b846e336b?mode=deep",
    "timestamp": "2026-02-19 05:13:00.235843",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Profit/ProfitContract.cs] [Function: DistributeProfits()] [Empty AmountsMap] If input.AmountsMap is empty and IsReleaseAllBalanceEveryTimeByDefault is false, lines 448-460 result in empty profitsMap. Can this cause silent no-op distributions without error? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_33fc27a6-c787-4b73-bbba-3c100bb37d39?mode=deep",
    "timestamp": "2026-02-19 05:13:22.890854",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Profit/ProfitContract.cs] [Function: DistributeProfits()] [Balance Query] Lines 437-443 query token balance with amount.Value == 0. Can this consume excessive gas if called repeatedly with many tokens, enabling DoS? (Low)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_fa52bee1-d800-42bb-96d8-5f743731cbbd?mode=deep",
    "timestamp": "2026-02-19 05:13:47.098741",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Profit/ProfitContract.cs] [Function: DistributeProfits()] [Authorization] Lines 426-428 allow Manager or TokenHolder contract. Can TokenHolder trigger distribution at incorrect periods, disrupting expected profit schedules? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_d74dd87f-dfdf-4f02-9b84-7cbaa8ca0d55?mode=deep",
    "timestamp": "2026-02-19 05:14:11.716610",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Profit/ProfitContract.cs] [Function: DistributeProfits()] [Virtual Address] Line 483 computes profitsReceivingVirtualAddress from schemeId and period. Can hash collisions cause different periods to share the same virtual address, mixing profits? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_05e8b771-1d5c-4056-a0ab-251f23ee7039?mode=deep",
    "timestamp": "2026-02-19 05:14:36.907935",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Profit/ProfitContract.cs] [Function: DistributeProfits()] [State Update] CurrentPeriod is incremented at line 494 after distribution. If distribution fails but CurrentPeriod is already updated, can this cause period skipping? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_899a6293-359e-4521-932e-99209f95d077?mode=deep",
    "timestamp": "2026-02-19 05:15:02.543707",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Profit/ProfitContract.cs] [Function: DistributeProfits()] [Symbol Validation] Line 420 asserts symbols are not empty, but doesn't verify tokens exist. Can distributing non-existent tokens cause state corruption or profit loss? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_2e305b59-7f1f-481a-a645-0be942ca2737?mode=deep",
    "timestamp": "2026-02-19 05:15:29.548514",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Profit/ProfitContract.cs] [Function: BurnProfits()] [Insufficient Balance] Lines 537-538 check if balance < amount and continue on insufficient funds. Can this cause partial burns where some tokens are burned but not others, leading to inconsistent state? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_c22ec068-4efc-48ff-9749-65e48a06a5b2?mode=deep",
    "timestamp": "2026-02-19 05:15:56.222677",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Profit/ProfitContract.cs] [Function: BurnProfits()] [Negative Amounts] Line 551 stores -amount in distributedProfitsInfo.AmountsMap. Can this negative value cause issues in subsequent calculations expecting positive amounts? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_71056b08-e7c1-4fe3-b2d1-22d2b157675d?mode=deep",
    "timestamp": "2026-02-19 05:16:25.400640",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Profit/ProfitContract.cs] [Function: BurnProfits()] [Transfer Before Burn] Lines 539-545 transfer to Context.Self before burning at lines 546-550. Can a reentrancy attack during transfer drain funds before burn executes? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_7413e577-dd10-4e10-9697-9fcf00092c99?mode=deep",
    "timestamp": "2026-02-19 05:16:53.701561",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Profit/ProfitContract.cs] [Function: BurnProfits()] [Period Increment] Line 520 increments CurrentPeriod even when burning. Can this cause period numbers to advance without corresponding profit distribution, confusing beneficiaries? (Low)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_e9b99100-8295-43b7-9c2a-3ed69d52fc4a?mode=deep",
    "timestamp": "2026-02-19 05:17:22.109588",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Profit/ProfitContract.cs] [Function: BurnProfits()] [Virtual Address Inline] Line 539 uses SendVirtualInline with scheme.SchemeId. Can this fail silently if virtual address operations fail, leaving tokens untransferred? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_14a1382b-2f29-43ef-acad-33e68a499367?mode=deep",
    "timestamp": "2026-02-19 05:17:48.780195",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Profit/ProfitContract.cs] [Function: PerformDistributeProfits()] [Remain Amount] Line 592 calculates remainAmount from DistributeProfitsForSubSchemes. If this calculation has rounding errors, can remain amount be larger than totalAmount, causing transfer failures? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_1f52583c-facd-4ee6-805e-8fda125a6455?mode=deep",
    "timestamp": "2026-02-19 05:18:17.561618",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Profit/ProfitContract.cs] [Function: PerformDistributeProfits()] [Zero Transfers] Line 595 checks if remainAmount != 0 before transfer. Can remainAmount be 0 for all tokens, leaving all profits locked in sub-schemes without reaching individual beneficiaries? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_cea78ca3-7dd2-46da-af83-79ef889e225c?mode=deep",
    "timestamp": "2026-02-19 05:18:44.686846",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Profit/ProfitContract.cs] [Function: PerformDistributeProfits()] [Virtual Transfer Failure] Lines 596-602 use SendVirtualInline. If this fails, is there error handling, or can profits be silently lost? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_dafc9739-2067-4570-b034-c8811fd83001?mode=deep",
    "timestamp": "2026-02-19 05:19:13.408819",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Profit/ProfitContract.cs] [Function: DistributeProfitsForSubSchemes()] [Precision Loss] Line 621 uses SafeCalculateProfits which converts to decimal. Can repeated precision loss across multiple sub-schemes cause sum(distributed) != totalAmount? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_5a760927-c6a9-40e9-b6c8-9794a360297a?mode=deep",
    "timestamp": "2026-02-19 05:19:41.266707",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Profit/ProfitContract.cs] [Function: DistributeProfitsForSubSchemes()] [Remain Calculation] Line 631 subtracts distributeAmount from remainAmount. If distributeAmount is calculated incorrectly due to rounding, can remainAmount become negative? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_a52cd8b0-9abb-4b59-9cd8-1eb1babbe1e5?mode=deep",
    "timestamp": "2026-02-19 05:20:10.243237",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Profit/ProfitContract.cs] [Function: DistributeProfitsForSubSchemes()] [LastProfitPeriod Update] Line 635 updates LastProfitPeriod to CurrentPeriod for all details. Can this cause issues if sub-scheme hasn't actually claimed profits yet? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_8c19929b-f668-423f-a804-018432c22752?mode=deep",
    "timestamp": "2026-02-19 05:20:39.289289",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Profit/ProfitContract.cs] [Function: DistributeProfitsForSubSchemes()] [SubItemDetail Null] Line 634 assumes subItemDetail exists. If it's null (sub-scheme has no profit details), can this cause null reference exception? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_4dae2a89-6f3d-4846-b95e-9467593d0114?mode=deep",
    "timestamp": "2026-02-19 05:21:07.868021",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Profit/ProfitContract.cs] [Function: DistributeProfitsForSubSchemes()] [Symbol Tracking] Lines 641-644 add symbol to ReceivedTokenSymbols. Can this list grow unboundedly if many different tokens are distributed, causing state bloat? (Low)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_7d665d7e-7c04-4ccb-9724-1779af0ef1cb?mode=deep",
    "timestamp": "2026-02-19 05:21:37.143753",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Profit/ProfitContract.cs] [Function: DistributeProfitsForSubSchemes()] [TotalShares Zero] SafeCalculateProfits at line 621 divides by totalShares. If totalShares is 0, can this cause division by zero or return incorrect 0 amounts? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_5106a2f3-5969-44dd-92b9-0fa18c2821f1?mode=deep",
    "timestamp": "2026-02-19 05:22:06.228296",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Profit/ProfitContract.cs] [Function: DistributeProfitsForSubSchemes()] [Nested Sub-Schemes] If sub-schemes have their own sub-schemes, distributions happen sequentially. Can deep nesting cause stack overflow or excessive gas consumption for distribution? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_099b07d7-b0d4-4b90-9ac0-52a4de33ab6e?mode=deep",
    "timestamp": "2026-02-19 05:22:34.507549",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Profit/ProfitContract.cs] [Function: ContributeProfits()] [Period Validation] Line 684 asserts input.Period >= CurrentPeriod. Can an attacker contribute to far future periods, locking funds indefinitely until those periods are reached? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_96cc167b-b786-469e-bc20-a76aee07d1bb?mode=deep",
    "timestamp": "2026-02-19 05:23:03.485676",
    "report_generated": false
  }
]