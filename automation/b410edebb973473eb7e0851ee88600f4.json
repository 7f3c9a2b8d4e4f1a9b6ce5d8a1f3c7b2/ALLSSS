[
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [Beneficiary Removal DOS] RemoveBeneficiaries is called with all miner addresses - if list is very large, can this exceed gas limits and prevent reward updates? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_618ac604-30a8-4503-97f8-ae4ee77a83da?mode=deep",
    "timestamp": "2026-02-19 10:38:42.327552",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [Shares Calculation Error] CalculateShares can return 0 if producedBlocks < average/2 - if many miners return 0, will AddBeneficiaries add them with 0 shares, wasting gas and storage? (Low)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_00756716-5448-4bbd-8ccf-e91b313c50f6?mode=deep",
    "timestamp": "2026-02-19 10:39:04.713026",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [Evil Miner Advantage] If IsReplacedEvilMiner is true, shares = producedBlocks directly without CalculateShares penalty - can evil miner replacement be gamed to get higher shares than deserved? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_23fa7191-dcc0-4f44-9c62-e481426684e6?mode=deep",
    "timestamp": "2026-02-19 10:39:27.021805",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [State Cleanup Failure] State.IsReplacedEvilMiner.Remove is called inside the loop - if Remove fails silently, will the flag persist and give unfair advantage in future periods? (Low)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_35ce08a6-a1f8-4e89-9d26-19a325c5a8ee?mode=deep",
    "timestamp": "2026-02-19 10:39:50.040166",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [Wrong EndPeriod] EndPeriod is set to previousTermInformation.Last().TermNumber - shouldn't it be +1 for the NEXT term since we're setting weights for future distribution? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_af28b900-a0b4-4f5c-a9b5-46d590f95090?mode=deep",
    "timestamp": "2026-02-19 10:40:14.106486",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: CalculateAverage()] [Division Precision] Sum divided by count using integer division - for small lists or odd sums, can this cause average to be significantly wrong, affecting fairness of CalculateShares? (Low)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_0401dad3-6a25-4dee-9e78-214339059ca0?mode=deep",
    "timestamp": "2026-02-19 10:40:38.982742",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: CalculateShares()] [Threshold Gaming] Returns 0 if blocks < average/2, and different formula if blocks < 4*average/5 - can miners game their block production to just meet thresholds and maximize shares/effort ratio? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_3d132e61-9caf-4b04-82e0-c0253a911a2b?mode=deep",
    "timestamp": "2026-02-19 10:41:04.204750",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: CalculateShares()] [Non-Linear Scaling] Formula is producedBlocks^2 / average for middle tier - this quadratic scaling can cause enormous share differences for small production differences, is this intended? (Low)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_95f3f44d-d214-4881-b1b4-db8ffd765795?mode=deep",
    "timestamp": "2026-02-19 10:41:32.759076",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateWelcomeRewardWeights()] [Complete Removal] All previous miner addresses removed from scheme - if RemoveBeneficiaries fails partially, can some addresses remain and get double rewards (old + new term)? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_03933aac-b6dc-46c3-84c8-6677591686a8?mode=deep",
    "timestamp": "2026-02-19 10:42:00.377784",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateWelcomeRewardWeights()] [Sub-Scheme Removal] RemoveSubScheme is called for BasicRewardHash - if this fails but RemoveBeneficiaries succeeds, will BasicReward become orphaned and unable to receive any rewards? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_699d582e-6b69-4d42-b569-c98eb437b2df?mode=deep",
    "timestamp": "2026-02-19 10:42:31.162532",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateWelcomeRewardWeights()] [Logic Branch Risk] If no new miners, reward goes to BasicReward via sub-scheme - but if newElectedMiners is empty, EndPeriod isn't set consistently with the else branch AddSubScheme call? (Low)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_061e3df0-9bb4-4693-819f-9356f8fb8135?mode=deep",
    "timestamp": "2026-02-19 10:43:02.037223",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateWelcomeRewardWeights()] [Beneficiary Share Validation] All new miners get 1 share regardless of their contribution or stake - can this be exploited by colluding to force miner turnover and split welcome rewards? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_e965ed7d-e78f-4d91-88ac-cf68e68ab103?mode=deep",
    "timestamp": "2026-02-19 10:43:33.826091",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateWelcomeRewardWeights()] [Duplicate Addition] No check if miner is already a beneficiary - if AddBeneficiaries is called twice for same miner, do they get double shares? (Low)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_3948dca1-708c-4856-952b-a173d761b86f?mode=deep",
    "timestamp": "2026-02-19 10:44:02.951030",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateFlexibleRewardWeights()] [Double Removal] Both WelfareHash and BasicRewardHash are removed as sub-schemes - if either was never added, will RemoveSubScheme fail and block the entire function? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_890fbd26-46b0-4d98-a786-8f9256174654?mode=deep",
    "timestamp": "2026-02-19 10:44:31.631302",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateFlexibleRewardWeights()] [TotalShares Check] If TotalShares > 0, beneficiaries are removed - but shouldn't this always be done regardless, to clean up previous period? Can old beneficiaries linger? (Low)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_3000fe95-bc30-4cb2-8b1f-a4ac56ce575b?mode=deep",
    "timestamp": "2026-02-19 10:45:03.528490",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateFlexibleRewardWeights()] [State Flag Dependency] Uses State.HasNewMiner to determine routing - if this flag is set incorrectly (race condition in Release), can rewards be misrouted permanently? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_7018e96d-fe7d-4fd3-9618-2b8f105c4d5c?mode=deep",
    "timestamp": "2026-02-19 10:45:36.050784",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateFlexibleRewardWeights()] [Missing EndPeriod] AddSubScheme calls don't specify EndPeriod - will the sub-scheme remain connected indefinitely, potentially receiving rewards for wrong periods? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_a1351fff-d07a-4f64-863e-4da6c3db9178?mode=deep",
    "timestamp": "2026-02-19 10:46:09.666738",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: ChangeTreasuryController()] [Authorization Check Timing] AssertPerformedByTreasuryController is called first - if current controller is compromised, they can set arbitrary new controller with no recovery mechanism? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_51195183-e454-4566-b65d-5f036fb2f574?mode=deep",
    "timestamp": "2026-02-19 10:46:39.408876",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: ChangeTreasuryController()] [Organization Validation] CheckOrganizationExist is called, but what if organization exists but is malicious/compromised - can controller be changed to attacker address permanently? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_a90829a8-a6bc-4d94-94cc-292a44203795?mode=deep",
    "timestamp": "2026-02-19 10:47:12.931454",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: ChangeTreasuryController()] [No Emergency Recovery] Once controller is changed, there's no fallback or time-lock - if new controller address is wrong or compromised, treasury becomes permanently unmanageable? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_88cbfcea-b00d-4fb6-aa3e-5810357d78aa?mode=deep",
    "timestamp": "2026-02-19 10:47:42.313787",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: AssertPerformedByTreasuryController()] [Default Fallback] If State.TreasuryController.Value is null, falls back to GetDefaultTreasuryController - can this be exploited before explicit controller is set? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_3270ede6-e80d-42a5-837d-93dad6203580?mode=deep",
    "timestamp": "2026-02-19 10:48:12.112988",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: GetDefaultTreasuryController()] [Parliament Dependency] Returns Parliament's default organization address - if Parliament contract is compromised or not initialized, can this return attacker-controlled address? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_923384d8-bb70-44a0-87cf-613b5d2808a9?mode=deep",
    "timestamp": "2026-02-19 10:48:46.257816",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateMiningReward()] [Authorization] Only consensus contract can call - but if consensus contract is compromised, can attacker set arbitrary mining reward amount, inflating or deflating rewards permanently? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_13a62a41-852e-4a37-acc6-3fae1e7274a0?mode=deep",
    "timestamp": "2026-02-19 10:49:15.605832",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateMiningReward()] [No Validation] No bounds checking on input.Value - can negative values cause accounting errors, or extremely large values cause overflow in GetDividends calculation? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_a967d749-da42-4a6a-902f-6bfcace10158?mode=deep",
    "timestamp": "2026-02-19 10:49:50.876732",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateMiningReward()] [State Overwrite] Simply overwrites State.MiningReward.Value - if called multiple times per block, does last call win, potentially losing previous mining rewards? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_f9fcaaa9-4d3a-40f0-b552-152f18e398f6?mode=deep",
    "timestamp": "2026-02-19 10:50:26.372098",
    "report_generated": false
  }
]