[
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: Withdraw()] [Timestamp Edge Case] Line 227 uses strict less-than (<). If lock timestamp + minutes EQUALS current time, withdrawal fails. Is this one-block delay exploitable? (Low)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_282b6ef3-15ca-4c49-a04d-7bb45f93c04d?mode=deep",
    "timestamp": "2026-02-19 14:19:02.600238",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: Withdraw()] [LockId Validation] Line 219 asserts lockId != null, but doesn't validate lockId matches expected hash. Can lockId be manipulated in state to unlock wrong user's tokens? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_a4423e19-14ff-446f-908f-4762f7624f0b?mode=deep",
    "timestamp": "2026-02-19 14:19:24.900692",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: ClaimProfits()] [Authorization Bypass] Line 250 allows input.Beneficiary to be null, defaulting to Context.Sender. Can scheme manager claim profits on behalf of ANY beneficiary by specifying their address? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_aa1daac3-e30f-4a6f-be3c-7d964e8dea41?mode=deep",
    "timestamp": "2026-02-19 14:19:47.965441",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: ClaimProfits()] [Front-Running] Can scheme manager front-run user ClaimProfits by first calling DistributeProfits to change period, causing user's claim to fail or claim wrong period? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_da8fb982-f6ef-46dd-a341-11202fa8c95c?mode=deep",
    "timestamp": "2026-02-19 14:20:11.703599",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: ClaimProfits()] [Input Validation] No validation that beneficiary is actually registered in the scheme. Can claiming for non-existent beneficiary cause errors or state corruption? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_ea834e87-5b4a-4ed2-8bdc-ce8d3a9a26b5?mode=deep",
    "timestamp": "2026-02-19 14:20:36.244395",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: ClaimProfits()] [Reentrancy] Line 251 delegates to ProfitContract.ClaimProfits. Can malicious ProfitContract re-enter TokenHolderContract during claim to manipulate state? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_5fcc72a1-9efc-4de3-b735-28b546696759?mode=deep",
    "timestamp": "2026-02-19 14:21:03.373047",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: ClaimProfits()] [DOS Attack] Can attacker repeatedly claim zero profits to consume gas and DOS the claiming mechanism? Should there be rate limiting or minimum claim amounts? (Low)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_749d6e51-ddff-416d-b676-dcf92d6e7137?mode=deep",
    "timestamp": "2026-02-19 14:21:30.354654",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: ClaimProfits()] [State Desync] If ProfitContract.ClaimProfits succeeds but TokenHolderContract state is inconsistent (wrong period, wrong SchemeId), can user claim profits they shouldn't be entitled to? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_76c60f89-545b-416e-815b-6dbcd0e642c5?mode=deep",
    "timestamp": "2026-02-19 14:22:01.196934",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: ClaimProfits()] [Scheme Validation] Line 249 calls GetValidScheme which may update scheme state. Can claiming trigger unwanted state updates that affect other users? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_59a261bb-61aa-4198-b47d-658940308244?mode=deep",
    "timestamp": "2026-02-19 14:22:31.482066",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: GetValidScheme()] [Null Pointer] Line 281 asserts scheme != null, but if scheme doesn't exist, can calling functions that depend on GetValidScheme be permanently DOSed? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_f5aa8ae1-983a-48d9-a009-44a37c893ec1?mode=deep",
    "timestamp": "2026-02-19 14:22:59.125104",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: GetValidScheme()] [State Mutation] GetValidScheme calls UpdateTokenHolderProfitScheme which modifies state. Should a getter function modify state? Can this cause unexpected side effects? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_88b25a58-4f71-426b-bea5-c9966c797769?mode=deep",
    "timestamp": "2026-02-19 14:23:31.384517",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: GetValidScheme()] [Parameter Inconsistency] updateSchemePeriod parameter at line 278 is only used in one code path. Can inconsistent usage lead to bugs where period is updated when it shouldn't be? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_e1d3169a-65ec-4a28-a103-47e57bed8e43?mode=deep",
    "timestamp": "2026-02-19 14:24:03.953152",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: UpdateTokenHolderProfitScheme()] [State Corruption] Line 289 returns early if SchemeId is set and not updating period. Can this cause scheme data to become stale (wrong Period, Symbol, thresholds)? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_240cf0a7-a66a-4410-8340-bbc0f37e84d8?mode=deep",
    "timestamp": "2026-02-19 14:24:31.451548",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: UpdateTokenHolderProfitScheme()] [Wrong Manager] Line 298 saves scheme to State.TokenHolderProfitSchemes[Context.Sender], but function parameter is 'manager'. Can this cause schemes to be saved under wrong keys? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_d0081692-aa8c-43fd-9316-d747eb63ee32?mode=deep",
    "timestamp": "2026-02-19 14:25:04.218531",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: UpdateTokenHolderProfitScheme()] [FirstOrDefault Risk] Line 293's FirstOrDefault returns null if no schemes exist. Line 294 asserts not null, but is timing gap exploitable between CreateScheme and first update? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_194bf35d-b200-4588-b6e5-f0b2eff3c3b1?mode=deep",
    "timestamp": "2026-02-19 14:25:37.857378",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: UpdateTokenHolderProfitScheme()] [Period Desync] Line 297 sets scheme.Period from originScheme.CurrentPeriod. If ProfitContract's period is manipulated or incremented separately, can TokenHolder and Profit contracts have different periods? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_e00ce3b3-53ad-46bc-b732-79dc9429d601?mode=deep",
    "timestamp": "2026-02-19 14:26:12.803878",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: UpdateTokenHolderProfitScheme()] [Cross-Contract Call] Lines 290-293 call GetManagingSchemeIds. Can malicious ProfitContract return wrong SchemeIds, causing UpdateTokenHolderProfitScheme to link to attacker's scheme? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_ae17dc9a-1ac0-452d-8cc6-5ecde3d6a058?mode=deep",
    "timestamp": "2026-02-19 14:26:48.800569",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Cross-Function] [State Race] Can CreateScheme and AddBeneficiary be called concurrently before SchemeId is initialized, causing AddBeneficiary to fail or use wrong scheme? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_b85aa962-bc16-4ce0-9e94-2de6d9de564a?mode=deep",
    "timestamp": "2026-02-19 14:27:18.932281",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Cross-Function] [Authorization Chain] GetValidScheme is called by multiple functions but doesn't verify caller authorization. Can unauthorized callers exploit functions that use GetValidScheme? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_1071478d-8197-4965-93ff-59bd90eb498e?mode=deep",
    "timestamp": "2026-02-19 14:27:55.348592",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Cross-Function] [Lock-Unlock Race] Between RegisterForProfits locking tokens and Withdraw unlocking, can RemoveBeneficiary be called to remove user as beneficiary while tokens remain locked? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_ef6b1f7b-dcfd-470e-b02e-4e0b8d7c5742?mode=deep",
    "timestamp": "2026-02-19 14:28:29.687643",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Cross-Function] [Period Increment] Both DistributeProfits (line 144) and RegisterForProfits (line 204) increment scheme.Period. Can race conditions cause period to skip numbers or increment incorrectly? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_f726f214-fa9a-46c6-b7ae-1c8419eaec23?mode=deep",
    "timestamp": "2026-02-19 14:29:05.624581",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Cross-Function] [Beneficiary Management] AddBeneficiary and RemoveBeneficiary don't coordinate with RegisterForProfits. Can scheme manager remove users who registered via RegisterForProfits, leaving their tokens locked? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_119e75b0-b647-4209-9ce0-057f157678ca?mode=deep",
    "timestamp": "2026-02-19 14:29:41.819268",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Cross-Function] [Profit Contribution Race] If ContributeProfits and RegisterForProfits auto-distribution happen concurrently, can profits be distributed twice or lost entirely? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_7ff29c6e-0807-4f5a-84e0-c43eb34e6668?mode=deep",
    "timestamp": "2026-02-19 14:30:17.330561",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Cross-Function] [Scheme Modification] Can scheme manager modify scheme parameters (Symbol, MinimumLockMinutes, AutoDistributeThreshold) after users register, breaking their expectations? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_3313296b-0a2a-44a9-8c74-cc5a977dde97?mode=deep",
    "timestamp": "2026-02-19 14:30:52.591461",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Cross-Function] [Claim-Withdraw Race] Can user call ClaimProfits and Withdraw concurrently, claiming profits after beneficiary status is removed? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_c6d4455b-5772-4c6c-bdbd-69ad6e3467e1?mode=deep",
    "timestamp": "2026-02-19 14:31:27.495919",
    "report_generated": false
  }
]