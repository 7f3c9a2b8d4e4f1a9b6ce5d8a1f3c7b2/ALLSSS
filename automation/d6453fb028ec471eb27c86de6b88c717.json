[
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: ModifyFreeFeeAllowanceAmount()] [Allowance Overflow] Line 151 does addAmount += currentAllowance. If currentAllowance is large and addAmount is negative but small, can this overflow and set allowance to maximum value instead of decrementing? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_f22b919c-bf27-4efc-99ec-8a0b1aa75a28?mode=deep",
    "timestamp": "2026-02-19 12:51:05.156592",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: ModifyFreeFeeAllowanceAmount()] [Zero Allowance Skip] Line 149 skips if currentAllowance == 0, but what if allowance becomes 0 during iteration? Does loop continue with stale addAmount value, causing incorrect deductions? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_70686ce1-1530-4285-b675-8087d125cbe8?mode=deep",
    "timestamp": "2026-02-19 12:51:27.263617",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: ModifyFreeFeeAllowanceAmount()] [Early Break Exploit] Line 143 breaks if addAmount >= 0, but does this allow attacker to deliberately overpay in early allowances to avoid consuming later ones with longer expiration, gaming the system? (Low)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_a83bb8fc-32c6-4d39-a346-10c31db5a334?mode=deep",
    "timestamp": "2026-02-19 12:51:49.657068",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: GetSymbolListSortedByExpirationTime()] [Time Calculation Underflow] Line 161 computes RefreshSeconds - (CurrentBlockTime - LastRefreshTime).Seconds. If CurrentBlockTime < LastRefreshTime, can this underflow and sort allowances incorrectly? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_ee503163-abb9-4496-b0af-f75c783d07b8?mode=deep",
    "timestamp": "2026-02-19 12:52:13.456474",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: GetSymbolListSortedByExpirationTime()] [Sorting DoS] If transactionFeeFreeAllowancesMap contains thousands of symbols, can attacker add entries to make OrderBy operation extremely expensive, causing DoS on fee allowance checks? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_87db9d73-20a9-4cc9-8f71-6a4e790efe21?mode=deep",
    "timestamp": "2026-02-19 12:52:37.555786",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: GetFreeFeeAllowanceAmount()] [Overflow in Aggregation] Line 190 does allowance.Add(freeAllowance?.Amount ?? 0L). If map contains many large values, can sum overflow Int64.MaxValue, wrapping to negative and bypassing fee checks? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_e7765d55-7b60-4d27-ae32-07a4cff517d6?mode=deep",
    "timestamp": "2026-02-19 12:53:02.348969",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: GetFreeFeeAllowanceAmount()] [Null Map DoS] Line 184 returns 0 if map is null, but what if map exists but all Values are null? Does foreach loop handle this gracefully or cause exception? (Low)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_e4a34d2c-18c0-4da7-b4ea-c88e00077727?mode=deep",
    "timestamp": "2026-02-19 12:53:27.757613",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: GetBalance()] [Symbol Alias Manipulation] GetActualTokenSymbol is called but not shown. If alias resolution has bugs, can attacker query balance of wrong token or bypass balance checks by using crafted aliases? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_c3d1ae71-e64a-48e1-9407-1fd305b383e6?mode=deep",
    "timestamp": "2026-02-19 12:53:53.940597",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: GetBalance()] [Address Validation Bypass] AssertValidInputAddress checks address not null/empty, but does it prevent zero address or system addresses from being queried, potentially leaking system balance information? (Low)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_bd1bd0d0-d3be-4534-b3cb-eae4a05ae1b8?mode=deep",
    "timestamp": "2026-02-19 12:54:25.584842",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: GetBalance()] [Uninitialized Balance] If State.Balances[address][symbol] was never set, does it return 0 or null? Can this cause type confusion or unexpected behavior in balance checks? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_d7c60f63-d620-4f9a-8e88-c41a96e4083f?mode=deep",
    "timestamp": "2026-02-19 12:54:57.364877",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: AssertSystemContractOrLockWhiteListAddress()] [Whitelist Race Condition] Lines 198-199 check State.LockWhiteLists[symbol][Context.Sender]. Can whitelist be modified between check and actual lock operation, allowing unauthorized locks? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_7684d79e-406c-456a-a54b-67d6a12c0c49?mode=deep",
    "timestamp": "2026-02-19 12:55:30.129600",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: AssertSystemContractOrLockWhiteListAddress()] [System Contract Impersonation] Line 200 gets system contract addresses. Can attacker deploy contract at predicted address before system contract is deployed, then get system privileges for locking? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_9fe4d787-0886-4c5d-b619-57da661dfe67?mode=deep",
    "timestamp": "2026-02-19 12:55:59.251597",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: AssertSystemContractOrLockWhiteListAddress()] [Whitelist Bypass via NULL Symbol] If symbolState is null (line 198), isInWhiteList becomes false. But can attacker pass empty/null symbol to bypass whitelist checks if system contract check also fails? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_b6edd8a2-814c-4a53-960a-a55967e1b936?mode=deep",
    "timestamp": "2026-02-19 12:56:26.813116",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: AssertSystemContractOrLockWhiteListAddress()] [OR Logic Exploitation] Line 202 uses OR operator. If system contract list is empty or corrupted, does this make isInWhiteList check the only gate, allowing whitelist manipulation to grant full access? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_e0fc2920-dab1-46fd-8498-3336d4cf12c8?mode=deep",
    "timestamp": "2026-02-19 12:56:53.864970",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: ExtractTokenContractAddress()] [Parser Vulnerability] Line 207 uses ValidateSystemContractAddressInput.Parser.ParseFrom(bytes). Can malformed protobuf cause exception that's not caught, DoS-ing cross-chain token operations? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_544bc92c-c0b3-4e16-80b8-355a429fd204?mode=deep",
    "timestamp": "2026-02-19 12:57:26.639696",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: ExtractTokenContractAddress()] [Hash Name Validation] Line 211 checks SystemContractHashName equals TokenContractSystemHashName. Can attacker find hash collision to make arbitrary contract address pass validation? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_fbecd6ca-caf7-45ca-8610-18dff8f4a4a8?mode=deep",
    "timestamp": "2026-02-19 12:57:54.971815",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: ExtractTokenContractAddress()] [Address Validation Bypass] If validatedAddress is extracted but not verified to be non-null/non-zero, can attacker pass zero address to bypass cross-chain validation? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_cc014e73-13ca-4941-863e-39641e8413a3?mode=deep",
    "timestamp": "2026-02-19 12:58:23.359711",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: AssertCrossChainTransaction()] [Method Name Bypass] Line 219 checks if methodName is in validMethodNames array. If array is empty or contains wildcard, can attacker call any method and pass validation? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_ff5780f0-a32c-451f-89e6-4c1abe03f45f?mode=deep",
    "timestamp": "2026-02-19 12:58:55.466088",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: AssertCrossChainTransaction()] [Transaction Malleability] originalTransaction fields (MethodName, To) are checked but not Signature or other fields. Can attacker replay cross-chain transaction with modified signature/params? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_e6f5b9d1-9ce4-45fa-9858-a3ee9669a278?mode=deep",
    "timestamp": "2026-02-19 12:59:22.851678",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: AssertCrossChainTransaction()] [Multiple Valid Addresses] Function takes single validAddress but validMethodNames is array. Can attacker call valid method on wrong contract if only To address is checked, not method-address pairing? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_32601ce7-d763-43c4-b352-68d0434dac0d?mode=deep",
    "timestamp": "2026-02-19 12:59:50.740303",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: CrossChainVerify()] [Merkle Path Manipulation] Lines 236-249 construct VerifyTransactionInput with merklePath. Can attacker provide valid merkle path for different transaction to pass verification? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_e705daf7-32c9-4498-a222-c0ac9376d167?mode=deep",
    "timestamp": "2026-02-19 13:00:24.815486",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: CrossChainVerify()] [Chain ID Spoofing] verifiedChainId is passed as parameter. Can attacker provide chainId of trusted chain while actually submitting from untrusted chain? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_e037dfa8-c6b4-44b8-8d76-18f67ffc8a81?mode=deep",
    "timestamp": "2026-02-19 13:00:58.532067",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: CrossChainVerify()] [Parent Chain Height Rollback] parentChainHeight parameter is not validated against current height. Can attacker use old height with old merkle proof to replay expired cross-chain transactions? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_8b441cbb-8b40-49c4-b061-711547b4b6d6?mode=deep",
    "timestamp": "2026-02-19 13:01:24.205782",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: CrossChainVerify()] [CrossChain Contract Call Failure] Line 247 calls VerifyTransaction but if it reverts, does error propagate correctly or can transaction continue with unverified cross-chain data? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_804cd9d0-8612-45a2-99be-ba3d96b325a1?mode=deep",
    "timestamp": "2026-02-19 13:01:51.171766",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: CrossChainVerify()] [BoolValue Result Tampering] Line 248 checks verificationResult.Value, but can attacker manipulate Context.Call return value before check, or exploit proto deserialization to always return true? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_d9bb1024-dc28-4610-97c4-50d6726574a3?mode=deep",
    "timestamp": "2026-02-19 13:02:18.768277",
    "report_generated": false
  }
]