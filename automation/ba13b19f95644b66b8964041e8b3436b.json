[
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: DoTransfer()] [Event Fire After State Change] Line 106 fires event after state modifications - can reentrancy attack through event observers modify state before event is fully processed? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_968022a7-b55d-4c61-a876-401d819dba74?mode=deep",
    "timestamp": "2026-02-19 10:59:49.686453",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: DoTransfer()] [Memo Size Validation] Line 103 validates memo but line 112 includes memo in event - can malicious memo cause event processing DoS or exceed block size limits? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_df4bbddb-853b-41e6-b5b6-5d5d4eea995f?mode=deep",
    "timestamp": "2026-02-19 11:00:12.018790",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: DoTransfer()] [Empty Memo Default] Line 112 defaults to empty string if memo is null - can this cause ambiguity between explicitly empty vs null memo in event processing? (Low)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_bcdcc42a-4d77-4162-9a69-027858762712?mode=deep",
    "timestamp": "2026-02-19 11:00:34.490781",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: AssertValidMemo()] [UTF8 Byte Count] Line 90 uses Encoding.UTF8.GetByteCount which can vary per character - can attacker craft memo with multi-byte UTF8 chars that appear short in length but exceed byte limit? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_f165a530-5b92-4e48-9977-324b25acfe19?mode=deep",
    "timestamp": "2026-02-19 11:00:57.755377",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: ModifyFreeFeeAllowanceAmount()] [Insufficient Balance Check] Lines 132-136 check 'freeAllowanceAmount < -addAmount' but don't verify if final result after loop is non-negative - can this cause negative allowance? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_3c534993-aca3-4501-808d-a6f674032dad?mode=deep",
    "timestamp": "2026-02-19 11:01:23.136730",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: ModifyFreeFeeAllowanceAmount()] [Loop Variable Mutation] Lines 141-154 modify addAmount within loop and use it as loop exit condition - can attacker craft allowances to cause infinite loop or incorrect deduction? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_9ecc622a-83f7-4e1a-8010-0a5087a01d84?mode=deep",
    "timestamp": "2026-02-19 11:01:49.360896",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: ModifyFreeFeeAllowanceAmount()] [Expiration Time Calculation] Line 161 calculates expiration as 'RefreshSeconds - (CurrentBlockTime - LastRefreshTime).Seconds' - can integer underflow occur if LastRefreshTime > CurrentBlockTime due to time manipulation? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_27df3ed7-bfc1-46bc-840e-d4b63a65911d?mode=deep",
    "timestamp": "2026-02-19 11:02:14.961786",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: ModifyFreeFeeAllowanceAmount()] [Allowance Depletion Order] Lines 145-147 skip symbols not containing the target symbol - can attacker structure allowance map to prevent certain symbols from being depleted, causing fee bypass? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_17f20d36-163f-4d42-af75-ce0258a372b1?mode=deep",
    "timestamp": "2026-02-19 11:02:44.838500",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: ModifyFreeFeeAllowanceAmount()] [Zero Amount Continuation] Line 149 skips currentAllowance == 0 but continues loop - can attacker add many zero-allowance entries to cause gas exhaustion DoS? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_a590e9ac-737c-4d4f-9ba0-8ff74325b099?mode=deep",
    "timestamp": "2026-02-19 11:03:14.241597",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: ModifyFreeFeeAllowanceAmount()] [Negative AddAmount Logic] Line 151 does 'addAmount += currentAllowance' when addAmount < 0 - if currentAllowance is large, can addAmount become positive, violating deduction invariant? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_4b79c3e5-85a6-4614-acee-08c4d93bba6d?mode=deep",
    "timestamp": "2026-02-19 11:03:41.215566",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: ModifyFreeFeeAllowanceAmount()] [Conditional Assignment] Line 153 assigns 'addAmount >= 0 ? addAmount : 0' - if addAmount becomes positive in middle of loop, does this leave remaining allowances unprocessed? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_141b393a-f6db-48c5-b6ca-9574517ca7ff?mode=deep",
    "timestamp": "2026-02-19 11:04:12.360840",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: GetSymbolListSortedByExpirationTime()] [Timestamp Subtraction] Lines 161-163 compute 'RefreshSeconds - (CurrentBlockTime - LastRefreshTime).Seconds' - can this produce negative values if refresh is overdue, causing incorrect sort order? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_f88671bc-af45-4eef-9dd6-d6d856cf3a28?mode=deep",
    "timestamp": "2026-02-19 11:04:44.497088",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: GetSymbolListSortedByExpirationTime()] [State Access in Lambda] Lines 161-162 access State within OrderBy lambda - can this cause performance issues or reentrancy if State access triggers external calls? (Low)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_b9d46beb-6915-4747-876d-f8a286706d2f?mode=deep",
    "timestamp": "2026-02-19 11:05:15.995299",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: GetFreeFeeAllowanceAmount()] [Map Null Check] Line 184 returns 0 if map is null, but line 186 iterates map.Values - can map be non-null but Values be null causing NullReferenceException? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_c14748f6-dc86-4e3a-9c0e-2063f1f3b993?mode=deep",
    "timestamp": "2026-02-19 11:05:47.129350",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: GetFreeFeeAllowanceAmount()] [TryGetValue Without Success Check] Line 188 uses TryGetValue but doesn't check success - can this include null values in allowance sum if symbol doesn't exist? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_c6a9a33b-308e-46b9-bc2e-0403014beadf?mode=deep",
    "timestamp": "2026-02-19 11:06:19.856174",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: GetFreeFeeAllowanceAmount()] [Accumulation Overflow] Line 190 does 'allowance.Add(freeAllowance?.Amount ?? 0L)' - can accumulated allowance overflow long.MaxValue if many large allowances exist? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_3f979301-d032-48bc-acee-a4f002d6127b?mode=deep",
    "timestamp": "2026-02-19 11:06:52.388810",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: AssertSystemContractOrLockWhiteListAddress()] [Race Condition] Lines 198-199 check whitelist and 200 gets system contracts separately - can attacker manipulate whitelist between these checks to bypass authorization? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_6a8c4d3f-9993-4b38-a875-de3e5a09841d?mode=deep",
    "timestamp": "2026-02-19 11:07:26.384105",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: AssertSystemContractOrLockWhiteListAddress()] [Context.Sender Trust] Line 199 checks Context.Sender which could be manipulated in delegatecall scenario - can attacker spoof sender to bypass whitelist check? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_18acadec-1944-4152-8c2e-b82f925b0ccc?mode=deep",
    "timestamp": "2026-02-19 11:08:00.424896",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: AssertSystemContractOrLockWhiteListAddress()] [System Contract Enumeration] Line 200 calls GetSystemContractNameToAddressMapping().Values - can attacker register fake system contracts to gain whitelist privileges? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_aa66f1f6-140c-4c92-a956-cfabd032dfd1?mode=deep",
    "timestamp": "2026-02-19 11:08:32.083069",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: AssertSystemContractOrLockWhiteListAddress()] [OR Logic Vulnerability] Line 202 allows EITHER whitelist OR system contract - if whitelist is compromised but system contracts are secure, attacker can still bypass check. Should this be AND logic for critical operations? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_26adeb67-3bd9-4a16-8ef5-92fc7392f27a?mode=deep",
    "timestamp": "2026-02-19 11:09:04.694896",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: IsInLockWhiteList()] [Hard-coded Contracts] Lines 380-381 only check Election and Vote contracts - can new governance contracts added later be excluded from whitelist, breaking lock functionality? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_ff7fd1af-9b0c-4e87-89b4-358c94cbf559?mode=deep",
    "timestamp": "2026-02-19 11:09:37.231825",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: GetElectionContractAddress()] [Lazy Initialization Race] Lines 385-389 initialize State.ElectionContractAddress if null - can concurrent calls cause race condition where address is set twice to different values? (Low)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_d89f9d73-2ed2-4031-bc0e-7df3089f5b5e?mode=deep",
    "timestamp": "2026-02-19 11:10:10.614114",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: GetVoteContractAddress()] [Contract Name Dependency] Line 398 uses SmartContractConstants.VoteContractSystemName - if this constant is changed or contract renamed, will lock operations fail permanently? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_eb0d3969-d29d-48bb-9f22-3550c90f2230?mode=deep",
    "timestamp": "2026-02-19 11:10:41.919429",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: CrossChainVerify()] [No Return Value Check] Lines 247-249 call VerifyTransaction but only check .Value field - can malicious CrossChain contract return BoolValue with Value=true without actual verification? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_4324d21b-142e-40e7-a115-8683a011875e?mode=deep",
    "timestamp": "2026-02-19 11:11:14.364530",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: CrossChainVerify()] [Chain ID Validation Missing] Line 242 accepts chainId parameter without validation - can attacker supply invalid/negative chainId to bypass verification or cause integer overflow? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_eabbd25f-f492-4b90-850a-c2189e79e253?mode=deep",
    "timestamp": "2026-02-19 11:11:46.704252",
    "report_generated": false
  }
]