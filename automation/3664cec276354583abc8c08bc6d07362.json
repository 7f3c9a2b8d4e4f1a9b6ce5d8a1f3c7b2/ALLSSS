[
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: DistributeProfits()] [Logic Error] Line 133 calls GetValidScheme with updateSchemePeriod=true, but Period is updated again at line 144 - is there potential for double increment? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_87b267e6-7252-4277-8041-f579d2b1c9df?mode=deep",
    "timestamp": "2026-02-19 04:04:03.537371",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: DistributeProfits()] [Authorization Gap] Why is TokenContract allowed to call DistributeProfits? Could this be exploited to distribute profits at unintended times? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_c0db326f-3361-42e9-8634-78156bdcd3a3?mode=deep",
    "timestamp": "2026-02-19 04:04:26.166238",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: DistributeProfits()] [State Race] Between GetValidScheme and state update at line 145, could another transaction modify the scheme causing inconsistency? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_069b9f3c-65eb-4df0-bcc4-1e7c798feacc?mode=deep",
    "timestamp": "2026-02-19 04:04:49.092862",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [Double Registration Check] Line 151 checks State.LockIds but if it's non-null but invalid, could a user lose access to their first registration while attempting to register again? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_15cb60b6-8bb9-4330-b3f9-36168edc79df?mode=deep",
    "timestamp": "2026-02-19 04:05:12.553043",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [Input Validation] Is input.Amount validated to be positive before locking tokens, or can zero/negative amounts be registered? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_154f6854-daa3-4636-b201-d44085c6a12a?mode=deep",
    "timestamp": "2026-02-19 04:05:36.672573",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [Lock ID Collision] Lines 157-158 generate lockId from SchemeManager and Sender - could hash collisions allow one user to unlock another's tokens? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_20c052eb-1495-4080-ac80-a6c4b0ab4e38?mode=deep",
    "timestamp": "2026-02-19 04:06:02.671467",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [State Inconsistency] If Lock call (line 159) fails after LockIds is set (line 166), is state left inconsistent with a lockId that doesn't exist in token contract? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_42eca31a-9cb5-4a8f-aacb-bf41acf78f09?mode=deep",
    "timestamp": "2026-02-19 04:06:28.448615",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [Timestamp Manipulation] Line 167 stores Context.CurrentBlockTime - can miners manipulate block time to affect withdrawal eligibility? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_6a7ab37c-b214-493c-acbd-fea2512b4152?mode=deep",
    "timestamp": "2026-02-19 04:06:55.042936",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [Share Mismatch] Line 174 adds shares equal to input.Amount - if token has decimals, could this cause share calculation errors? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_bfe7a359-f7e8-421a-bb45-d3a24bd9e0d5?mode=deep",
    "timestamp": "2026-02-19 04:07:21.994964",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [Auto-Distribute Logic Error] Lines 184-199 iterate AutoDistributeThreshold and break on first threshold met - could this miss distributions for other tokens? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_0658e960-deba-478c-b551-10bddb8c31f9?mode=deep",
    "timestamp": "2026-02-19 04:07:51.188385",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [DOS via Auto-Distribute] If AutoDistributeThreshold contains many entries, could iterating and calling GetBalance for each cause gas exhaustion? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_17fae8fe-3955-430d-a6f2-4959cfa9db99?mode=deep",
    "timestamp": "2026-02-19 04:27:17.554781",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [Auto-Distribute Trigger] Line 198 sets AmountsMap[threshold.Key] = 0 - does distributing 0 amount make sense, or should it distribute the actual balance? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_3e54ab5f-7f7a-43db-8efe-33b8e68492b0?mode=deep",
    "timestamp": "2026-02-19 04:27:43.206682",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [Period Desync] Lines 203-205 increment scheme.Period during registration - could this cause period desync if distribution hasn't occurred yet? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_84e047d6-5df5-4c2a-be5e-8872e77da206?mode=deep",
    "timestamp": "2026-02-19 04:28:09.732199",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [Reentrancy] Could malicious token contract's Lock callback reenter RegisterForProfits before LockIds is set, bypassing the double registration check? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_61cfeab6-8058-4639-ab93-18c60bf3880c?mode=deep",
    "timestamp": "2026-02-19 04:28:38.573442",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [Logic Error] Line 191 checks 'if (balance < threshold.Value) continue' - should registration fail if balance is insufficient instead of silently skipping? (Low)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_dccac26c-62fd-4fb2-8e9b-ce7a6a64d54d?mode=deep",
    "timestamp": "2026-02-19 04:29:06.272854",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [State Race] Between checking balance and calling DistributeProfits, could balance change causing distribution to fail or behave unexpectedly? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_aa31c14c-f0fe-4ea2-ab3b-3bf454785bc7?mode=deep",
    "timestamp": "2026-02-19 04:29:36.866735",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [Memory Leak] If distributedInput is created (line 193) but distribution is never called, does this waste gas without cleanup? (Low)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_adcf2223-2b1c-4080-be8b-b0accad568f3?mode=deep",
    "timestamp": "2026-02-19 04:30:07.738728",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: Withdraw()] [Time Validation Error] Line 227 uses '<' instead of '<=' - can users withdraw one block early if CurrentBlockTime equals LockTimestamp + MinimumLockMinutes? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_f6e46a69-34a1-47c4-8682-465521683648?mode=deep",
    "timestamp": "2026-02-19 04:30:41.286465",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: Withdraw()] [Input Parameter] Function takes Address input (scheme manager) but doesn't validate it - can users withdraw from non-existent schemes causing errors? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_745d568f-25b4-4bbf-b111-f6a2411de945?mode=deep",
    "timestamp": "2026-02-19 04:31:11.599680",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: Withdraw()] [State Consistency] Lines 238 and 239-242 remove from LockIds and ProfitContract - if RemoveBeneficiary fails, are tokens unlocked but shares remain? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_b8b79fb4-d10c-409a-84e0-a6fa1c17ea72?mode=deep",
    "timestamp": "2026-02-19 04:31:42.801784",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: Withdraw()] [Profit Loss] RemoveBeneficiary is called immediately - do users lose unclaimed profits if they withdraw without claiming first? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_619a9ee0-6759-4a27-9b90-af8bd905e3fb?mode=deep",
    "timestamp": "2026-02-19 04:32:13.841632",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: Withdraw()] [Unlock Failure] If Unlock call fails (line 230), but LockIds is already removed (line 238), can user never recover their locked tokens? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_dab95837-7d3e-4c4b-9cf7-a9a6279e52a4?mode=deep",
    "timestamp": "2026-02-19 04:32:49.052855",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: Withdraw()] [Race Condition] Between getting locked amount (line 220) and unlocking (line 230), could the amount change due to another transaction? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_a549df11-c335-455d-86c3-c4eddee74bd2?mode=deep",
    "timestamp": "2026-02-19 04:33:24.630980",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: Withdraw()] [Timestamp Overflow] AddMinutes on line 227 - if MinimumLockMinutes is extremely large, could this overflow the timestamp causing immediate withdrawal eligibility? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_e2c62bf9-8094-46ce-a3dd-beaabb834290?mode=deep",
    "timestamp": "2026-02-19 04:34:01.802875",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: Withdraw()] [Authorization] Should there be a check to ensure only the user who registered can withdraw, or is Context.Sender check sufficient? (Low)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_570b2cf4-813a-4388-83da-2880a194ac44?mode=deep",
    "timestamp": "2026-02-19 04:34:37.097951",
    "report_generated": false
  }
]