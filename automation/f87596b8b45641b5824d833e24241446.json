[
  {
    "question": "[File: contract/AElf.Contracts.TokenConverter/TokenConverterContract_ACS1_TransactionFeeProvider.cs] [Function: AssertValidToken()] [Integer Validation] Line 80 checks amount >= 0 but doesn't check for overflow - can extremely large positive amounts near long.MaxValue cause issues in fee calculations later? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_77b56111-aab3-4ac8-afc3-8d0885ab9e94?mode=deep",
    "timestamp": "2026-02-19 14:51:13.017711",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenConverter/TokenConverterContract_ACS1_TransactionFeeProvider.cs] [Function: AssertValidToken()] [Null Symbol Check Missing] The function doesn't validate that symbol parameter is not null or empty before using it at line 85 - can null symbols bypass validation or cause exceptions? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_2b3831d6-652d-47ae-b886-55fe2404b0d2?mode=deep",
    "timestamp": "2026-02-19 14:51:35.272447",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenConverter/TokenConverterContract_ACS1_TransactionFeeProvider.cs] [Function: AssertValidToken()] [Token Contract Initialization Race] Lines 81-83 initialize State.TokenContract only if null - can concurrent calls during first initialization cause inconsistent token validation results? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_d4026dc9-2e53-403c-be0c-75fdf02f7b27?mode=deep",
    "timestamp": "2026-02-19 14:51:57.707742",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenConverter/TokenConverterContract_ACS1_TransactionFeeProvider.cs] [Function: AssertValidToken()] [Cross-Contract Call Security] Line 85 calls State.TokenContract.IsTokenAvailableForMethodFee without validating TokenContract address - if compromised, can this return true for invalid tokens? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_05a01bf5-df13-44ef-8678-0a7e5800e5db?mode=deep",
    "timestamp": "2026-02-19 14:52:20.760499",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenConverter/TokenConverterContract_ACS1_TransactionFeeProvider.cs] [Function: AssertValidToken()] [Contract Address Manipulation] Context.GetContractAddressByName at line 83 could return a malicious contract if SmartContractConstants.TokenContractSystemName is compromised - can this bypass token validation? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_f185ef6e-4c36-461b-8add-bf06b8b21b5f?mode=deep",
    "timestamp": "2026-02-19 14:52:44.661572",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenConverter/TokenConverterContract_ACS1_TransactionFeeProvider.cs] [Function: AssertValidToken()] [Validation Bypass] If IsTokenAvailableForMethodFee at line 85 only checks if token is available but not if it actually exists, can non-existent tokens with valid symbols pass validation? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_9a2bbb22-edac-407b-9a15-70443cd3dd4b?mode=deep",
    "timestamp": "2026-02-19 14:53:10.658165",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenConverter/TokenConverterContract_ACS1_TransactionFeeProvider.cs] [Function: AssertValidToken()] [Error Message Formatting] Line 86 formats error message with symbol but doesn't sanitize it - can malicious symbols with special characters cause log injection or display issues? (Low)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_cb6655fa-0a2c-4df7-a4cd-162644a3b615?mode=deep",
    "timestamp": "2026-02-19 14:53:36.807307",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenConverter/TokenConverterContract_ACS1_TransactionFeeProvider.cs] [Function: AssertValidToken()] [Reentrancy through Token Contract] When line 85 calls State.TokenContract.IsTokenAvailableForMethodFee, can a malicious token contract reenter and modify State.TransactionFees before validation completes? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_d3a82bbd-bd64-4a93-a9b7-3e0a7e5dba08?mode=deep",
    "timestamp": "2026-02-19 14:54:05.908179",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenConverter/TokenConverterContract_ACS1_TransactionFeeProvider.cs] [Function: AssertValidToken()] [Boolean Return Trust] Line 85 trusts the .Value of IsTokenAvailableForMethodFee completely - if the token contract returns malformed responses, can validation be bypassed? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_185e68fe-b5b8-4e53-bbd6-df325c02d770?mode=deep",
    "timestamp": "2026-02-19 14:54:33.641254",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenConverter/TokenConverterContract_ACS1_TransactionFeeProvider.cs] [Function: AssertValidToken()] [Case Sensitivity] Symbol comparison at line 85 may be case-sensitive - can attackers use 'ELF' vs 'elf' or similar variations to bypass token validation and fee collection? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_2ab391ec-0f60-4739-b9d8-6dfdae7de56d?mode=deep",
    "timestamp": "2026-02-19 14:55:02.069249",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenConverter/TokenConverterContract_ACS1_TransactionFeeProvider.cs] [Cross-Function] [State Race Condition] If SetMethodFee and ChangeMethodFeeController execute in the same block, can the authorization check at SetMethodFee line 16 pass with old controller but execute after new controller is set at line 29? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_0ab75268-ff8b-4659-8aa8-04ed3114ba6d?mode=deep",
    "timestamp": "2026-02-19 14:55:33.652580",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenConverter/TokenConverterContract_ACS1_TransactionFeeProvider.cs] [Cross-Function] [Initialization Dependency] Both SetMethodFee (line 14) and ChangeMethodFeeController (line 24) call RequiredMethodFeeControllerSet - can race conditions during initialization allow unauthorized parties to set fees before controller is properly initialized? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_ba45618f-96d1-447c-915c-2cb11df6292d?mode=deep",
    "timestamp": "2026-02-19 14:56:02.033190",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenConverter/TokenConverterContract_ACS1_TransactionFeeProvider.cs] [Cross-Function] [Reentrancy Chain] Can a malicious organization contract called by CheckOrganizationExist (line 73) reenter through GetMethodFee (line 37) to observe fee structures mid-validation during ChangeMethodFeeController? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_8dfa4e3f-ca37-46e0-b3c2-c7a2674f9e8e?mode=deep",
    "timestamp": "2026-02-19 14:56:30.592688",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenConverter/TokenConverterContract_ACS1_TransactionFeeProvider.cs] [Cross-Function] [Authority Confusion] AssertSenderAddressWith (line 68) and CheckOrganizationExist (line 73) use different validation approaches - can this inconsistency be exploited to bypass authorization in controller changes? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_083b7dd8-0908-4097-8324-5f61c1c6b919?mode=deep",
    "timestamp": "2026-02-19 14:57:04.243839",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenConverter/TokenConverterContract_ACS1_TransactionFeeProvider.cs] [Cross-Function] [State Consistency] If SetMethodFee fails after AssertValidToken (line 13) validates some tokens but before setting State.TransactionFees (line 17), can partial fee structures remain in an inconsistent state? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_272887a6-306a-4c5a-a1c9-6f511c1a6096?mode=deep",
    "timestamp": "2026-02-19 14:57:38.525390",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenConverter/TokenConverterContract_ACS1_TransactionFeeProvider.cs] [State Management] [MappedState Overwrite] State.TransactionFees is MappedState that can be completely overwritten at SetMethodFee line 17 - can accumulated fee history or important configurations be accidentally erased? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_e261e01c-b144-46cb-84f3-55aa8aa35858?mode=deep",
    "timestamp": "2026-02-19 14:58:06.225007",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenConverter/TokenConverterContract_ACS1_TransactionFeeProvider.cs] [State Management] [SingletonState Race] State.MethodFeeController is SingletonState modified at lines 29 and 63 - can concurrent modifications corrupt this singleton reference? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_f81ac1de-eb07-4f4b-add0-966a702fd139?mode=deep",
    "timestamp": "2026-02-19 14:58:39.602208",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenConverter/TokenConverterContract_ACS1_TransactionFeeProvider.cs] [State Management] [State Initialization Order] State.ParliamentContract (line 54), State.TokenContract (line 82), and State.MethodFeeController (line 63) are lazy-initialized - can dependency order issues cause validation failures? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_e61fdbd8-6ce3-4407-9514-afbf9c791418?mode=deep",
    "timestamp": "2026-02-19 14:59:12.286072",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenConverter/TokenConverterContract_ACS1_TransactionFeeProvider.cs] [State Management] [Missing State Reset] Once State.MethodFeeController is set at line 63, there's no mechanism to reset it if Parliament contract becomes invalid - can this lead to permanent governance lock? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_5c9e2350-16dd-41dc-beb7-4f4b2bbc3d0f?mode=deep",
    "timestamp": "2026-02-19 14:59:46.494266",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenConverter/TokenConverterContract_ACS1_TransactionFeeProvider.cs] [State Management] [Contract Reference Staleness] State.ParliamentContract and State.TokenContract are cached at lines 55 and 83 but never updated - if system contracts are upgraded, do these references become stale? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_6b6883ab-5d6b-4416-8af2-f88fc1c55a31?mode=deep",
    "timestamp": "2026-02-19 15:00:16.269758",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenConverter/TokenConverterContract_ACS1_TransactionFeeProvider.cs] [Economic Attack] [Fee Manipulation] SetMethodFee line 17 allows arbitrary fee changes - can the controller set fees to zero for revenue-generating methods causing economic damage to the protocol? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_971f1dd4-15cd-45f1-9822-2fd12ffc2bcf?mode=deep",
    "timestamp": "2026-02-19 15:00:49.096849",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenConverter/TokenConverterContract\n\n### Citations\n\n**File:** contract/AElf.Contracts.TokenConverter/TokenConverterContract_ACS1_TransactionFeeProvider.cs (L1-90)\n```csharp\nusing AElf.Sdk.CSharp;\nusing AElf.Standards.ACS1;\nusing AElf.Standards.ACS3;\nusing AElf.Types;\nusing Google.Protobuf.WellKnownTypes;\n\nnamespace AElf.Contracts.TokenConverter;\n\npublic partial class TokenConverterContract\n{\n    public override Empty SetMethodFee(MethodFees input)\n    {\n        foreach (var methodFee in input.Fees) AssertValidToken(methodFee.Symbol, methodFee.BasicFee);\n        RequiredMethodFeeControllerSet();\n\n        Assert(Context.Sender == State.MethodFeeController.Value.OwnerAddress,",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_3ae3a00d-2c88-4621-bcbf-967def93a3ae?mode=deep",
    "timestamp": "2026-02-19 15:01:21.665514",
    "report_generated": false
  }
]