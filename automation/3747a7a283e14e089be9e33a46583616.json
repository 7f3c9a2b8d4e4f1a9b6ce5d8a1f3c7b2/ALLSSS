[
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Views.cs] [Function: IsInTransferBlackList()] [Blacklist Query] Can an attacker enumerate all blacklisted addresses by systematically querying IsInTransferBlackList, potentially identifying sanctioned addresses or building a target list? (Low)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_96b8b090-8fdb-4042-a496-6125afcc9b1f?mode=deep",
    "timestamp": "2026-02-19 04:04:55.943996",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.MultiToken/TokenContract_Views.cs]\n\n### Citations\n\n**File:** contract/AElf.Contracts.MultiToken/TokenContract_Views.cs (L1-307)\n```csharp\nï»¿using System;\nusing System.Linq;\nusing AElf.Sdk.CSharp;\nusing AElf.Types;\nusing Google.Protobuf.WellKnownTypes;\n\nnamespace AElf.Contracts.MultiToken;\n\npublic partial class TokenContract\n{\n    [View]\n    public override TokenInfo GetTokenInfo(GetTokenInfoInput input)\n    {\n        return GetTokenInfo(input.Symbol);\n    }\n\n    public override TokenInfo GetNativeTokenInfo(Empty input)\n    {\n        return GetTokenInfo(State.NativeTokenSymbol.Value);\n    }\n\n    public override TokenInfoList GetResourceTokenInfo(Empty input)\n    {\n        var tokenInfoList = new TokenInfoList();\n        foreach (var symbol in Context.Variables.GetStringArray(TokenContractConstants.PayTxFeeSymbolListName)\n                     .Where(symbol =>\n                         GetTokenInfo(symbol) != null))\n            tokenInfoList.Value.Add(GetTokenInfo(symbol));\n\n        foreach (var symbol in Context.Variables.GetStringArray(TokenContractConstants.PayRentalSymbolListName)\n                     .Where(symbol =>\n                         GetTokenInfo(symbol) != null))\n            tokenInfoList.Value.Add(GetTokenInfo(symbol));\n\n        return tokenInfoList;\n    }\n\n    [View]\n    public override GetBalanceOutput GetBalance(GetBalanceInput input)\n    {\n        var symbol = GetActualTokenSymbol(input.Symbol);\n        return new GetBalanceOutput\n        {\n            Symbol = input.Symbol,\n            Owner = input.Owner,\n            Balance = GetBalance(input.Owner, symbol)\n        };\n    }\n    \n    [View]\n    public override GetAllowanceOutput GetAllowance(GetAllowanceInput input)\n    {\n        var symbol = GetActualTokenSymbol(input.Symbol);\n        return new GetAllowanceOutput\n        {\n            Symbol = symbol,\n            Owner = input.Owner,\n            Spender = input.Spender,\n            Allowance = State.Allowances[input.Owner][input.Spender][symbol]\n        };\n    }\n\n    [View]\n    public override GetAllowanceOutput GetAvailableAllowance(GetAllowanceInput input)\n    {\n        var result = new GetAllowanceOutput\n        {\n            Symbol = input.Symbol,\n            Owner = input.Owner,\n            Spender = input.Spender,\n        };\n        var symbol = input.Symbol;\n        var allowance = State.Allowances[input.Owner][input.Spender][symbol];\n        if (CheckSymbolIdentifier(symbol))\n        {\n            result.Allowance = allowance;\n            return result;\n        }\n        var symbolType = GetSymbolType(symbol);\n        allowance = Math.Max(allowance, GetAllSymbolAllowance(input.Owner,input.Spender,out _));\n        if (symbolType == SymbolType.Nft || symbolType == SymbolType.NftCollection)\n        {\n            allowance = Math.Max(allowance, GetNftCollectionAllSymbolAllowance(input.Owner, input.Spender, symbol, out _));\n        }\n        result.Allowance = allowance;\n        return result;\n    }\n\n    private bool CheckSymbolIdentifier(string symbol)\n    {\n        var words = symbol.Split(TokenContractConstants.NFTSymbolSeparator);\n        var allSymbolIdentifier = GetAllSymbolIdentifier();\n        return words[0].Equals(allSymbolIdentifier) || (words.Length > 1 && words[1].Equals(allSymbolIdentifier));\n    }\n    \n    public override BoolValue IsInWhiteList(IsInWhiteListInput input)\n    {\n        return new BoolValue { Value = State.LockWhiteLists[input.Symbol][input.Address] };\n    }\n\n    public override GetLockedAmountOutput GetLockedAmount(GetLockedAmountInput input)\n    {\n        Assert(input.LockId != null,",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_ff97e446-b15a-488c-bc53-44d308d5d58e?mode=deep",
    "timestamp": "2026-02-19 04:05:18.227892",
    "report_generated": false
  }
]