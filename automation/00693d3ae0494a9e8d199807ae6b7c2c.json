[
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: ConvertToNativeToken()] [Native Symbol Balance Assumption] DonateAll at line 682 assumes native token balance is from Sell output - but if treasury already held native tokens, can this donate more than was converted, depleting treasury? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_5e307a19-7c67-4c49-9803-1cdc6449bf23?mode=deep",
    "timestamp": "2026-02-19 00:40:59.957112",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: BuildTreasury()] [Default Weight Setting Application] Lines 691-695 apply default dividend pool weights if null - can an attacker front-run InitialMiningRewardProfitItem to make these calls before BuildTreasury, locking in default weights before controller can change them? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_dc4405de-bacb-4d24-bd0d-440d06e84376?mode=deep",
    "timestamp": "2026-02-19 00:41:22.034062",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: BuildTreasury()] [Double BuildTreasury Call] If BuildTreasury is called multiple times (from InitialMiningRewardProfitItem), will ResetSubSchemeToTreasury at line 693 create duplicate sub-scheme registrations causing double-distributions? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_cb18c21f-5a57-49e3-a882-5d2a85b64f17?mode=deep",
    "timestamp": "2026-02-19 00:41:44.774265",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: ReleaseTreasurySubProfitItems()] [Zero Amount Distribution] Lines 707-734 call DistributeProfits with AmountsMap all set to 0L - does ProfitContract interpret this as 'use current balance' or 'distribute nothing', potentially blocking reward releases? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_46ff99f3-e93c-4854-855d-251f22e52d72?mode=deep",
    "timestamp": "2026-02-19 00:42:07.764231",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: ReleaseTreasurySubProfitItems()] [Distribution Order] Calls distribute in order: RewardHash, VotesWeightRewardHash, ReElectionRewardHash, BasicRewardHash - can changing this order or if one call fails, cause beneficiaries in later schemes to lose their distribution? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_a2306b89-430b-4caf-bd16-209d82b4ec9c?mode=deep",
    "timestamp": "2026-02-19 00:42:31.768662",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: ReleaseTreasurySubProfitItems()] [Period Number Validation] Uses termNumber parameter without validation - can Release pass incorrect term numbers causing distributions to wrong periods or beneficiaries? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_5dbb6dd1-99ed-47fc-92aa-925cf5d76b30?mode=deep",
    "timestamp": "2026-02-19 00:42:57.715203",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [Beneficiary Removal] Lines 780-787 remove previous term beneficiaries - if RemoveBeneficiaries fails due to scheme state, will AddBeneficiaries at line 793 create duplicate shares for miners appearing in both terms? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_ed3a604c-fc4b-4690-9b96-7c8ee00bf158?mode=deep",
    "timestamp": "2026-02-19 00:43:23.612448",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [Address Conversion in GetAddressesFromCandidatePubkeys] Line 785 gets addresses from pubkeys - if a pubkey has custom profits receiver, does RemoveBeneficiaries remove wrong address, leaving stale beneficiaries? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_4e79f5a3-dd57-43d1-95bd-b6acf41d8f93?mode=deep",
    "timestamp": "2026-02-19 00:43:52.042846",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [Average Calculation Precision] Line 789 calls CalculateAverage which divides sum by count - can this lose precision for small miner counts, causing incorrect share calculations at line 811? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_88e49bde-3162-400e-af35-b5296a47bb5b?mode=deep",
    "timestamp": "2026-02-19 00:44:21.819217",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [Replaced Evil Miner Share Calculation] Lines 802-808 give replaced evil miners i.ProducedBlocks shares directly - can this be gamed if evil miner was replaced late in term after producing many blocks, giving replacement excessive shares? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_042731fc-de04-45a0-b3d5-548f2e14f003?mode=deep",
    "timestamp": "2026-02-19 00:44:51.301192",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [IsReplacedEvilMiner Flag Clearing] Line 807 removes flag after using it - if same miner is replaced multiple times in different terms, can the flag be stale from previous term? (Low)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_ffd42d6a-5ea8-4409-8683-55645bddefdc?mode=deep",
    "timestamp": "2026-02-19 00:45:22.255422",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [CalculateShares Logic] Line 811 calls CalculateShares with complex thresholds (lines 835-846) - can miners producing exactly average/2 or 4*average/5 blocks hit edge cases giving 0 shares unfairly? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_6dc823f8-4324-4f88-9f06-d93c2ece8b8d?mode=deep",
    "timestamp": "2026-02-19 00:45:54.721187",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [EndPeriod Setting] Line 796 sets EndPeriod = previousTermInformation.Last().TermNumber - if this is less than or equal to current scheme period, can beneficiaries never actually receive their shares? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_35ddfe0e-9781-4171-a19d-efc8cecb0cc6?mode=deep",
    "timestamp": "2026-02-19 00:46:26.453702",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [Multiple Terms in previousTermInformation] Line 777 accepts list of rounds - if list contains non-consecutive terms, can CalculateAverage at line 789 use wrong term's data? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_53b1cee1-5052-4a1a-89f9-f11286bcfdc6?mode=deep",
    "timestamp": "2026-02-19 00:46:57.761736",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: CalculateShares()] [Half Average Threshold] Line 837 returns 0 if producedBlocksCount < average/2 - can miners producing exactly average/2 blocks be unfairly excluded due to rounding? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_31f5a3fb-5905-4a07-bb9b-cb2c35c282ee?mode=deep",
    "timestamp": "2026-02-19 00:47:29.243819",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: CalculateShares()] [Quadratic Penalty] Line 843 returns producedBlocksCount^2 / average for miners between average/2 and 4*average/5 - can this quadratic calculation overflow for large block counts? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_b1522c93-6753-49d6-89d9-386f4c75960f?mode=deep",
    "timestamp": "2026-02-19 00:48:00.493910",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: CalculateShares()] [Four-Fifths Threshold Edge Case] Line 841 checks < 4*average/5 - miners producing exactly this amount get full shares (line 845), but 1 block less gets quadratic penalty - is this discontinuity exploitable? (Low)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_429e0f0f-05c8-4367-871d-c89fff506db0?mode=deep",
    "timestamp": "2026-02-19 00:48:28.530945",
    "report_generated": false
  }
]