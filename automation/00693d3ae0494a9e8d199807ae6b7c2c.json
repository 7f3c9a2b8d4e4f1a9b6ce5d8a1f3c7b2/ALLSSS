[
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: ConvertToNativeToken()] [Native Symbol Balance Assumption] DonateAll at line 682 assumes native token balance is from Sell output - but if treasury already held native tokens, can this donate more than was converted, depleting treasury? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_5e307a19-7c67-4c49-9803-1cdc6449bf23?mode=deep",
    "timestamp": "2026-02-19 00:40:59.957112",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: BuildTreasury()] [Default Weight Setting Application] Lines 691-695 apply default dividend pool weights if null - can an attacker front-run InitialMiningRewardProfitItem to make these calls before BuildTreasury, locking in default weights before controller can change them? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_dc4405de-bacb-4d24-bd0d-440d06e84376?mode=deep",
    "timestamp": "2026-02-19 00:41:22.034062",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: BuildTreasury()] [Double BuildTreasury Call] If BuildTreasury is called multiple times (from InitialMiningRewardProfitItem), will ResetSubSchemeToTreasury at line 693 create duplicate sub-scheme registrations causing double-distributions? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_cb18c21f-5a57-49e3-a882-5d2a85b64f17?mode=deep",
    "timestamp": "2026-02-19 00:41:44.774265",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: ReleaseTreasurySubProfitItems()] [Zero Amount Distribution] Lines 707-734 call DistributeProfits with AmountsMap all set to 0L - does ProfitContract interpret this as 'use current balance' or 'distribute nothing', potentially blocking reward releases? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_46ff99f3-e93c-4854-855d-251f22e52d72?mode=deep",
    "timestamp": "2026-02-19 00:42:07.764231",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: ReleaseTreasurySubProfitItems()] [Distribution Order] Calls distribute in order: RewardHash, VotesWeightRewardHash, ReElectionRewardHash, BasicRewardHash - can changing this order or if one call fails, cause beneficiaries in later schemes to lose their distribution? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_a2306b89-430b-4caf-bd16-209d82b4ec9c?mode=deep",
    "timestamp": "2026-02-19 00:42:31.768662",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: ReleaseTreasurySubProfitItems()] [Period Number Validation] Uses termNumber parameter without validation - can Release pass incorrect term numbers causing distributions to wrong periods or beneficiaries? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_5dbb6dd1-99ed-47fc-92aa-925cf5d76b30?mode=deep",
    "timestamp": "2026-02-19 00:42:57.715203",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [Beneficiary Removal] Lines 780-787 remove previous term beneficiaries - if RemoveBeneficiaries fails due to scheme state, will AddBeneficiaries at line 793 create duplicate shares for miners appearing in both terms? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_ed3a604c-fc4b-4690-9b96-7c8ee00bf158?mode=deep",
    "timestamp": "2026-02-19 00:43:23.612448",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [Address Conversion in GetAddressesFromCandidatePubkeys] Line 785 gets addresses from pubkeys - if a pubkey has custom profits receiver, does RemoveBeneficiaries remove wrong address, leaving stale beneficiaries? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_4e79f5a3-dd57-43d1-95bd-b6acf41d8f93?mode=deep",
    "timestamp": "2026-02-19 00:43:52.042846",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [Average Calculation Precision] Line 789 calls CalculateAverage which divides sum by count - can this lose precision for small miner counts, causing incorrect share calculations at line 811? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_88e49bde-3162-400e-af35-b5296a47bb5b?mode=deep",
    "timestamp": "2026-02-19 00:44:21.819217",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [Replaced Evil Miner Share Calculation] Lines 802-808 give replaced evil miners i.ProducedBlocks shares directly - can this be gamed if evil miner was replaced late in term after producing many blocks, giving replacement excessive shares? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_042731fc-de04-45a0-b3d5-548f2e14f003?mode=deep",
    "timestamp": "2026-02-19 00:44:51.301192",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [IsReplacedEvilMiner Flag Clearing] Line 807 removes flag after using it - if same miner is replaced multiple times in different terms, can the flag be stale from previous term? (Low)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_ffd42d6a-5ea8-4409-8683-55645bddefdc?mode=deep",
    "timestamp": "2026-02-19 00:45:22.255422",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [CalculateShares Logic] Line 811 calls CalculateShares with complex thresholds (lines 835-846) - can miners producing exactly average/2 or 4*average/5 blocks hit edge cases giving 0 shares unfairly? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_6dc823f8-4324-4f88-9f06-d93c2ece8b8d?mode=deep",
    "timestamp": "2026-02-19 00:45:54.721187",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [EndPeriod Setting] Line 796 sets EndPeriod = previousTermInformation.Last().TermNumber - if this is less than or equal to current scheme period, can beneficiaries never actually receive their shares? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_35ddfe0e-9781-4171-a19d-efc8cecb0cc6?mode=deep",
    "timestamp": "2026-02-19 00:46:26.453702",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [Multiple Terms in previousTermInformation] Line 777 accepts list of rounds - if list contains non-consecutive terms, can CalculateAverage at line 789 use wrong term's data? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_53b1cee1-5052-4a1a-89f9-f11286bcfdc6?mode=deep",
    "timestamp": "2026-02-19 00:46:57.761736",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: CalculateShares()] [Half Average Threshold] Line 837 returns 0 if producedBlocksCount < average/2 - can miners producing exactly average/2 blocks be unfairly excluded due to rounding? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_31f5a3fb-5905-4a07-bb9b-cb2c35c282ee?mode=deep",
    "timestamp": "2026-02-19 00:47:29.243819",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: CalculateShares()] [Quadratic Penalty] Line 843 returns producedBlocksCount^2 / average for miners between average/2 and 4*average/5 - can this quadratic calculation overflow for large block counts? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_b1522c93-6753-49d6-89d9-386f4c75960f?mode=deep",
    "timestamp": "2026-02-19 00:48:00.493910",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: CalculateShares()] [Four-Fifths Threshold Edge Case] Line 841 checks < 4*average/5 - miners producing exactly this amount get full shares (line 845), but 1 block less gets quadratic penalty - is this discontinuity exploitable? (Low)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_429e0f0f-05c8-4367-871d-c89fff506db0?mode=deep",
    "timestamp": "2026-02-19 00:48:28.530945",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: ConvertToNativeToken()] [Native Symbol Balance Assumption] DonateAll at line 682 assumes native token balance is from Sell output - but if treasury already held native tokens, can this donate more than was converted, depleting treasury? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_cf1b5ff9-4085-40de-b3f6-c824e3c68760?mode=deep",
    "timestamp": "2026-02-19 01:10:04.827886",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: BuildTreasury()] [Default Weight Setting Application] Lines 691-695 apply default dividend pool weights if null - can an attacker front-run InitialMiningRewardProfitItem to make these calls before BuildTreasury, locking in default weights before controller can change them? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_f675b903-abdb-40cf-adcc-0958170f282d?mode=deep",
    "timestamp": "2026-02-19 01:10:26.968357",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: BuildTreasury()] [Double BuildTreasury Call] If BuildTreasury is called multiple times (from InitialMiningRewardProfitItem), will ResetSubSchemeToTreasury at line 693 create duplicate sub-scheme registrations causing double-distributions? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_0c2413e6-6f04-495f-bca1-5ce37e56589b?mode=deep",
    "timestamp": "2026-02-19 01:10:49.326586",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: ReleaseTreasurySubProfitItems()] [Zero Amount Distribution] Lines 707-734 call DistributeProfits with AmountsMap all set to 0L - does ProfitContract interpret this as 'use current balance' or 'distribute nothing', potentially blocking reward releases? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_9fb64613-9a45-49ec-b724-0b134832d466?mode=deep",
    "timestamp": "2026-02-19 01:11:12.841117",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: ReleaseTreasurySubProfitItems()] [Distribution Order] Calls distribute in order: RewardHash, VotesWeightRewardHash, ReElectionRewardHash, BasicRewardHash - can changing this order or if one call fails, cause beneficiaries in later schemes to lose their distribution? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_ff03468e-3b8a-4cee-8a63-2f87d714e0fc?mode=deep",
    "timestamp": "2026-02-19 01:11:36.717604",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: ReleaseTreasurySubProfitItems()] [Period Number Validation] Uses termNumber parameter without validation - can Release pass incorrect term numbers causing distributions to wrong periods or beneficiaries? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_e35b2b76-3be3-4eb2-acfc-47e60bbf3a60?mode=deep",
    "timestamp": "2026-02-19 01:12:01.172078",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [Beneficiary Removal] Lines 780-787 remove previous term beneficiaries - if RemoveBeneficiaries fails due to scheme state, will AddBeneficiaries at line 793 create duplicate shares for miners appearing in both terms? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_dbc0737a-386e-4c68-9a24-6d3163586b1b?mode=deep",
    "timestamp": "2026-02-19 01:12:27.320387",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [Address Conversion in GetAddressesFromCandidatePubkeys] Line 785 gets addresses from pubkeys - if a pubkey has custom profits receiver, does RemoveBeneficiaries remove wrong address, leaving stale beneficiaries? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_cb01a001-bc63-4351-8a33-15706306f960?mode=deep",
    "timestamp": "2026-02-19 01:12:53.624387",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [Average Calculation Precision] Line 789 calls CalculateAverage which divides sum by count - can this lose precision for small miner counts, causing incorrect share calculations at line 811? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_614e5ba8-8559-469f-9aa8-90672d7a3ee3?mode=deep",
    "timestamp": "2026-02-19 01:13:21.342109",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [Replaced Evil Miner Share Calculation] Lines 802-808 give replaced evil miners i.ProducedBlocks shares directly - can this be gamed if evil miner was replaced late in term after producing many blocks, giving replacement excessive shares? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_bca430d1-8804-4818-878c-816375d3ffed?mode=deep",
    "timestamp": "2026-02-19 01:13:50.595885",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [IsReplacedEvilMiner Flag Clearing] Line 807 removes flag after using it - if same miner is replaced multiple times in different terms, can the flag be stale from previous term? (Low)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_2834b85f-d711-409d-8a06-c6b565885f9d?mode=deep",
    "timestamp": "2026-02-19 01:14:20.756106",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [CalculateShares Logic] Line 811 calls CalculateShares with complex thresholds (lines 835-846) - can miners producing exactly average/2 or 4*average/5 blocks hit edge cases giving 0 shares unfairly? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_07a7153b-4f8b-4dd1-bf4c-0e606a822b31?mode=deep",
    "timestamp": "2026-02-19 01:14:51.299189",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [EndPeriod Setting] Line 796 sets EndPeriod = previousTermInformation.Last().TermNumber - if this is less than or equal to current scheme period, can beneficiaries never actually receive their shares? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_4bdeb285-c36f-4e45-b235-23ad985c6c1c?mode=deep",
    "timestamp": "2026-02-19 01:15:23.018569",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [Multiple Terms in previousTermInformation] Line 777 accepts list of rounds - if list contains non-consecutive terms, can CalculateAverage at line 789 use wrong term's data? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_d58e05fb-76cc-4b1b-bb78-bcbb407d905c?mode=deep",
    "timestamp": "2026-02-19 01:15:54.241100",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: CalculateShares()] [Half Average Threshold] Line 837 returns 0 if producedBlocksCount < average/2 - can miners producing exactly average/2 blocks be unfairly excluded due to rounding? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_4441b579-38a9-44ab-8c52-aa3eed8001e5?mode=deep",
    "timestamp": "2026-02-19 01:16:26.228482",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: CalculateShares()] [Quadratic Penalty] Line 843 returns producedBlocksCount^2 / average for miners between average/2 and 4*average/5 - can this quadratic calculation overflow for large block counts? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_825e59a0-ea14-481f-8d66-51a5cd2d4bba?mode=deep",
    "timestamp": "2026-02-19 01:16:56.258190",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: CalculateShares()] [Four-Fifths Threshold Edge Case] Line 841 checks < 4*average/5 - miners producing exactly this amount get full shares (line 845), but 1 block less gets quadratic penalty - is this discontinuity exploitable? (Low)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_66f4e668-af15-495a-b9f3-8db4d3318cde?mode=deep",
    "timestamp": "2026-02-19 01:17:27.439989",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: CalculateShares()] [Division By Zero] Line 843 divides by averageProducedBlocksCount - if average is 0 (all miners produced 0 blocks), can this cause division by zero? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_e1e85220-fcc8-4f24-8037-2e863a93e075?mode=deep",
    "timestamp": "2026-02-19 01:17:56.083834",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateWelcomeRewardWeights()] [Previous Miner Beneficiary Removal] Lines 850-857 remove previous miners from VotesWeightRewardHash - if a previous miner is also a new miner, will they be removed then immediately re-added, causing share reset to 1 regardless of vote weight? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_e875283f-aaf7-48f4-8147-1aefad023b16?mode=deep",
    "timestamp": "2026-02-19 01:18:25.676301",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateWelcomeRewardWeights()] [BasicReward Sub-Scheme Removal] Lines 858-862 remove BasicRewardHash as sub-scheme - if this call fails but beneficiary removal succeeded, can VotesWeightReward end up with no beneficiaries and no sub-schemes, locking funds? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_5feaa4ce-346a-4485-94d2-08e00c64e70e?mode=deep",
    "timestamp": "2026-02-19 01:18:55.089526",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateWelcomeRewardWeights()] [New Miner Welcome Reward] Lines 864-880 give each new miner 1 share of welcome reward - can this be gamed if a miner intentionally sits out one term to re-qualify as 'new' and claim welcome rewards repeatedly? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_bbce31d4-c76c-4c44-ab72-f52de93cf4f1?mode=deep",
    "timestamp": "2026-02-19 01:19:25.039511",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateWelcomeRewardWeights()] [Empty New Miners Fallback] Lines 881-890 redirect welcome reward to BasicReward if no new miners - but what if BasicReward also has no beneficiaries (all miners excluded by CalculateShares) - do funds get locked? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_0b6e1d3c-9c75-421c-83c1-b0dcc2051090?mode=deep",
    "timestamp": "2026-02-19 01:19:55.886922",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateWelcomeRewardWeights()] [EndPeriod for Welcome Reward] Line 870 sets EndPeriod = termNumber + 1 - can new miners claim welcome rewards for multiple terms if they remain miners, or only for the next term? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_38d986e4-5464-4914-b1c1-a4bd75547749?mode=deep",
    "timestamp": "2026-02-19 01:20:26.823053",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateWelcomeRewardWeights()] [Profits Receiver Lookup] Line 872 uses GetProfitsReceiver for new miners - if they haven't set a custom receiver, does this default to their pubkey address correctly? (Low)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_5d9e89ec-f2e7-487d-98a2-679dc7101c90?mode=deep",
    "timestamp": "2026-02-19 01:20:57.800443",
    "report_generated": false
  }
]