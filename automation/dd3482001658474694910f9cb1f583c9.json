[
  {
    "question": "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Cross-Function: LockToken() + UnlockToken()] [Lock/Unlock Mismatch] LockToken uses Context.Sender on line 56 but accepts lockedAddress parameter. UnlockToken uses lockedAddress on line 77 but Context.Sender on line 87. Can this mismatch allow token theft? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_389045eb-776e-4383-b908-1aeb03e3fc2c?mode=deep",
    "timestamp": "2026-02-19 13:10:00.947344",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Cross-Function: LockToken() + IsReleaseThresholdReached()] [Vote Count Manipulation] If LockToken allows locking 0 tokens (no validation on line 53), can attackers inflate vote counts without actually staking tokens? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_036badb3-5e1f-493d-a1d5-919011476b70?mode=deep",
    "timestamp": "2026-02-19 13:10:22.894487",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Cross-Function: CreateNewProposal() + AssertIsAuthorizedProposer()] [Authorization Bypass] CreateNewProposal doesn't call AssertIsAuthorizedProposer. Can anyone create proposals regardless of whitelist? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_9ab5e5b4-8b70-4144-b52a-4b8294768533?mode=deep",
    "timestamp": "2026-02-19 13:10:45.174925",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Cross-Function: Validate(Organization) + CreateNewProposal()] [Threshold Bypass] If organization validation allows MinimalVoteThreshold = 0 on line 98, can proposals be created that pass with zero votes? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_cc0bcaae-d90c-4321-8262-1519747f70b5?mode=deep",
    "timestamp": "2026-02-19 13:11:08.003320",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Cross-Function: GetAllowance() + LockToken()] [TOCTOU] GetAllowance checks allowance > 0 on line 150, but can allowance be reduced before LockToken executes the TransferFrom on lines 47-55? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_73a9f388-958f-46e0-aa87-686967aaa382?mode=deep",
    "timestamp": "2026-02-19 13:11:31.981750",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Cross-Function: GenerateProposalId() + CreateNewProposal()] [ID Prediction] If GenerateProposalId allows custom input.Token on line 156, can attackers predict and front-run proposal creation to block legitimate proposals? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_5d6449b4-1a09-4234-a96f-99ddcbffbbc2?mode=deep",
    "timestamp": "2026-02-19 13:11:57.562855",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Cross-Function: Validate(ProposalInfo) + GetValidProposal()] [Expired Proposal Execution] Validate checks expiration on line 108, but between validation and execution, can a proposal expire and still be executed? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_645c5240-7694-4bb5-9d11-d04ce2c82556?mode=deep",
    "timestamp": "2026-02-19 13:12:22.683996",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Cross-Function: LockToken() + GetProposalVirtualAddress()] [Virtual Address Drain] If GetProposalVirtualAddress is predictable, can an attacker pre-drain the virtual address before legitimate users lock tokens? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_8cbf6d14-d806-4d2d-8026-4d2e42119200?mode=deep",
    "timestamp": "2026-02-19 13:12:48.483168",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Cross-Function: UnlockToken() + IsReleaseThresholdReached()] [Premature Unlock] UnlockToken doesn't check if voting has ended. Can voters unlock before threshold checks, invalidating vote counts? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_728bbe51-0b5d-49f7-9161-f285bd58ebc5?mode=deep",
    "timestamp": "2026-02-19 13:13:14.325194",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Cross-Function: CalculateOrganizationHashAddressPair() + Validate(Organization)] [Organization Creation Bypass] If hash calculation on line 210 is predictable, can attackers create organizations with predetermined addresses to bypass validation? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_b17959f7-31f9-4412-9364-e314f5daf880?mode=deep",
    "timestamp": "2026-02-19 13:13:39.187376",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: IsReleaseThresholdReached()] [Integer Overflow] The Add operation on line 15 for vote counts doesn't use SafeMath. Can vote counts overflow to bypass threshold checks? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_5b0d8a53-97f3-4ae2-8544-eff211d9afa6?mode=deep",
    "timestamp": "2026-02-19 13:14:04.311173",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: LockToken()] [Amount Overflow] No validation that amount parameter won't overflow when added to existing locks. Can this cause accounting errors? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_1a299c79-3acd-4aac-a52f-e2f90a4e6084?mode=deep",
    "timestamp": "2026-02-19 13:14:31.992579",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: IsReleaseThresholdReached()] [Comparison Edge Case] Line 20 uses '>' for rejection threshold. Should it be '>=' to properly enforce the maximum? (Low)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_26911087-77cb-4e2e-9d27-65b790bc6133?mode=deep",
    "timestamp": "2026-02-19 13:14:58.898194",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: IsReleaseThresholdReached()] [Comparison Edge Case] Line 24 uses '>' for abstention threshold. Should it be '>=' to properly enforce the maximum? (Low)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_83598904-c46f-458d-98ca-6e36f7a288f6?mode=deep",
    "timestamp": "2026-02-19 13:15:28.378476",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: Validate(Organization)] [Threshold Relationship] Line 98 allows MinimalApprovalThreshold = MinimalVoteThreshold. Can this create impossible-to-pass scenarios? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_2d8c740b-9421-49e4-9199-1f0a3395cb90?mode=deep",
    "timestamp": "2026-02-19 13:15:58.113765",
    "report_generated": false
  }
]