[
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: Withdraw()] [Timestamp Edge Case] Line 227 uses strict less-than (<). If lock timestamp + minutes EQUALS current time, withdrawal fails. Is this one-block delay exploitable? (Low)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_744986f3-8f97-4672-883c-2b896dea2de1?mode=deep",
    "timestamp": "2026-02-19 01:05:54.031938",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: Withdraw()] [LockId Validation] Line 219 asserts lockId != null, but doesn't validate lockId matches expected hash. Can lockId be manipulated in state to unlock wrong user's tokens? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_d9cafb0d-8ff2-40d6-9fdc-3a51f71198c1?mode=deep",
    "timestamp": "2026-02-19 01:06:15.946347",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: ClaimProfits()] [Authorization Bypass] Line 250 allows input.Beneficiary to be null, defaulting to Context.Sender. Can scheme manager claim profits on behalf of ANY beneficiary by specifying their address? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_4f606c40-ad4e-482f-8453-00926c1cf990?mode=deep",
    "timestamp": "2026-02-19 01:06:38.213258",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: ClaimProfits()] [Front-Running] Can scheme manager front-run user ClaimProfits by first calling DistributeProfits to change period, causing user's claim to fail or claim wrong period? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_2586ae71-549e-4b25-9990-802c49f78b52?mode=deep",
    "timestamp": "2026-02-19 01:07:01.504421",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: ClaimProfits()] [Input Validation] No validation that beneficiary is actually registered in the scheme. Can claiming for non-existent beneficiary cause errors or state corruption? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_3a407e9d-aa0b-4225-a277-6eb39bf036f7?mode=deep",
    "timestamp": "2026-02-19 01:07:25.318143",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: ClaimProfits()] [Reentrancy] Line 251 delegates to ProfitContract.ClaimProfits. Can malicious ProfitContract re-enter TokenHolderContract during claim to manipulate state? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_b5548e59-0bef-4124-8a73-d40690f4eb0d?mode=deep",
    "timestamp": "2026-02-19 01:07:50.958745",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: ClaimProfits()] [DOS Attack] Can attacker repeatedly claim zero profits to consume gas and DOS the claiming mechanism? Should there be rate limiting or minimum claim amounts? (Low)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_89f55d19-1f0d-4e23-befd-596075e94735?mode=deep",
    "timestamp": "2026-02-19 01:08:16.260579",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: ClaimProfits()] [State Desync] If ProfitContract.ClaimProfits succeeds but TokenHolderContract state is inconsistent (wrong period, wrong SchemeId), can user claim profits they shouldn't be entitled to? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_e0581a9e-36b0-4c9e-8e9c-254bc14652b7?mode=deep",
    "timestamp": "2026-02-19 01:08:44.265635",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: ClaimProfits()] [Scheme Validation] Line 249 calls GetValidScheme which may update scheme state. Can claiming trigger unwanted state updates that affect other users? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_8d9d346d-2b94-4c64-a5ee-abc0b10ddb14?mode=deep",
    "timestamp": "2026-02-19 01:09:10.547622",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: GetValidScheme()] [Null Pointer] Line 281 asserts scheme != null, but if scheme doesn't exist, can calling functions that depend on GetValidScheme be permanently DOSed? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_e6451155-ed78-4421-af4d-d4aa322eeae0?mode=deep",
    "timestamp": "2026-02-19 01:09:37.524217",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: GetValidScheme()] [State Mutation] GetValidScheme calls UpdateTokenHolderProfitScheme which modifies state. Should a getter function modify state? Can this cause unexpected side effects? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_e1890fc9-5394-482f-91bd-3ddee9ef6466?mode=deep",
    "timestamp": "2026-02-19 01:10:10.413346",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: GetValidScheme()] [Parameter Inconsistency] updateSchemePeriod parameter at line 278 is only used in one code path. Can inconsistent usage lead to bugs where period is updated when it shouldn't be? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_ad0323c8-4091-4f85-a8ec-8739e8a017dc?mode=deep",
    "timestamp": "2026-02-19 01:10:41.331211",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: UpdateTokenHolderProfitScheme()] [State Corruption] Line 289 returns early if SchemeId is set and not updating period. Can this cause scheme data to become stale (wrong Period, Symbol, thresholds)? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_f081ec19-04b2-4e88-8ec7-c5507f17fc45?mode=deep",
    "timestamp": "2026-02-19 01:11:09.333554",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: UpdateTokenHolderProfitScheme()] [Wrong Manager] Line 298 saves scheme to State.TokenHolderProfitSchemes[Context.Sender], but function parameter is 'manager'. Can this cause schemes to be saved under wrong keys? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_282df292-ed11-49d3-b815-92a3784cadeb?mode=deep",
    "timestamp": "2026-02-19 01:11:41.987924",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: UpdateTokenHolderProfitScheme()] [FirstOrDefault Risk] Line 293's FirstOrDefault returns null if no schemes exist. Line 294 asserts not null, but is timing gap exploitable between CreateScheme and first update? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_d30d029d-4194-427e-ae43-a1b880b26f47?mode=deep",
    "timestamp": "2026-02-19 01:12:12.639241",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: UpdateTokenHolderProfitScheme()] [Period Desync] Line 297 sets scheme.Period from originScheme.CurrentPeriod. If ProfitContract's period is manipulated or incremented separately, can TokenHolder and Profit contracts have different periods? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_78097ca2-42e3-4f2d-a69b-4c5421f3f2d5?mode=deep",
    "timestamp": "2026-02-19 01:12:44.733545",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: UpdateTokenHolderProfitScheme()] [Cross-Contract Call] Lines 290-293 call GetManagingSchemeIds. Can malicious ProfitContract return wrong SchemeIds, causing UpdateTokenHolderProfitScheme to link to attacker's scheme? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_c509b09b-b614-4714-90ec-d3ae6822c359?mode=deep",
    "timestamp": "2026-02-19 01:13:18.182793",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Cross-Function] [State Race] Can CreateScheme and AddBeneficiary be called concurrently before SchemeId is initialized, causing AddBeneficiary to fail or use wrong scheme? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_7b54d6ae-138c-4347-b793-b6bbbc55915e?mode=deep",
    "timestamp": "2026-02-19 01:13:46.960141",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Cross-Function] [Authorization Chain] GetValidScheme is called by multiple functions but doesn't verify caller authorization. Can unauthorized callers exploit functions that use GetValidScheme? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_86a1db9e-8506-472b-9930-dafb2d2215f8?mode=deep",
    "timestamp": "2026-02-19 01:14:21.375021",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Cross-Function] [Lock-Unlock Race] Between RegisterForProfits locking tokens and Withdraw unlocking, can RemoveBeneficiary be called to remove user as beneficiary while tokens remain locked? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_18a63185-59d7-4aa0-b337-384b5ad5e4f9?mode=deep",
    "timestamp": "2026-02-19 01:14:53.266602",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Cross-Function] [Period Increment] Both DistributeProfits (line 144) and RegisterForProfits (line 204) increment scheme.Period. Can race conditions cause period to skip numbers or increment incorrectly? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_c98d3788-a635-408f-8c0e-b5932ded2b2d?mode=deep",
    "timestamp": "2026-02-19 01:15:25.334275",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Cross-Function] [Beneficiary Management] AddBeneficiary and RemoveBeneficiary don't coordinate with RegisterForProfits. Can scheme manager remove users who registered via RegisterForProfits, leaving their tokens locked? (Critical)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_1c9f13a3-8a89-48db-be7f-861c5b9f73c1?mode=deep",
    "timestamp": "2026-02-19 01:15:59.322426",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Cross-Function] [Profit Contribution Race] If ContributeProfits and RegisterForProfits auto-distribution happen concurrently, can profits be distributed twice or lost entirely? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_f547b69a-07f5-4fdd-827b-95ccf1a4e261?mode=deep",
    "timestamp": "2026-02-19 01:16:31.625894",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Cross-Function] [Scheme Modification] Can scheme manager modify scheme parameters (Symbol, MinimumLockMinutes, AutoDistributeThreshold) after users register, breaking their expectations? (High)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_1bbb13dc-2320-4544-9db3-c35c0ea0e079?mode=deep",
    "timestamp": "2026-02-19 01:17:05.510706",
    "report_generated": false
  },
  {
    "question": "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Cross-Function] [Claim-Withdraw Race] Can user call ClaimProfits and Withdraw concurrently, claiming profits after beneficiary status is removed? (Medium)",
    "url": "https://deepwiki.com/search/-aelf-smart-contract-security_3d7b39bb-9519-40c3-b4bf-09ba6be10128?mode=deep",
    "timestamp": "2026-02-19 01:17:38.961663",
    "report_generated": false
  }
]