[
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: SetSymbolList()] [State Inconsistency] Symbol list is replaced entirely - if symbols are removed that have existing balances in TreasuryVirtualAddress, will those funds become permanently locked? (High)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: RecordMinerReplacement()] [Authorization] Only Consensus contract can call this, but if State.AEDPoSContract.Value is uninitialized or manipulated, can attacker record fake replacements to steal rewards? (Critical)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: RecordMinerReplacement()] [State Transfer Bug] When !IsOldPubkeyEvil, LatestMinedTerm is transferred from old to new pubkey - but if old pubkey is removed before new pubkey is set, can race condition cause LatestMinedTerm to be lost? (Medium)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: RecordMinerReplacement()] [Duplicate Entry] If IsOldPubkeyEvil, new pubkey is added to ReplaceCandidateMap - but is there validation to prevent same pubkey being added multiple times, potentially multiplying their welcome rewards? (High)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: RecordMinerReplacement()] [Logic Error] State.IsReplacedEvilMiner[newPubkey] is always set to true - but shouldn't this only be set when IsOldPubkeyEvil is true? Can non-evil replacements get incorrect reward shares? (Medium)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: RecordMinerReplacement()] [Timing Issue] ReplaceCandidateMap is keyed by CurrentTermNumber and removed during Release - if replacement happens but Release is delayed, can the entry be lost, denying new miner their welcome reward? (Medium)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: SetProfitsReceiver()] [Authorization Bypass] GetCandidateAdmin must equal Context.Sender - but if Election contract has bug allowing admin spoofing, can attacker set arbitrary profit receivers for any candidate? (High)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: SetProfitsReceiver()] [Validation Gap] Checks that pubkey is in candidate list, but doesn't verify it's an active miner - can retired candidates still set receivers and potentially claim future rewards if they rejoin? (Low)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: SetProfitsReceiver()] [Reentrancy Risk] Calls Election contract's SetProfitsReceiver which might callback - can attacker exploit reentrancy to set receiver multiple times or interfere with State.ProfitsReceiverMap update? (Medium)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: SetProfitsReceiver()] [Logic Error] If input.ProfitsReceiverAddress == previousProfitsReceiver, function returns early WITHOUT calling Election contract - can this cause state desynchronization between Treasury and Election contracts? (Medium)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: SetProfitsReceiver()] [Null Handling] If previousProfitsReceiver is null, new Address() is passed - does Election contract handle empty address correctly, or could this break beneficiary tracking? (Low)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: ReplaceCandidateProfitsReceiver()] [Authorization] Only Election contract can call, but no validation that old/new pubkeys are valid - can malicious Election contract call corrupt ProfitsReceiverMap with arbitrary entries? (Medium)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: ReplaceCandidateProfitsReceiver()] [State Leak] Old pubkey is removed from map but new pubkey gets old receiver - if old receiver was malicious, does new candidate unknowingly inherit security risk? (Low)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: GetProfitsReceiver()] [Default Behavior] Falls back to Address.FromPublicKey if no receiver set - if this address doesn't exist or is a contract, can rewards be permanently locked? (Medium)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: GetMinerRewardWeightProportion()] [Division By Zero] weightSum is calculated by adding three weights - if all weights are 0 (should be prevented, but if state corrupted), will Div(weightSum) cause contract crash? (Medium)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: GetMinerRewardWeightProportion()] [Rounding Error] Proportion is calculated as weight * 10000 / weightSum - can repeated operations with small weights cause proportions that don't sum to exactly 10000, breaking distribution invariants? (Low)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: GetMinerRewardWeightProportion()] [Integer Overflow] Weight multiplied by TreasuryContractConstants.OneHundredPercent before division - if weight is MAX_INT, can this overflow before Div, returning wrong proportion? (Low)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: GetMinerRewardWeightProportion()] [Calculation Order] FlexibleReward proportion is calculated as remainder (10000 - basic - welcome) - if basic + welcome > 10000 due to rounding, will FlexibleReward be negative or underflow? (Medium)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: GetDividendPoolWeightProportion()] [Same Issues as GetMinerRewardWeightProportion] Division by zero, rounding errors, integer overflow, and remainder calculation risks? (Medium)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: GetWelfareRewardAmountSample()] [Division By Zero] If totalShares is 0, function returns empty output - but is this correct behavior, or should it return some default values? Will callers handle empty output correctly? (Low)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: GetWelfareRewardAmountSample()] [Integer Overflow] Uses decimal type to avoid overflow, but then casts back to long - can the cast cause overflow if amount is extremely large, returning incorrect sample? (Medium)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: GetWelfareRewardAmountSample()] [Precision Loss] Decimal division then cast to long truncates decimals - can this cause sample amounts to be significantly lower than actual, misleading users? (Low)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: GetWelfareRewardAmountSample()] [Wrong Period] Uses CurrentPeriod.Sub(1) to get released info - if current period is 0 or 1, will Sub(1) underflow or return period with no data, breaking calculation? (Medium)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: GetWelfareRewardAmountSample()] [Missing Validation] No check that input.Value contains valid lock times - can negative or zero lock times cause GetVotesWeight to return invalid weights? (Low)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [Array Index OOB] Uses previousTermInformation.First() and .Last() - if collection is empty or has single element, can this cause crashes or use wrong data? (Medium)"
]