[
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [Re-Registration DOS] Line 151 asserts LockIds[input.SchemeManager][Context.Sender] is null, preventing re-registration. Can users who want to increase stake be permanently locked out unless they withdraw first? (Medium)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [LockId Collision] Lines 157-158 generate lockId from SchemeManager and Sender. Can different schemes managed by same address create lockId collisions, causing lock/unlock conflicts? (High)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [Lock Failure Handling] Line 159-165 calls TokenContract.Lock. If Lock fails (insufficient balance), is LockIds still set at line 166? Would this create ghost registrations? (High)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [Timestamp Manipulation] Line 167 sets LockTimestamp to Context.CurrentBlockTime. Can miners manipulate block timestamps to allow users to withdraw earlier than MinimumLockMinutes? (High)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [Shares Mismatch] Line 174 adds beneficiary with shares=input.Amount. But if token uses decimals, can shares calculation be wrong, causing profit distribution errors? (Medium)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [Input Validation] Does RegisterForProfits validate input.Amount is positive and user has sufficient balance? Can registering with zero amount cause division-by-zero in profit calculations? (High)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [Auto-Distribution Logic] Lines 179-206 implement auto-distribution. The loop at line 184 checks each threshold but breaks at line 199 after finding ONE symbol above threshold. Is it intended to only check if ANY threshold is met, not ALL? (Medium)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [Accounting Error] Line 198 sets distributedInput.AmountsMap[threshold.Key] = 0. Why distribute zero amounts? Is this correct behavior or a bug that should use actual balance? (High)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [Race Condition] Auto-distribution at lines 179-206 checks balance, then distributes. Can multiple RegisterForProfits calls race to trigger distribution, causing double-distribution or missed distributions? (High)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [Period Desync] Line 204 increments scheme.Period during auto-distribution. If ProfitContract.DistributeProfits fails, period is still incremented at line 205, causing permanent desync. Is this handled? (Critical)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [DOS via Auto-Distribution] Can attacker register tiny amounts repeatedly to trigger auto-distribution on every registration, causing excessive gas consumption and DOSing the scheme? (High)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [Reentrancy] Between Lock at line 159, setting LockIds at line 166, LockTimestamp at line 167, and AddBeneficiary at line 168, can malicious contract re-enter and register multiple times? (High)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [Symbol Validation] No check that user is locking correct scheme.Symbol from line 162. Can locking wrong symbol cause registration to succeed but withdrawal to fail? (High)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [Virtual Address] Line 182 retrieves originScheme.VirtualAddress. If ProfitContract returns null or invalid address, can GetBalance at line 186 fail, causing registration to always fail? (Medium)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [Threshold Comparison] Line 191 checks balance < threshold.Value using less-than. Should it be less-than-or-equal? Can exact threshold amounts be exploited to avoid distribution? (Low)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: Withdraw()] [Authorization Bypass] Function uses 'Address input' as scheme manager but Context.Sender as withdrawer. Can malicious scheme manager front-run withdrawals by changing MinimumLockMinutes in scheme? (High)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: Withdraw()] [Timestamp Manipulation] Line 227 checks LockTimestamp + MinimumLockMinutes < CurrentBlockTime. Can block timestamp manipulation allow premature withdrawals, violating lock period invariant? (Critical)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: Withdraw()] [Integer Overflow] Line 227's AddMinutes could overflow if MinimumLockMinutes is Int64.MaxValue, causing comparison to always fail or always succeed. Is overflow check present? (High)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: Withdraw()] [State Inconsistency] Line 238 removes LockIds before RemoveBeneficiary at line 239. If RemoveBeneficiary fails, user loses lockId reference but is still a beneficiary. Can this cause fund locking? (Critical)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: Withdraw()] [Unlock Failure] Line 230-236 calls TokenContract.Unlock. If Unlock fails (wrong symbol, wrong amount), is user permanently unable to withdraw? Is there error recovery? (High)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: Withdraw()] [Amount Calculation] Line 220-225 fetches locked amount from TokenContract. Can amount be zero or negative? If so, unlock succeeds but user gains nothing - is this exploitable? (Medium)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: Withdraw()] [Beneficiary Removal] Line 239-243 removes beneficiary after unlock. If user has unclaimed profits, do they lose them permanently? Should profits be auto-claimed before removal? (High)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: Withdraw()] [Reentrancy] Between Unlock at line 230 and RemoveBeneficiary at line 239, can malicious TokenContract or ProfitContract re-enter to claim profits multiple times? (High)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: Withdraw()] [DOS Attack] Can scheme manager change MinimumLockMinutes to Int64.MaxValue after users register, effectively permanently locking their funds? (Critical)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: Withdraw()] [Symbol Mismatch] Line 235 uses scheme.Symbol for unlock. If scheme.Symbol was changed after registration, can unlock fail leaving funds permanently locked? (High)"
]