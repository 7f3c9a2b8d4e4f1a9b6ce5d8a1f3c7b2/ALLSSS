[
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [Beneficiary Removal DOS] RemoveBeneficiaries is called with all miner addresses - if list is very large, can this exceed gas limits and prevent reward updates? (High)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [Shares Calculation Error] CalculateShares can return 0 if producedBlocks < average/2 - if many miners return 0, will AddBeneficiaries add them with 0 shares, wasting gas and storage? (Low)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [Evil Miner Advantage] If IsReplacedEvilMiner is true, shares = producedBlocks directly without CalculateShares penalty - can evil miner replacement be gamed to get higher shares than deserved? (Medium)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [State Cleanup Failure] State.IsReplacedEvilMiner.Remove is called inside the loop - if Remove fails silently, will the flag persist and give unfair advantage in future periods? (Low)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [Wrong EndPeriod] EndPeriod is set to previousTermInformation.Last().TermNumber - shouldn't it be +1 for the NEXT term since we're setting weights for future distribution? (High)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: CalculateAverage()] [Division Precision] Sum divided by count using integer division - for small lists or odd sums, can this cause average to be significantly wrong, affecting fairness of CalculateShares? (Low)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: CalculateShares()] [Threshold Gaming] Returns 0 if blocks < average/2, and different formula if blocks < 4*average/5 - can miners game their block production to just meet thresholds and maximize shares/effort ratio? (Medium)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: CalculateShares()] [Non-Linear Scaling] Formula is producedBlocks^2 / average for middle tier - this quadratic scaling can cause enormous share differences for small production differences, is this intended? (Low)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateWelcomeRewardWeights()] [Complete Removal] All previous miner addresses removed from scheme - if RemoveBeneficiaries fails partially, can some addresses remain and get double rewards (old + new term)? (Medium)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateWelcomeRewardWeights()] [Sub-Scheme Removal] RemoveSubScheme is called for BasicRewardHash - if this fails but RemoveBeneficiaries succeeds, will BasicReward become orphaned and unable to receive any rewards? (High)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateWelcomeRewardWeights()] [Logic Branch Risk] If no new miners, reward goes to BasicReward via sub-scheme - but if newElectedMiners is empty, EndPeriod isn't set consistently with the else branch AddSubScheme call? (Low)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateWelcomeRewardWeights()] [Beneficiary Share Validation] All new miners get 1 share regardless of their contribution or stake - can this be exploited by colluding to force miner turnover and split welcome rewards? (Medium)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateWelcomeRewardWeights()] [Duplicate Addition] No check if miner is already a beneficiary - if AddBeneficiaries is called twice for same miner, do they get double shares? (Low)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateFlexibleRewardWeights()] [Double Removal] Both WelfareHash and BasicRewardHash are removed as sub-schemes - if either was never added, will RemoveSubScheme fail and block the entire function? (Medium)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateFlexibleRewardWeights()] [TotalShares Check] If TotalShares > 0, beneficiaries are removed - but shouldn't this always be done regardless, to clean up previous period? Can old beneficiaries linger? (Low)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateFlexibleRewardWeights()] [State Flag Dependency] Uses State.HasNewMiner to determine routing - if this flag is set incorrectly (race condition in Release), can rewards be misrouted permanently? (High)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateFlexibleRewardWeights()] [Missing EndPeriod] AddSubScheme calls don't specify EndPeriod - will the sub-scheme remain connected indefinitely, potentially receiving rewards for wrong periods? (Medium)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: ChangeTreasuryController()] [Authorization Check Timing] AssertPerformedByTreasuryController is called first - if current controller is compromised, they can set arbitrary new controller with no recovery mechanism? (Critical)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: ChangeTreasuryController()] [Organization Validation] CheckOrganizationExist is called, but what if organization exists but is malicious/compromised - can controller be changed to attacker address permanently? (High)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: ChangeTreasuryController()] [No Emergency Recovery] Once controller is changed, there's no fallback or time-lock - if new controller address is wrong or compromised, treasury becomes permanently unmanageable? (Critical)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: AssertPerformedByTreasuryController()] [Default Fallback] If State.TreasuryController.Value is null, falls back to GetDefaultTreasuryController - can this be exploited before explicit controller is set? (High)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: GetDefaultTreasuryController()] [Parliament Dependency] Returns Parliament's default organization address - if Parliament contract is compromised or not initialized, can this return attacker-controlled address? (Critical)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateMiningReward()] [Authorization] Only consensus contract can call - but if consensus contract is compromised, can attacker set arbitrary mining reward amount, inflating or deflating rewards permanently? (High)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateMiningReward()] [No Validation] No bounds checking on input.Value - can negative values cause accounting errors, or extremely large values cause overflow in GetDividends calculation? (High)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateMiningReward()] [State Overwrite] Simply overwrites State.MiningReward.Value - if called multiple times per block, does last call win, potentially losing previous mining rewards? (Medium)"
]