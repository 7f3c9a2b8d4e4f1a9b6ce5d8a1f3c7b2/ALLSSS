[
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: DistributeProfits()] [Logic Error] Line 133 calls GetValidScheme with updateSchemePeriod=true, but Period is updated again at line 144 - is there potential for double increment? (High)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: DistributeProfits()] [Authorization Gap] Why is TokenContract allowed to call DistributeProfits? Could this be exploited to distribute profits at unintended times? (High)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: DistributeProfits()] [State Race] Between GetValidScheme and state update at line 145, could another transaction modify the scheme causing inconsistency? (Medium)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [Double Registration Check] Line 151 checks State.LockIds but if it's non-null but invalid, could a user lose access to their first registration while attempting to register again? (High)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [Input Validation] Is input.Amount validated to be positive before locking tokens, or can zero/negative amounts be registered? (Medium)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [Lock ID Collision] Lines 157-158 generate lockId from SchemeManager and Sender - could hash collisions allow one user to unlock another's tokens? (Critical)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [State Inconsistency] If Lock call (line 159) fails after LockIds is set (line 166), is state left inconsistent with a lockId that doesn't exist in token contract? (High)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [Timestamp Manipulation] Line 167 stores Context.CurrentBlockTime - can miners manipulate block time to affect withdrawal eligibility? (Medium)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [Share Mismatch] Line 174 adds shares equal to input.Amount - if token has decimals, could this cause share calculation errors? (Medium)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [Auto-Distribute Logic Error] Lines 184-199 iterate AutoDistributeThreshold and break on first threshold met - could this miss distributions for other tokens? (Medium)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [DOS via Auto-Distribute] If AutoDistributeThreshold contains many entries, could iterating and calling GetBalance for each cause gas exhaustion? (High)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [Auto-Distribute Trigger] Line 198 sets AmountsMap[threshold.Key] = 0 - does distributing 0 amount make sense, or should it distribute the actual balance? (High)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [Period Desync] Lines 203-205 increment scheme.Period during registration - could this cause period desync if distribution hasn't occurred yet? (High)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [Reentrancy] Could malicious token contract's Lock callback reenter RegisterForProfits before LockIds is set, bypassing the double registration check? (Critical)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [Logic Error] Line 191 checks 'if (balance < threshold.Value) continue' - should registration fail if balance is insufficient instead of silently skipping? (Low)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [State Race] Between checking balance and calling DistributeProfits, could balance change causing distribution to fail or behave unexpectedly? (Medium)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: RegisterForProfits()] [Memory Leak] If distributedInput is created (line 193) but distribution is never called, does this waste gas without cleanup? (Low)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: Withdraw()] [Time Validation Error] Line 227 uses '<' instead of '<=' - can users withdraw one block early if CurrentBlockTime equals LockTimestamp + MinimumLockMinutes? (Medium)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: Withdraw()] [Input Parameter] Function takes Address input (scheme manager) but doesn't validate it - can users withdraw from non-existent schemes causing errors? (Medium)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: Withdraw()] [State Consistency] Lines 238 and 239-242 remove from LockIds and ProfitContract - if RemoveBeneficiary fails, are tokens unlocked but shares remain? (High)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: Withdraw()] [Profit Loss] RemoveBeneficiary is called immediately - do users lose unclaimed profits if they withdraw without claiming first? (High)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: Withdraw()] [Unlock Failure] If Unlock call fails (line 230), but LockIds is already removed (line 238), can user never recover their locked tokens? (Critical)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: Withdraw()] [Race Condition] Between getting locked amount (line 220) and unlocking (line 230), could the amount change due to another transaction? (Medium)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: Withdraw()] [Timestamp Overflow] AddMinutes on line 227 - if MinimumLockMinutes is extremely large, could this overflow the timestamp causing immediate withdrawal eligibility? (High)",
  "[File: contract/AElf.Contracts.TokenHolder/TokenHolderContract.cs] [Function: Withdraw()] [Authorization] Should there be a check to ensure only the user who registered can withdraw, or is Context.Sender check sufficient? (Low)"
]