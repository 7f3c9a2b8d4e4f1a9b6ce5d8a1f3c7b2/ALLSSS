[
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GetAllProfitsMap() private] [AddProfitToDict Safety] At line 131, AddProfitToDict is called. If totalProfitsDictForEachProfitDetail contains negative values due to overflow bugs, can this corrupt allProfitsDict? (High)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GetAllProfitsMap() private] [Index Check] At line 132, 'if(i >= profitableDetailCount) continue' skips claimable calculation for details beyond the first 10. Is this intentional limitation documented, or a potential bug? (Medium)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GetAllProfitsMap() private] [Claimable vs Total Divergence] Lines 133-134 calculate claimableProfits with maxProfitReceivingPeriodCount limit, but line 130 calculates total with full EndPeriod range. Can this large divergence confuse users or enable claim-display mismatches? (High)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GetAllProfitsMap() private] [Dictionary Return] At lines 137-141, raw dictionaries are returned in protobuf message. Can these be manipulated by caller if protobuf serialization has vulnerabilities? (Low)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: AddProfitToDict()] [Integer Overflow] At line 148, profitsDict[kv.Key].Add(kv.Value) could overflow if accumulated profits exceed long.MaxValue. Is this checked anywhere? (High)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: AddProfitToDict()] [Null Dictionary] If profitsDict is null (shouldn't happen but defensive), will this throw NullReferenceException? Should there be null checks? (Low)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: AddProfitToDict()] [Negative Values] If profitsToAdd contains negative values (from overflow bugs elsewhere), line 148's Add could result in smaller-than-expected profits. Should negatives be validated? (Medium)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: AddProfitToDict()] [Symbol Injection] If profitsToAdd contains a symbol key not in profitsDict, line 150 adds it. Can an attacker inject arbitrary symbol keys to pollute the profits map? (Medium)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GetMaximumProfitReceivingPeriodCount()] [Uninitialized State] If State.MaximumProfitReceivingPeriodCount.Value is 0 (uninitialized), does this default to constant or can it cause issues in period calculations? (Low)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GetMaximumProfitReceivingPeriodCount()] [Governance Risk] Since this value can be set via SetMaximumProfitReceivingPeriodCount (in main contract), can governance set it to 1, effectively limiting all users to claim only 1 period at a time, causing DoS? (High)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Multiple Functions] [State Consistency] If State.SchemeInfos, State.DistributedProfitsMap, and State.ProfitDetailsMap become inconsistent (scheme exists but details don't, or vice versa), can any view method return data that causes calling contracts to make incorrect decisions? (High)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Multiple Functions] [Gas Griefing] Can an attacker create schemes with thousands of beneficiaries, sub-schemes, or periods, then call view methods to consume excessive gas and DoS the network? (Medium)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Multiple Functions] [Information Aggregation] By calling GetScheme, GetProfitDetails, and GetDistributedProfitsInfo with different parameters, can an attacker reconstruct the complete profit distribution graph and identify high-value targets? (Low)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Multiple Functions] [Reentrancy in View] Although these are view methods, if they call external contracts via Context operations, could reentrancy attacks manipulate the returned data mid-query? (Medium)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GetAllProfitsMap() at line 130,133] [ProfitAllPeriods Integration] When calling ProfitAllPeriods with isView=true, if the main contract's ProfitAllPeriods has bugs in view mode (lines 845-920 in ProfitContract.cs), can incorrect profit calculations propagate to all view method responses? (High)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GetAllProfitsMap() at line 130] [EndPeriod.Sub Safety] If EndPeriod.Sub(LastProfitPeriod) at line 130 results in negative or zero, will ProfitAllPeriods handle this gracefully or return unexpected results? (Medium)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GetSchemeAddress()] [Period Zero Special Case] At line 32, when input.Period == 0, the general ledger address is returned. Can this be exploited to confuse users about which address receives profits, potentially leading to lost funds sent to wrong address? (Medium)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GetDistributedProfitsInfo()] [Negative TotalShares Sentinel] The return value at line 42 with TotalShares = -1 is used as a sentinel. If any arithmetic in SafeCalculateProfits (line 956-962 in main contract) doesn't check for -1, can this cause division errors or negative profit amounts? (High)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GetAllProfitsMap() at line 114-116] [Zero Period Edge Case] If both LastProfitPeriod and StartPeriod are 0, and EndPeriod >= StartPeriod evaluates true, can this incorrectly include uninitialized profit details in calculations? (High)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GetAllProfitsMap() at line 121] [Division in GetMaximumPeriodCountForProfitableDetail] If this function divides by profitableDetailCount and profitableDetailCount is 0 due to filtering, can it return invalid period counts? (Critical)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GetAllProfitsMap() at line 128] [LastProfitPeriod Side Effect] Modifying profitDetail.LastProfitPeriod in a view method at line 128 suggests in-memory mutation. If this object is cached or reused, can it cause stale data issues in subsequent queries? (Medium)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GetSchemeAddress()] [Virtual Address Squatting] Can an attacker precompute GetDistributedPeriodProfitsVirtualAddress results for future periods and deploy malicious contracts at those addresses to intercept profit transfers? (Critical)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GeneratePeriodVirtualAddressFromHash()] [Hash Reversal] If an attacker observes virtual addresses from GetSchemeAddress queries and knows the XOR operation at line 59, can they reverse-engineer the schemeId from period and address, compromising scheme privacy? (Medium)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GetAllProfitsMap()] [Detail Limit Exploitation] Given the 10-detail limit at line 119-120, can a malicious scheme manager register 1000 beneficiaries with 1 share each, then register the attacker with 10000 shares, ensuring attacker's detail is always in top 10 while legitimate users can't query their profits? (Critical)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GetProfitAmount()] [Zero Return Ambiguity] When TryGetValue returns false at line 68 and 0 is returned, can this be exploited where 0 means 'no profits yet' vs 'not registered' vs 'symbol doesn't exist', causing UI/integration errors? (Medium)"
]