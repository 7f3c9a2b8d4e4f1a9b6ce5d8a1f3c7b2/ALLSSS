[
  "[File: contract/AElf.Contracts.Consensus.AEDPoS/AEDPoSContract_HelpMethods.cs] [Function: EnsureTokenContractAddressSet()] [System Name Dependency] The function relies on SmartContractConstants.TokenContractSystemName - if this constant is wrong or if the naming registry is compromised, will all consensus token operations interact with the wrong contract? (High)",
  "[File: contract/AElf.Contracts.Consensus.AEDPoS/AEDPoSContract_HelpMethods.cs] [Function: EnsureElectionContractAddressSet()] [Contract Address Spoofing] Similar to EnsureTokenContractAddressSet, can an attacker register a fake election contract before this initialization, causing all election-related consensus operations to interact with a malicious contract? (Critical)",
  "[File: contract/AElf.Contracts.Consensus.AEDPoS/AEDPoSContract_HelpMethods.cs] [Function: EnsureElectionContractAddressSet()] [Lazy Initialization Race] The null check at line 149 and assignment at lines 150-151 have the same race condition as EnsureTokenContractAddressSet - can concurrent calls cause multiple lookups? (Medium)",
  "[File: contract/AElf.Contracts.Consensus.AEDPoS/AEDPoSContract_HelpMethods.cs] [Function: EnsureElectionContractAddressSet()] [No Validation] No validation that the retrieved address is actually an election contract - could a wrong contract address cause consensus to interact with arbitrary contracts? (High)",
  "[File: contract/AElf.Contracts.Consensus.AEDPoS/AEDPoSContract_HelpMethods.cs] [Function: EnsureElectionContractAddressSet()] [Consensus Manipulation] If the election contract address points to an attacker-controlled contract, could the attacker manipulate miner elections, vote weights, and consensus participant selection? (Critical)",
  "[File: contract/AElf.Contracts.Consensus.AEDPoS/AEDPoSContract_HelpMethods.cs] [Function: EnsureParliamentContractAddressSet()] [Contract Address Spoofing] Can an attacker register a malicious parliament contract before initialization, allowing them to control all governance decisions that affect consensus parameters? (Critical)",
  "[File: contract/AElf.Contracts.Consensus.AEDPoS/AEDPoSContract_HelpMethods.cs] [Function: EnsureParliamentContractAddressSet()] [Lazy Initialization Race] Same race condition as the other Ensure functions - can multiple concurrent calls execute GetContractAddressByName multiple times? (Medium)",
  "[File: contract/AElf.Contracts.Consensus.AEDPoS/AEDPoSContract_HelpMethods.cs] [Function: EnsureParliamentContractAddressSet()] [Authorization Bypass] If ParliamentContract.Value points to a fake contract, could attackers bypass all parliament-based authorization checks for consensus parameter updates? (Critical)",
  "[File: contract/AElf.Contracts.Consensus.AEDPoS/AEDPoSContract_HelpMethods.cs] [Function: EnsureParliamentContractAddressSet()] [No Validation] No verification that the retrieved contract is actually a parliament contract - could this lead to consensus calling arbitrary contract methods expecting parliament responses? (High)",
  "[File: contract/AElf.Contracts.Consensus.AEDPoS/AEDPoSContract_HelpMethods.cs] [Multiple Functions] [State Consistency] Can an attacker exploit the gap between TryToGetRoundNumber (line 44) and TryToGetCurrentRoundInformation (line 52) by updating CurrentRoundNumber in between, causing the wrong round to be retrieved? (High)",
  "[File: contract/AElf.Contracts.Consensus.AEDPoS/AEDPoSContract_HelpMethods.cs] [Multiple Functions] [Integer Arithmetic] The .Sub() extension method is used at lines 61, 113, 114, 118 without overflow checks - can attackers cause underflow in any of these locations to access incorrect round numbers? (High)",
  "[File: contract/AElf.Contracts.Consensus.AEDPoS/AEDPoSContract_HelpMethods.cs] [Multiple Functions] [Caching Issues] The IsMainChain property uses instance-level caching via _isMainChain field - do other helper methods have similar caching that could become stale during contract execution? (Medium)",
  "[File: contract/AElf.Contracts.Consensus.AEDPoS/AEDPoSContract_HelpMethods.cs] [Multiple Functions] [Missing Authorization] None of the helper methods check caller authorization - can any external caller invoke methods that use these helpers to manipulate consensus state? (Critical)",
  "[File: contract/AElf.Contracts.Consensus.AEDPoS/AEDPoSContract_HelpMethods.cs] [Multiple Functions] [Round Data Integrity] Functions like AddRoundInformation (line 105) and TryToUpdateRoundInformation (line 130) modify State.Rounds without validating round data integrity - can attackers inject rounds with invalid miner lists, time slots, or consensus data? (Critical)",
  "[File: contract/AElf.Contracts.Consensus.AEDPoS/AEDPoSContract_HelpMethods.cs] [Multiple Functions] [Null Reference Handling] Several functions return objects that could be null (rounds from State.Rounds) - do all callers properly handle null returns to prevent NullReferenceExceptions? (Medium)",
  "[File: contract/AElf.Contracts.Consensus.AEDPoS/AEDPoSContract_HelpMethods.cs] [Multiple Functions] [Error Handling] Most functions use Try pattern returning bool, but critical errors might need to revert - could silent failures in helper methods cause consensus state corruption? (High)",
  "[File: contract/AElf.Contracts.Consensus.AEDPoS/AEDPoSContract_HelpMethods.cs] [Function: IsFirstRoundOfCurrentTerm()] [Complex Logic] The OR condition combines three different checks - can the logic short-circuit in unexpected ways when TryToGetTermNumber fails but TryToGetPreviousRoundInformation succeeds, causing incorrect first round detection? (Medium)"
]