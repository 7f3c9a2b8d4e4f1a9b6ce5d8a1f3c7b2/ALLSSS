[
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Cross-Function: LockToken() + UnlockToken()] [Lock/Unlock Mismatch] LockToken uses Context.Sender on line 56 but accepts lockedAddress parameter. UnlockToken uses lockedAddress on line 77 but Context.Sender on line 87. Can this mismatch allow token theft? (Critical)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Cross-Function: LockToken() + IsReleaseThresholdReached()] [Vote Count Manipulation] If LockToken allows locking 0 tokens (no validation on line 53), can attackers inflate vote counts without actually staking tokens? (Critical)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Cross-Function: CreateNewProposal() + AssertIsAuthorizedProposer()] [Authorization Bypass] CreateNewProposal doesn't call AssertIsAuthorizedProposer. Can anyone create proposals regardless of whitelist? (Critical)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Cross-Function: Validate(Organization) + CreateNewProposal()] [Threshold Bypass] If organization validation allows MinimalVoteThreshold = 0 on line 98, can proposals be created that pass with zero votes? (Critical)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Cross-Function: GetAllowance() + LockToken()] [TOCTOU] GetAllowance checks allowance > 0 on line 150, but can allowance be reduced before LockToken executes the TransferFrom on lines 47-55? (High)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Cross-Function: GenerateProposalId() + CreateNewProposal()] [ID Prediction] If GenerateProposalId allows custom input.Token on line 156, can attackers predict and front-run proposal creation to block legitimate proposals? (High)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Cross-Function: Validate(ProposalInfo) + GetValidProposal()] [Expired Proposal Execution] Validate checks expiration on line 108, but between validation and execution, can a proposal expire and still be executed? (High)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Cross-Function: LockToken() + GetProposalVirtualAddress()] [Virtual Address Drain] If GetProposalVirtualAddress is predictable, can an attacker pre-drain the virtual address before legitimate users lock tokens? (High)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Cross-Function: UnlockToken() + IsReleaseThresholdReached()] [Premature Unlock] UnlockToken doesn't check if voting has ended. Can voters unlock before threshold checks, invalidating vote counts? (Critical)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Cross-Function: CalculateOrganizationHashAddressPair() + Validate(Organization)] [Organization Creation Bypass] If hash calculation on line 210 is predictable, can attackers create organizations with predetermined addresses to bypass validation? (High)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: IsReleaseThresholdReached()] [Integer Overflow] The Add operation on line 15 for vote counts doesn't use SafeMath. Can vote counts overflow to bypass threshold checks? (High)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: LockToken()] [Amount Overflow] No validation that amount parameter won't overflow when added to existing locks. Can this cause accounting errors? (Medium)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: IsReleaseThresholdReached()] [Comparison Edge Case] Line 20 uses '>' for rejection threshold. Should it be '>=' to properly enforce the maximum? (Low)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: IsReleaseThresholdReached()] [Comparison Edge Case] Line 24 uses '>' for abstention threshold. Should it be '>=' to properly enforce the maximum? (Low)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: Validate(Organization)] [Threshold Relationship] Line 98 allows MinimalApprovalThreshold = MinimalVoteThreshold. Can this create impossible-to-pass scenarios? (Medium)"
]