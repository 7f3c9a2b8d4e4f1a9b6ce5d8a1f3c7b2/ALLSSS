[
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: IsReleaseThresholdReached()] [Integer Overflow] Can an attacker manipulate proposal.RejectionCount + proposal.AbstentionCount + proposal.ApprovalCount to cause integer overflow, bypassing the MinimalVoteThreshold check and allowing premature proposal release? (High)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: IsReleaseThresholdReached()] [Threshold Logic Error] If MaximalRejectionThreshold or MaximalAbstentionThreshold is set to long.MaxValue, can an attacker create a scenario where proposals can never be rejected or abstained, violating governance invariants? (High)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: IsReleaseThresholdReached()] [Logic Bypass] Can the check on line 20 (proposal.RejectionCount > MaximalRejectionThreshold) be bypassed by setting RejectionCount exactly equal to MaximalRejectionThreshold, allowing a proposal that should be rejected to pass? (Medium)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: IsReleaseThresholdReached()] [Logic Bypass] Can the check on line 24 (proposal.AbstentionCount > MaximalAbstentionThreshold) be bypassed by setting AbstentionCount exactly equal to MaximalAbstentionThreshold, allowing excessive abstentions while still passing the proposal? (Medium)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: IsReleaseThresholdReached()] [Threshold Manipulation] If MinimalApprovalThreshold is set to 0 in the organization configuration, can proposals pass with zero approval votes, violating the governance security model? (Critical)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: IsReleaseThresholdReached()] [State Consistency] Can an attacker exploit the sequential checks (lines 15-28) by racing between vote submissions to create inconsistent threshold states where a proposal passes despite violating multiple thresholds? (High)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: IsReleaseThresholdReached()] [Arithmetic Precision] Does the Add() operation on line 15 handle negative values correctly, or can an attacker submit negative vote counts to manipulate the total vote threshold calculation? (High)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: IsReleaseThresholdReached()] [Edge Case] If MinimalVoteThreshold is set to 0, does line 17 return false immediately, potentially blocking all proposals regardless of vote counts? (Medium)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: IsReleaseThresholdReached()] [Comparison Logic] Can an attacker exploit the >= comparison on line 28 combined with the > comparisons on lines 20 and 24 to create edge-case scenarios where proposals with borderline vote counts behave unexpectedly? (Medium)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: IsReleaseThresholdReached()] [Invariant Violation] If proposalReleaseThreshold is null or contains default values, can the function fail silently or return incorrect results, allowing invalid proposals to pass? (High)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: LockToken()] [Reentrancy] Can an attacker exploit the TransferFrom call on line 47-55 before State.LockedTokenAmount is updated on line 56, performing a reentrancy attack to lock tokens multiple times for the same proposal? (Critical)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: LockToken()] [Double Lock Check] The assertion on line 42 checks if LockedTokenAmount[lockedAddress][proposalId] is null, but can an attacker bypass this by using Context.Sender on line 56 instead of lockedAddress, allowing duplicate locks from different addresses? (High)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: LockToken()] [Parameter Mismatch] Lines 42 and 56 use different addresses (lockedAddress vs Context.Sender) for the state check - can an attacker exploit this inconsistency to lock tokens under one address while checking another? (Critical)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: LockToken()] [Virtual Address Collision] Can an attacker manipulate the lockId generation on line 44-45 or GetProposalVirtualAddress on line 51 to create hash collisions, redirecting locked tokens to attacker-controlled addresses? (Critical)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: LockToken()] [Amount Validation] There is no validation that amount > 0 on line 39 - can an attacker lock 0 tokens to manipulate voting records without actual stake? (Medium)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: LockToken()] [Token Symbol Validation] There is no validation that the symbol parameter matches the organization's TokenSymbol - can an attacker lock wrong tokens or non-existent tokens for voting? (High)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: LockToken()] [TransferFrom Failure] If the TransferFrom call on line 47-55 fails, is the state on line 56 still updated, leading to phantom locked tokens that were never actually transferred? (Critical)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: LockToken()] [Virtual Inline Security] Can an attacker exploit the Context.SendVirtualInline call to manipulate the proposalId parameter, causing tokens to be sent to unexpected virtual addresses? (High)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: LockToken()] [Receipt Integrity] The Receipt object on line 56-61 stores amount, lockId, and tokenSymbol, but can an attacker modify these values after locking to claim more tokens during unlock? (High)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: LockToken()] [Event Data Integrity] The ReferendumReceiptCreated event uses Context.Sender and Context.CurrentBlockTime - can these be manipulated to create misleading audit trails? (Low)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: LockToken()] [Organization Address Validation] The organizationAddress parameter is not validated against the proposal's actual organization - can an attacker emit events with fake organization addresses? (Medium)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: LockToken()] [State Race Condition] Between the null check on line 42 and the state update on line 56, can multiple transactions execute concurrently, bypassing the duplicate lock protection? (High)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: UnlockToken()] [Reentrancy] Can an attacker exploit the Transfer call on line 79-86 before State.LockedTokenAmount.Remove on line 87, performing a reentrancy attack to unlock tokens multiple times? (Critical)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: UnlockToken()] [Address Inconsistency] Line 77 retrieves receipt using lockedAddress but line 83 transfers to Context.Sender and line 87 removes using Context.Sender - can this mismatch allow an attacker to unlock another user's tokens? (Critical)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: UnlockToken()] [Null Check Race] The assertion on line 78 checks if receipt is not null, but can this be bypassed through race conditions where multiple unlock calls execute before state removal? (High)"
]