[
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: UnlockToken()] [Virtual Transfer Exploit] The Transfer uses virtual inline call with proposalId on line 79. Can an attacker manipulate the virtual address to transfer from unintended sources? (High)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: UnlockToken()] [Amount Manipulation] The receipt.Amount on line 82 is retrieved from state without validation. Can this be manipulated to withdraw more tokens than originally locked? (High)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: UnlockToken()] [Symbol Validation] There is no validation that receipt.TokenSymbol on line 84 matches the expected organization token. Can attackers unlock different tokens than what they locked? (Medium)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: UnlockToken()] [Double Unlock] While line 78 checks receipt != null, after removal on line 87, can an attacker call UnlockToken twice in the same transaction to bypass the check? (Medium)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: UnlockToken()] [Proposal Finality] There's no check that the proposal voting period has ended. Can voters unlock immediately after locking, negating the lock mechanism entirely? (High)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: Validate(Organization)] [Empty String Bypass] Line 92 checks string.IsNullOrEmpty for TokenSymbol but doesn't validate the actual string content. Can an attacker pass whitespace-only strings to bypass validation? (Medium)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: Validate(Organization)] [DOS Attack] Line 95 calls GetTokenInfo which makes an external contract call. Can an attacker create organizations with symbols that cause the TokenContract to revert, permanently blocking organization validation? (High)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: Validate(Organization)] [ProposerWhiteList Check] Line 93 uses ProposerWhiteList.Empty() which only checks if the list exists, not if it contains valid addresses. Can an attacker create an organization with a whitelist containing null or invalid addresses? (Medium)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: Validate(Organization)] [Threshold Logic Error] Lines 98-101 validate that MinimalApprovalThreshold <= MinimalVoteThreshold, but this allows MinimalApprovalThreshold to equal MinimalVoteThreshold. Can this create scenarios where 100% approval is required? (Low)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: Validate(Organization)] [Zero Threshold] Line 99 checks MinimalApprovalThreshold > 0, but what if MinimalVoteThreshold is 0? Can organizations be created where no votes are required for proposal release? (High)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: Validate(Organization)] [Negative Threshold] Lines 100-101 check MaximalAbstentionThreshold and MaximalRejectionThreshold >= 0. Can setting these to 0 block all proposals with any abstention/rejection? (Medium)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: Validate(Organization)] [Hash Collision] Line 93 checks organizationHash != null but doesn't validate uniqueness. Can multiple organizations share the same hash? (Medium)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: Validate(Organization)] [Address Collision] Line 92 checks organizationAddress != null but doesn't validate uniqueness or format. Can attacker-controlled addresses be used? (High)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: Validate(Organization)] [Inconsistent Thresholds] There's no validation that MaximalRejectionThreshold + MaximalAbstentionThreshold + MinimalApprovalThreshold <= MinimalVoteThreshold. Can impossible-to-pass threshold combinations be created? (High)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: Validate(Organization)] [Token Existence Race] The GetTokenInfo call on line 95 validates token existence at creation time, but can the token be burned or disabled later, breaking the organization? (Medium)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: Validate(ProposalInfo)] [Time Manipulation] Line 108 checks Context.CurrentBlockTime < proposal.ExpiredTime. Can an attacker set ExpiredTime to maximum timestamp to create never-expiring proposals? (Medium)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: Validate(ProposalInfo)] [Address Validation] Line 106 only checks ToAddress != null, not if it's a valid contract address. Can proposals target non-existent or EOA addresses? (Medium)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: Validate(ProposalInfo)] [Method Name Validation] Line 107 uses string.IsNullOrWhiteSpace but doesn't validate if the method actually exists on the target contract. Can proposals call non-existent methods? (Medium)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: Validate(ProposalInfo)] [URL Scheme Bypass] Line 110 calls ValidateDescriptionUrlScheme which only validates HTTP/HTTPS. Can attackers use this to host malicious content or phishing sites? (Low)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: Validate(ProposalInfo)] [Organization Check] Line 109 only checks hasOrganizationAddress != null, not if the organization actually exists in state. Can proposals reference non-existent organizations? (High)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: Validate(ProposalInfo)] [Expired Proposal] The check on line 108 validates expiration at proposal validation time, but can a proposal expire between validation and execution? (High)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: Validate(ProposalInfo)] [Params Validation] There is no validation of proposal.Params content. Can attackers craft malicious parameters to exploit the target contract? (High)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: Validate(ProposalInfo)] [Missing Proposer Check] The Validate function doesn't check if proposal.Proposer is set or valid. Can proposals be created without a proposer? (Medium)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: Validate(ProposalInfo)] [Vote Count Validation] The function doesn't validate vote counts (ApprovalCount, RejectionCount, AbstentionCount). Can these be pre-set to arbitrary values? (Critical)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: Validate(ProposalInfo)] [Title/Description Missing] There's no validation that Title or Description are set. Can proposals be created with empty metadata? (Low)"
]