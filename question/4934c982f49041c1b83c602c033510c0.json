[
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: CreateNewProposal()] [Proposer Authorization] The function sets proposal.Proposer to Context.Sender on line 171 but doesn't verify they're authorized by the organization. Can anyone create proposals? (Critical)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: CreateNewProposal()] [Vote Count Initialization] The ProposalInfo on lines 164-175 doesn't initialize ApprovalCount, RejectionCount, or AbstentionCount. Are they defaulted to 0, or could they be uninitialized? (Medium)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: CreateNewProposal()] [Validation Race] Line 176 calls Validate(proposal) after setting it in state on line 177. If validation fails, is the proposal still in state? (High)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: CreateNewProposal()] [Organization Existence] The function doesn't verify that input.OrganizationAddress corresponds to a valid organization in state. Can proposals be created for non-existent organizations? (High)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: CreateNewProposal()] [Event Before State] The ProposalCreated event is fired on lines 178-184 after state is set. Can the event be observed before state is fully committed? (Low)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: CreateNewProposal()] [Params Serialization] The input.Params is copied directly to proposal.Params on line 169 without validation. Can malformed params cause deserialization errors later? (Medium)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: CreateNewProposal()] [Expired Proposal Creation] There's no check preventing creation of already-expired proposals if input.ExpiredTime < Context.CurrentBlockTime. Will these be caught by Validate? (Medium)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: CreateNewProposal()] [Title/Description Injection] Lines 173-174 copy Title and Description without sanitization. Can these contain malicious content or scripts? (Low)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: CheckCreateProposalInput()] [Length Constants] Lines 192-197 check against ReferendumConstants values. Can these constants be modified or are they hardcoded? If modifiable, can an attacker change them? (Medium)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: CheckCreateProposalInput()] [Empty String] The length checks on lines 192, 194, 196 don't prevent empty strings. Can proposals have empty titles/descriptions? (Low)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: CheckCreateProposalInput()] [UTF-8 Encoding] Length checks use .Length property which counts characters, not bytes. Can multi-byte UTF-8 characters bypass length restrictions? (Low)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: CheckCreateProposalInput()] [Null Check Missing] There are no null checks for Title, Description, or ProposalDescriptionUrl before checking their length. Can null values cause NullReferenceException? (Medium)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: CheckCreateProposalInput()] [DOS via Long Strings] If ReferendumConstants values are set very high, can attackers create proposals with extremely long strings to bloat state storage? (Medium)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: AssertIsAuthorizedProposer()] [Organization Existence] Line 202 retrieves organization from state but line 203 only asserts it's not null. Can this be called with a non-existent organization address to bypass authorization? (High)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: AssertIsAuthorizedProposer()] [Whitelist Manipulation] Line 204 checks if proposer is in ProposerWhiteList. Can the whitelist be modified after proposal creation to include unauthorized addresses? (High)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: AssertIsAuthorizedProposer()] [Contains Check] The Contains check on line 204 might not handle null addresses properly. Can null proposer addresses bypass the whitelist? (Medium)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: AssertIsAuthorizedProposer()] [Empty Whitelist] If ProposerWhiteList is empty, will the Contains check always fail? Can this DOS all proposal creation? (Medium)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: AssertIsAuthorizedProposer()] [Case Sensitivity] Address comparison on line 204 might be case-sensitive. Can attackers use different address casings to bypass the whitelist? (Low)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: CalculateOrganizationHashAddressPair()] [Hash Collision] Line 210 computes organizationHash from createOrganizationInput. Can two different inputs produce the same hash? (Medium)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: CalculateOrganizationHashAddressPair()] [Virtual Address Collision] Lines 211-212 calculate virtual address using CalculateVirtualHash. Can this be manipulated to generate colliding organization addresses? (High)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: CalculateOrganizationHashAddressPair()] [CreationToken Reuse] The creationToken from createOrganizationInput is used on line 212. Can reusing the same creationToken create duplicate organizations? (High)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: CalculateOrganizationHashAddressPair()] [Contract Hash Name] The ConvertVirtualAddressToContractAddressWithContractHashName call on line 211 depends on a contract hash name. Can this be manipulated? (Medium)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: CalculateVirtualHash()] [Null Token Handling] Lines 223-225 return organizationHash if creationToken is null, otherwise concat and hash. Can this be exploited to generate predictable virtual hashes? (Medium)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: CalculateVirtualHash()] [Hash Collision] Line 225 uses HashHelper.ConcatAndCompute. Can attackers craft inputs where ConcatAndCompute(hash1, token1) == hash1 when token1 is null? (Low)",
  "[File: contract/AElf.Contracts.Referendum/Referendum_Helper.cs] [Function: CalculateVirtualHash()] [Token Manipulation] If creationToken can be controlled by user input, can attackers generate the same virtual hash for different organizations? (High)"
]