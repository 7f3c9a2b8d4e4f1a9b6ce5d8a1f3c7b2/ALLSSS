[
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: ConvertToNativeToken()] [Native Symbol Balance Assumption] DonateAll at line 682 assumes native token balance is from Sell output - but if treasury already held native tokens, can this donate more than was converted, depleting treasury? (High)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: BuildTreasury()] [Default Weight Setting Application] Lines 691-695 apply default dividend pool weights if null - can an attacker front-run InitialMiningRewardProfitItem to make these calls before BuildTreasury, locking in default weights before controller can change them? (Medium)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: BuildTreasury()] [Double BuildTreasury Call] If BuildTreasury is called multiple times (from InitialMiningRewardProfitItem), will ResetSubSchemeToTreasury at line 693 create duplicate sub-scheme registrations causing double-distributions? (High)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: ReleaseTreasurySubProfitItems()] [Zero Amount Distribution] Lines 707-734 call DistributeProfits with AmountsMap all set to 0L - does ProfitContract interpret this as 'use current balance' or 'distribute nothing', potentially blocking reward releases? (High)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: ReleaseTreasurySubProfitItems()] [Distribution Order] Calls distribute in order: RewardHash, VotesWeightRewardHash, ReElectionRewardHash, BasicRewardHash - can changing this order or if one call fails, cause beneficiaries in later schemes to lose their distribution? (High)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: ReleaseTreasurySubProfitItems()] [Period Number Validation] Uses termNumber parameter without validation - can Release pass incorrect term numbers causing distributions to wrong periods or beneficiaries? (Medium)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [Beneficiary Removal] Lines 780-787 remove previous term beneficiaries - if RemoveBeneficiaries fails due to scheme state, will AddBeneficiaries at line 793 create duplicate shares for miners appearing in both terms? (High)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [Address Conversion in GetAddressesFromCandidatePubkeys] Line 785 gets addresses from pubkeys - if a pubkey has custom profits receiver, does RemoveBeneficiaries remove wrong address, leaving stale beneficiaries? (High)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [Average Calculation Precision] Line 789 calls CalculateAverage which divides sum by count - can this lose precision for small miner counts, causing incorrect share calculations at line 811? (Medium)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [Replaced Evil Miner Share Calculation] Lines 802-808 give replaced evil miners i.ProducedBlocks shares directly - can this be gamed if evil miner was replaced late in term after producing many blocks, giving replacement excessive shares? (High)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [IsReplacedEvilMiner Flag Clearing] Line 807 removes flag after using it - if same miner is replaced multiple times in different terms, can the flag be stale from previous term? (Low)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [CalculateShares Logic] Line 811 calls CalculateShares with complex thresholds (lines 835-846) - can miners producing exactly average/2 or 4*average/5 blocks hit edge cases giving 0 shares unfairly? (Medium)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [EndPeriod Setting] Line 796 sets EndPeriod = previousTermInformation.Last().TermNumber - if this is less than or equal to current scheme period, can beneficiaries never actually receive their shares? (High)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateBasicMinerRewardWeights()] [Multiple Terms in previousTermInformation] Line 777 accepts list of rounds - if list contains non-consecutive terms, can CalculateAverage at line 789 use wrong term's data? (Medium)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: CalculateShares()] [Half Average Threshold] Line 837 returns 0 if producedBlocksCount < average/2 - can miners producing exactly average/2 blocks be unfairly excluded due to rounding? (Medium)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: CalculateShares()] [Quadratic Penalty] Line 843 returns producedBlocksCount^2 / average for miners between average/2 and 4*average/5 - can this quadratic calculation overflow for large block counts? (Medium)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: CalculateShares()] [Four-Fifths Threshold Edge Case] Line 841 checks < 4*average/5 - miners producing exactly this amount get full shares (line 845), but 1 block less gets quadratic penalty - is this discontinuity exploitable? (Low)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: CalculateShares()] [Division By Zero] Line 843 divides by averageProducedBlocksCount - if average is 0 (all miners produced 0 blocks), can this cause division by zero? (High)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateWelcomeRewardWeights()] [Previous Miner Beneficiary Removal] Lines 850-857 remove previous miners from VotesWeightRewardHash - if a previous miner is also a new miner, will they be removed then immediately re-added, causing share reset to 1 regardless of vote weight? (High)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateWelcomeRewardWeights()] [BasicReward Sub-Scheme Removal] Lines 858-862 remove BasicRewardHash as sub-scheme - if this call fails but beneficiary removal succeeded, can VotesWeightReward end up with no beneficiaries and no sub-schemes, locking funds? (High)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateWelcomeRewardWeights()] [New Miner Welcome Reward] Lines 864-880 give each new miner 1 share of welcome reward - can this be gamed if a miner intentionally sits out one term to re-qualify as 'new' and claim welcome rewards repeatedly? (High)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateWelcomeRewardWeights()] [Empty New Miners Fallback] Lines 881-890 redirect welcome reward to BasicReward if no new miners - but what if BasicReward also has no beneficiaries (all miners excluded by CalculateShares) - do funds get locked? (High)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateWelcomeRewardWeights()] [EndPeriod for Welcome Reward] Line 870 sets EndPeriod = termNumber + 1 - can new miners claim welcome rewards for multiple terms if they remain miners, or only for the next term? (Medium)",
  "[File: contract/AElf.Contracts.Treasury/TreasuryContract.cs] [Function: UpdateWelcomeRewardWeights()] [Profits Receiver Lookup] Line 872 uses GetProfitsReceiver for new miners - if they haven't set a custom receiver, does this default to their pubkey address correctly? (Low)"
]