[
  "[File: contract/AElf.Contracts.Referendum/Referendum.cs] [Function: Approve()/Reject()/Abstain()] [Allowance Exhaustion] After TransferFrom succeeds, allowance is depleted. Can users re-approve and vote again with new allowance, effectively voting multiple times? (Critical)",
  "[File: contract/AElf.Contracts.Referendum/Referendum.cs] [Function: UnlockToken() in Referendum_Helper.cs] [Transfer Failure Handling] If Transfer at line 79-86 fails, does state cleanup at line 87 still execute, permanently losing the receipt and locking tokens forever? (Critical)",
  "[File: contract/AElf.Contracts.Referendum/Referendum.cs] [Function: LockToken() in Referendum_Helper.cs] [Virtual Address Funding] Tokens are transferred to GetProposalVirtualAddress(proposalId) at line 51. Can attackers pre-fund this address to manipulate balance checks or reentrancy guards? (Medium)",
  "[File: contract/AElf.Contracts.Referendum/Referendum.cs] [Function: Release()] [Virtual Execution Context] SendVirtualInlineBySystemContract uses a virtual address calculated from organization hash. Can this bypass authorization checks in target contracts that trust system contract calls? (Critical)",
  "[File: contract/AElf.Contracts.Referendum/Referendum.cs] [Function: CreateProposal()] [Duplicate Proposal Detection] Line 163 checks if proposal exists, but with hash-based IDs, can attackers create nearly-identical proposals that differ only in non-validated fields? (Medium)",
  "[File: contract/AElf.Contracts.Referendum/Referendum.cs] [Function: Validate() in Referendum_Helper.cs] [ProposerWhiteList Validation] Empty() check at line 93 only validates count > 0, but can whitelist contain only invalid/zero addresses, passing validation but preventing legitimate proposals? (Medium)",
  "[File: contract/AElf.Contracts.Referendum/Referendum.cs] [Function: CalculateOrganizationAddress()] [Address Collision] Organization address is deterministic from input. Can two different CreateOrganizationInput sets produce the same hash and address, causing organization conflicts? (High)",
  "[File: contract/AElf.Contracts.Referendum/Referendum.cs] [Function: ReclaimVoteToken()] [Partial Reclaim] Can a user who voted Approve, Reject, AND Abstain (if possible) reclaim only one receipt, leaving others locked? (Medium)",
  "[File: contract/AElf.Contracts.Referendum/Referendum.cs] [Function: LockToken() in Referendum_Helper.cs] [Lock ID Uniqueness] Lock ID at line 44-45 uses proposalId and lockedAddress. If the same user votes on multiple proposals, are lock IDs unique? Can collisions occur? (Medium)",
  "[File: contract/AElf.Contracts.Referendum/Referendum.cs] [Function: Approve()/Reject()/Abstain()] [Vote Weight Calculation] GetAllowance returns current allowance, not balance. Can users vote with minimal allowance, then increase it after voting to manipulate effective vote weight? (High)"
]