[
  "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: DealWithExternalInfoDuringLocking()] [Callback Failure Handling] If SendInline fails (line 331), does transaction revert fully or continue to FireExternalLogEvent (line 334), leaving partial state? (High)",
  "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: DealWithExternalInfoDuringLocking()] [CallbackInfo Validation] CallbackInfo contains ContractAddress and MethodName from JSON, but are these validated before SendInline? Can attacker call arbitrary contract/method? (Critical)",
  "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: DealWithExternalInfoDuringTransfer()] [Transfer Callback Reentrancy] Similar to locking, line 346 does Context.SendInline during transfer. Can malicious callback drain sender balance before transfer event fires? (Critical)",
  "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: DealWithExternalInfoDuringTransfer()] [Multiple Callback Keys] If ExternalInfo contains both TransferCallbackExternalInfoKey and LockCallbackExternalInfoKey, are both executed? Can attacker trigger multiple reentrancies? (High)",
  "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: DealWithExternalInfoDuringUnlock()] [Unlock Callback Front-running] Line 361 sends inline call during unlock. Can attacker observe pending unlock transaction and frontrun with callback that moves unlocked tokens before original owner can claim? (High)",
  "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: FireExternalLogEvent()] [Log Event Injection] Line 372 uses ExternalInfo value directly as event Name. Can attacker inject control characters or oversized names to corrupt event logs or DoS log processing? (Medium)",
  "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: FireExternalLogEvent()] [LogEvent Address Spoofing] Line 373 sets Address = Context.Self. Can external system be confused if multiple TokenContracts exist, thinking event came from different source? (Low)",
  "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: FireExternalLogEvent()] [NonIndexed Data Size] Line 374 converts input.ToByteString(). If input is large TransferFromInput, can this cause excessive storage or gas consumption in log emission? (Low)",
  "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: IsInLockWhiteList()] [Hardcoded Whitelist] Only Election and Vote contracts are whitelisted. Can these contracts be upgraded or replaced, making old instances lose whitelist or new instances not gain it? (Medium)",
  "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: IsInLockWhiteList()] [Address Equality Check] Uses address == comparison. Does this properly handle address comparison across chains or can attacker exploit address format differences? (Low)",
  "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: GetElectionContractAddress()] [State Caching] Line 385-388 caches address in State.ElectionContractAddress.Value. If Election contract is updated, does cache get invalidated or can old address persist? (High)",
  "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: GetElectionContractAddress()] [Contract Name Resolution] Line 387 uses GetContractAddressByName with SystemName. Can attacker register contract with same name before system contract, hijacking the address? (Critical)",
  "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: GetVoteContractAddress()] [Cache Invalidation] Similar to Election, Vote contract address is cached. Can this become stale if Vote contract is upgraded or moved? (High)",
  "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: GetTokenInfo()] [Alias Resolution Order] Lines 407-413 first check TokenInfos[symbolOrAlias] then SymbolAliasMap. Can attacker create circular aliases or alias chains causing infinite loops? (High)",
  "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: GetTokenInfo()] [Null Symbol Handling] If symbolOrAlias is null or empty, does State.TokenInfos[null] cause exception or return default? Can this bypass token validation? (Medium)",
  "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: GetTokenInfo()] [Alias Priority] If both direct symbol and alias exist, direct symbol is returned (line 408). Can attacker exploit this by registering token with same name as existing alias? (Medium)",
  "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: GetTokenInfo()] [Empty String Alias] Line 410 checks if actualTokenSymbol is not empty. What if it's whitespace or special characters? Does string.IsNullOrEmpty catch these cases? (Low)",
  "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: SetTokenInfo()] [Direct State Write] Line 421 directly writes to State.TokenInfos without validation. Can this be called by other contract functions to overwrite existing tokens? (High)",
  "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: SetTokenInfo()] [InsensitiveTokenExisting Bypass] SetTokenInfo doesn't update InsensitiveTokenExisting map (only RegisterTokenInfo does). Can this cause inconsistency where token exists but ToUpper check fails? (High)",
  "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: IsInTransferBlackListInternal()] [Blacklist Scope] Only checks single address level. Can attacker create sub-accounts or proxy contracts to bypass blacklist restrictions? (Medium)",
  "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: IsInTransferBlackListInternal()] [Blacklist Addition/Removal] Function only reads blacklist. Where is it written? Can unauthorized party add/remove addresses or is there race condition in blacklist updates? (High)",
  "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Function: IsInTransferBlackListInternal()] [False Negative on New Address] If address is added to blacklist after transaction starts but before IsInTransferBlackListInternal is called, can blacklisted user complete transfer? (Medium)",
  "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Cross-Function: Symbol Validation] Multiple functions (IsValidSymbol, IsValidCreateSymbol, AssertApproveToken) validate symbols differently. Can attacker find symbol that passes one validation but fails another, causing state inconsistency? (High)",
  "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Cross-Function: Balance Integrity] ModifyBalance and GetBalance are separate. Can attacker exploit race between read and write to double-spend or create negative balances? (Critical)",
  "[File: contract/AElf.Contracts.MultiToken/TokenContract_Helper.cs] [Cross-Function: Token Creation] CheckTokenExists checks both TokenInfos and InsensitiveTokenExisting, but RegisterTokenInfo updates them separately. Can this create race condition allowing duplicate registration? (High)"
]