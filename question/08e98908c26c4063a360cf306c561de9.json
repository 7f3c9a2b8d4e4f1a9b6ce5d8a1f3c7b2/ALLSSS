[
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GetProfitDetails()] [Stale Data] If a beneficiary's ProfitDetails was updated in a concurrent transaction, can GetProfitDetails return outdated details leading to incorrect profit calculations? (Low)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GetDistributedPeriodProfitsVirtualAddress()] [Hash Collision] The function calls GeneratePeriodVirtualAddressFromHash which uses XOR (line 59). Can an attacker find (schemeId1, period1) and (schemeId2, period2) such that XOR produces identical hashes? (Critical)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GetDistributedPeriodProfitsVirtualAddress()] [Period Manipulation] If period is negative or zero, does GeneratePeriodVirtualAddressFromHash produce a valid but unintended address that could redirect profit distributions? (High)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GetDistributedPeriodProfitsVirtualAddress()] [Address Precomputation] Can an attacker precompute future period addresses and front-run profit distributions by sending tokens to those addresses before they're officially created? (High)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GeneratePeriodVirtualAddressFromHash()] [XOR Weakness] HashHelper.XorAndCompute(schemeId, HashHelper.ComputeFrom(period)) uses XOR on line 59. For periods p1 and p2, if Hash(p1) XOR schemeId == Hash(p2) XOR schemeId, do they produce the same virtual address? (Critical)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GeneratePeriodVirtualAddressFromHash()] [Predictable Hash] If HashHelper.ComputeFrom(period) is deterministic and public, can an attacker brute-force schemeId values that XOR to a target address for address squatting? (High)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GeneratePeriodVirtualAddressFromHash()] [Integer Overflow] If period is Int64.MaxValue, does HashHelper.ComputeFrom handle it correctly, or does it overflow and produce a wrong hash? (Medium)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GeneratePeriodVirtualAddressFromHash()] [Zero Period] When period = 0, does XorAndCompute(schemeId, Hash(0)) collide with the general ledger address returned by GetSchemeAddress for Period == 0? (High)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GeneratePeriodVirtualAddressFromHash()] [Negative Period] If period is negative, does ComputeFrom produce a hash that, when XORed, creates an address that points to system-reserved or privileged accounts? (High)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GetProfitAmount()] [Null Symbol] If input.Symbol is null or empty, does GetAllProfitsMap handle it correctly, or can it cause TryGetValue on line 68 to behave unexpectedly? (Medium)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GetProfitAmount()] [Zero Default] Line 68 returns 0 if TryGetValue fails. Can this zero value be misinterpreted as 'beneficiary has zero profit' vs 'profit data unavailable', causing silent failures? (Medium)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GetProfitAmount()] [Symbol Case Sensitivity] If input.Symbol is case-sensitive and allProfitsMapResult.AllProfitsMap keys are inconsistently cased, can TryGetValue fail to find existing profits? (Medium)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GetProfitAmount()] [Overflow Risk] The returned Int64Value.Value could theoretically exceed Int64.MaxValue if profit calculations overflow. Is there any validation before assigning to Value on line 68? (Low)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GetProfitAmount()] [Negative Profit] If allProfitsMapResult.AllProfitsMap contains a negative value due to bugs elsewhere, does GetProfitAmount propagate this negative profit without validation? (High)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GetAllProfitAmount()] [Dictionary Key Mismatch] Lines 77 and 81 use TryGetValue for input.Symbol. If OneTimeClaimableProfitsMap and AllProfitsMap have different keys, can this cause inconsistent profit reporting? (Medium)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GetAllProfitAmount()] [Zero Ambiguity] Both AllProfitAmount and OneTimeClaimableProfitAmount default to 0 on lines 78-79 and 83-84. Can legitimate zero profits be confused with missing data? (Medium)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GetAllProfitAmount()] [OneTime vs Total Inconsistency] If OneTimeClaimableProfitAmount > AllProfitAmount due to calculation bugs in GetAllProfitsMap, does this function return invalid data that could be exploited? (High)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GetAllProfitAmount()] [Negative Values] If TryGetValue retrieves negative amounts, are they returned without validation, potentially causing downstream arithmetic errors? (Medium)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GetAllProfitAmount()] [Symbol Injection] Can input.Symbol contain special characters or control characters that cause unexpected behavior in TryGetValue or subsequent processing? (Low)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GetProfitsMap()] [Input Reuse] GetProfitsMap takes ClaimProfitsInput but extracts SchemeId and Beneficiary on line 90. If ClaimProfitsInput has additional fields meant for claiming (not viewing), can they cause unintended side effects? (Low)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GetProfitsMap()] [Map Exposure] Line 94 exposes the entire allProfitsMapResult.AllProfitsMap. If this map is large, can repeated queries cause DoS by forcing the contract to serialize massive data structures? (Medium)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GetProfitsMap()] [Protobuf Serialization] The ReceivedProfitsMap.Value is a repeated field (line 94). If AllProfitsMap contains thousands of symbols, can serialization exceed protobuf limits or transaction size caps? (Medium)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GetProfitsMap()] [Null Beneficiary] If input.Beneficiary is null, GetAllProfitsMap (line 90) defaults to Context.Sender (line 107). In a view call, is Context.Sender meaningful, or can it return wrong data? (Medium)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GetAllProfitsMap() public] [Input Forwarding] This function simply forwards to the private GetAllProfitsMap (line 100). Is there any validation missing that should occur before forwarding? (Low)",
  "[File: contract/AElf.Contracts.Profit/ViewMethods.cs] [Function: GetAllProfitsMap() public] [Null Input Fields] If input.SchemeId or input.Beneficiary is null, does the private GetAllProfitsMap handle it, or can it cause null reference exceptions? (Medium)"
]